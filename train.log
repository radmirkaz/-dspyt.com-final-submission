2021-09-24 20:18:55,318 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:18:55,577 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:18:55,577 __main__     INFO     Fit model
2021-09-24 20:18:55,577 raif_hack.model INFO     Fit lightgbm
2021-09-24 20:20:44,814 raif_hack.model INFO     Find corr coefficient
2021-09-24 20:20:45,557 raif_hack.model INFO     Corr coef: -0.12
2021-09-24 20:20:45,557 __main__     INFO     Save model
2021-09-24 20:21:35,381 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5179711517762342, 'mdape': 0.3124457350734331, 'rmse': 73929.55680179487, 'r2': 0.8173635817229912, 'raif_metric': 3.4927180967679616}
2021-09-24 20:21:36,179 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3050682702129876, 'mdape': 0.2489452773416616, 'rmse': 73225.65241549474, 'r2': 0.3292231230563474, 'raif_metric': 2.043648565135431}
2021-09-24 20:21:36,180 __main__     INFO     END train.py
2021-09-24 20:25:01,088 __main__     INFO     START predict.py
2021-09-24 20:25:01,089 __main__     INFO     Load test df
2021-09-24 20:25:01,119 __main__     INFO     Input shape: (2974, 76)
2021-09-24 20:25:01,122 __main__     INFO     Load model
2021-09-24 20:25:01,161 __main__     INFO     Predict
2021-09-24 20:25:01,217 __main__     INFO     Save results
2021-09-24 20:25:01,230 __main__     INFO     END predict.py
2021-09-24 20:28:42,847 __main__     INFO     START predict.py
2021-09-24 20:28:42,847 __main__     INFO     Load test df
2021-09-24 20:28:42,878 __main__     INFO     Input shape: (2974, 76)
2021-09-24 20:28:42,881 __main__     INFO     Load model
2021-09-24 20:28:42,924 __main__     INFO     Predict
2021-09-24 20:28:42,999 __main__     INFO     Save results
2021-09-24 20:28:43,009 __main__     INFO     END predict.py
2021-09-24 20:33:36,167 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:33:36,430 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:33:36,430 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 51, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 51, in __init__
    self.model = CatBoostRegressor(**model_params)
TypeError: __init__() got an unexpected keyword argument 'reg_alpha'

2021-09-24 20:35:55,796 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:35:56,048 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:35:56,049 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 51, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 51, in __init__
    self.model = CatBoostRegressor(**model_params)
TypeError: __init__() got an unexpected keyword argument 'importance_type'

2021-09-24 20:36:10,147 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:36:10,409 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:36:10,410 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 51, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 51, in __init__
    self.model = CatBoostRegressor(**model_params)
TypeError: __init__() got an unexpected keyword argument 'n_jobs'

2021-09-24 20:36:21,235 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:36:21,501 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:36:21,502 __main__     INFO     Fit model
2021-09-24 20:36:21,502 raif_hack.model INFO     Fit lightgbm
2021-09-24 20:36:22,164 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 54, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 82, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(70)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
TypeError: fit() got an unexpected keyword argument 'feature_name'

2021-09-24 20:37:19,717 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:37:19,968 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:37:19,969 __main__     INFO     Fit model
2021-09-24 20:37:19,969 raif_hack.model INFO     Fit lightgbm
2021-09-24 20:37:26,930 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 54, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 82, in fit
    self.pipeline.fit(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\catboost\core.py", line 5258, in fit
    return self._fit(X, y, cat_features, None, None, None, sample_weight, None, None, None, None, baseline,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\catboost\core.py", line 1981, in _fit
    train_params = self._prepare_train_params(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\catboost\core.py", line 1913, in _prepare_train_params
    _check_train_params(params)
  File "_catboost.pyx", line 5773, in _catboost._check_train_params
  File "_catboost.pyx", line 5792, in _catboost._check_train_params
_catboost.CatBoostError: C:/Program Files (x86)/Go Agent/pipelines/BuildMaster/catboost.git/catboost/private/libs/options/catboost_options.cpp:941: max_leaves option works only with lossguide tree growing

2021-09-24 20:37:53,827 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:37:54,080 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 20:37:54,080 __main__     INFO     Fit model
2021-09-24 20:37:54,080 raif_hack.model INFO     Fit lightgbm
2021-09-24 20:38:20,106 raif_hack.model INFO     Find corr coefficient
2021-09-24 20:38:20,232 raif_hack.model INFO     Corr coef: -0.13
2021-09-24 20:38:20,232 __main__     INFO     Save model
2021-09-24 20:38:28,312 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5312383903681055, 'mdape': 0.31919270556690316, 'rmse': 76020.9898555083, 'r2': 0.806884018139876, 'raif_metric': 3.5597151078497586}
2021-09-24 20:38:28,459 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3284403337813614, 'mdape': 0.2541751613524599, 'rmse': 75081.63972446728, 'r2': 0.29478899491704846, 'raif_metric': 2.332096004076963}
2021-09-24 20:38:28,459 __main__     INFO     END train.py
2021-09-24 20:39:25,119 __main__     INFO     START predict.py
2021-09-24 20:39:25,119 __main__     INFO     Load test df
2021-09-24 20:39:25,150 __main__     INFO     Input shape: (2974, 76)
2021-09-24 20:39:25,153 __main__     INFO     Load model
2021-09-24 20:39:25,156 __main__     INFO     Predict
2021-09-24 20:39:25,243 __main__     INFO     Save results
2021-09-24 20:39:25,254 __main__     INFO     END predict.py
2021-09-24 20:51:05,497 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:51:05,824 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1530, in _get_list_axis
    return self.obj._take_with_is_copy(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3625, in _take_with_is_copy
    result = self.take(indices=indices, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3612, in take
    new_data = self._mgr.take(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 858, in take
    indexer = maybe_convert_indices(indexer, n, verify=verify)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexers.py", line 292, in maybe_convert_indices
    raise IndexError("indices are out-of-bounds")
IndexError: indices are out-of-bounds

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 55, in <module>
    X_offer, X_manual = X_offer.iloc[trn_ind], X_manual.iloc[val_ind]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 931, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1557, in _getitem_axis
    return self._get_list_axis(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1533, in _get_list_axis
    raise IndexError("positional indexers are out-of-bounds") from err
IndexError: positional indexers are out-of-bounds

2021-09-24 20:53:46,126 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:53:46,446 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1530, in _get_list_axis
    return self.obj._take_with_is_copy(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3625, in _take_with_is_copy
    result = self.take(indices=indices, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3612, in take
    new_data = self._mgr.take(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 858, in take
    indexer = maybe_convert_indices(indexer, n, verify=verify)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexers.py", line 292, in maybe_convert_indices
    raise IndexError("indices are out-of-bounds")
IndexError: indices are out-of-bounds

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 56, in <module>
    X_offer, X_manual = X_offer.iloc[trn_ind], X_manual.iloc[val_ind]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 931, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1557, in _getitem_axis
    return self._get_list_axis(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1533, in _get_list_axis
    raise IndexError("positional indexers are out-of-bounds") from err
IndexError: positional indexers are out-of-bounds

2021-09-24 20:54:15,186 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:54:15,499 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1530, in _get_list_axis
    return self.obj._take_with_is_copy(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3625, in _take_with_is_copy
    result = self.take(indices=indices, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 3612, in take
    new_data = self._mgr.take(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 858, in take
    indexer = maybe_convert_indices(indexer, n, verify=verify)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexers.py", line 292, in maybe_convert_indices
    raise IndexError("indices are out-of-bounds")
IndexError: indices are out-of-bounds

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 57, in <module>
    X_offer, X_manual = X_offer.iloc[trn_ind], X_manual.iloc[val_ind]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 931, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1557, in _getitem_axis
    return self._get_list_axis(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1533, in _get_list_axis
    raise IndexError("positional indexers are out-of-bounds") from err
IndexError: positional indexers are out-of-bounds

2021-09-24 20:57:06,127 __main__     INFO     Input shape: (279792, 77)
2021-09-24 20:57:06,546 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-24 20:57:06,547 __main__     INFO     Fit model
2021-09-24 20:57:06,547 raif_hack.model INFO     Fit lightgbm
2021-09-24 20:58:37,576 raif_hack.model INFO     Find corr coefficient
2021-09-24 20:58:37,740 raif_hack.model INFO     Corr coef: -0.11
2021-09-24 20:58:37,740 __main__     INFO     Save model
2021-09-24 20:59:17,819 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5271314208324251, 'mdape': 0.31245040194229734, 'rmse': 73184.84749666524, 'r2': 0.8191644488011032, 'raif_metric': 3.485135990698345}
2021-09-24 20:59:17,987 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3203248846643888, 'mdape': 0.2682826493611022, 'rmse': 42837.74978080717, 'r2': 0.5611342021164389, 'raif_me tric': 2.2204785834817726}
2021-09-24 20:59:18,293 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-24 20:59:18,298 __main__     INFO     Fit model
2021-09-24 20:59:18,298 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:00:49,529 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:00:49,685 raif_hack.model INFO     Corr coef: -0.13
2021-09-24 21:00:49,685 __main__     INFO     Save model
2021-09-24 21:01:29,072 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.517795745557362, 'mdape': 0.31097491208830874, 'rmse': 72904.56861714012, 'r2': 0.8232550101513747, 'raif_metric': 3.4761458393288893}
2021-09-24 21:01:29,229 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2717373745762687, 'mdape': 0.2316570536288103, 'rmse': 38823.747822061225, 'r2': 0.555594092180404, 'raif_metric': 1.875734284199466}
2021-09-24 21:01:29,532 __main__     INFO     X_offer (220238, 70)  y_offer (220238,)	X_manual (897, 70) y_manual (897,)
2021-09-24 21:01:29,536 __main__     INFO     Fit model
2021-09-24 21:01:29,536 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:03:00,751 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:03:00,907 raif_hack.model INFO     Corr coef: -0.12
2021-09-24 21:03:00,907 __main__     INFO     Save model
2021-09-24 21:03:40,201 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5046896384575148, 'mdape': 0.3111202179905962, 'rmse': 72813.7867325154, 'r2': 0.8234612852364638, 'raif_metric': 3.482891375650356}
2021-09-24 21:03:40,363 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29847131098560103, 'mdape': 0.23564203365623812, 'rmse': 66341.81403787073, 'r2': 0.4064697155851329, 'raif_metric': 1.984501098301718}
2021-09-24 21:03:40,666 __main__     INFO     X_offer (220246, 70)  y_offer (220246,)	X_manual (905, 70) y_manual (905,)
2021-09-24 21:03:40,670 __main__     INFO     Fit model
2021-09-24 21:03:40,670 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:05:11,145 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:05:11,304 raif_hack.model INFO     Corr coef: -0.13
2021-09-24 21:05:11,304 __main__     INFO     Save model
2021-09-24 21:05:50,783 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5165766205422833, 'mdape': 0.313043132451149, 'rmse': 73236.91757108613, 'r2': 0.8206134210024186, 'raif_metric': 3.4934351699735022}
2021-09-24 21:05:50,954 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3366211559433432, 'mdape': 0.2562169809997136, 'rmse': 102425.39018535013, 'r2': 0.2639904785511079, 'raif_metric': 2.136582628682969}
2021-09-24 21:05:51,269 __main__     INFO     X_offer (220241, 70)  y_offer (220241,)	X_manual (900, 70) y_manual (900,)
2021-09-24 21:05:51,273 __main__     INFO     Fit model
2021-09-24 21:05:51,273 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:07:22,867 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:07:23,023 raif_hack.model INFO     Corr coef: -0.10
2021-09-24 21:07:23,023 __main__     INFO     Save model
2021-09-24 21:08:01,767 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.506248763260844, 'mdape': 0.31211548344062573, 'rmse': 72669.55336152969, 'r2': 0.8240158870414738, 'raif_metric': 3.4879824763256195}
2021-09-24 21:08:01,938 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3000221363614682, 'mdape': 0.24305658012620107, 'rmse': 92220.11177045516, 'r2': 0.19344983122964032, 'raif_metric': 2.0211215677547933}
2021-09-24 21:08:01,938 __main__     INFO     END train.py
2021-09-24 21:10:58,659 __main__     INFO     START predict.py
2021-09-24 21:10:58,660 __main__     INFO     Load test df
2021-09-24 21:10:58,690 __main__     INFO     Input shape: (2974, 76)
2021-09-24 21:10:58,693 __main__     INFO     Load model
2021-09-24 21:10:58,730 __main__     INFO     Predict
2021-09-24 21:10:58,739 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'per_square_meter_price'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/predict.py", line 51, in <module>
    test_df['per_square_meter_price'] += model.predict(test_df[NUM_FEATURES+CATEGORICAL_OHE_FEATURES+CATEGORICAL_STE_FEATURES]) / 5
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'per_square_meter_price'

2021-09-24 21:11:29,436 __main__     INFO     START predict.py
2021-09-24 21:11:29,436 __main__     INFO     Load test df
2021-09-24 21:11:29,467 __main__     INFO     Input shape: (2974, 76)
2021-09-24 21:11:29,470 __main__     INFO     Load model
2021-09-24 21:11:29,507 __main__     INFO     Predict
2021-09-24 21:11:29,511 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'per_square_meter_price'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/predict.py", line 51, in <module>
    test_df['per_square_meter_price'].values += model.predict(test_df[NUM_FEATURES+CATEGORICAL_OHE_FEATURES+CATEGORICAL_STE_FEATURES]) / 5
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'per_square_meter_price'

2021-09-24 21:11:58,151 __main__     INFO     START predict.py
2021-09-24 21:11:58,151 __main__     INFO     Load test df
2021-09-24 21:11:58,182 __main__     INFO     Input shape: (2974, 76)
2021-09-24 21:11:58,185 __main__     INFO     Load model
2021-09-24 21:11:58,276 __main__     INFO     Predict
2021-09-24 21:11:58,279 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'per_square_meter_price'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/predict.py", line 52, in <module>
    test_df['per_square_meter_price'] += model.predict(test_df[NUM_FEATURES+CATEGORICAL_OHE_FEATURES+CATEGORICAL_STE_FEATURES]) / 5
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'per_square_meter_price'

2021-09-24 21:13:08,600 __main__     INFO     START predict.py
2021-09-24 21:13:08,601 __main__     INFO     Load test df
2021-09-24 21:13:08,632 __main__     INFO     Input shape: (2974, 76)
2021-09-24 21:13:08,635 __main__     INFO     Load model
2021-09-24 21:13:08,675 __main__     INFO     Predict
2021-09-24 21:13:08,787 __main__     INFO     Predict
2021-09-24 21:13:08,910 __main__     INFO     Predict
2021-09-24 21:13:09,064 __main__     INFO     Predict
2021-09-24 21:13:09,165 __main__     INFO     Predict
2021-09-24 21:13:09,225 __main__     INFO     Save results
2021-09-24 21:13:09,236 __main__     INFO     END predict.py
2021-09-24 21:45:43,294 __main__     INFO     Input shape: (279792, 77)
2021-09-24 21:45:43,707 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-24 21:45:43,707 __main__     INFO     Fit model
2021-09-24 21:45:43,707 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:47:15,301 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:47:15,467 raif_hack.model INFO     Corr coef: -0.11
2021-09-24 21:47:15,467 __main__     INFO     Save model
2021-09-24 21:47:54,172 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5271314208324251, 'mdape': 0.31245040194229734, 'rmse': 73184.84749666524, 'r2': 0.8191644488011032, 'raif_metric': 3.485135990698345}
2021-09-24 21:47:54,336 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3203248846643888, 'mdape': 0.2682826493611022, 'rmse': 42837.74978080717, 'r2': 0.5611342021164389, 'raif_metric': 2.2204785834817726}
2021-09-24 21:47:54,638 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-24 21:47:54,642 __main__     INFO     Fit model
2021-09-24 21:47:54,642 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:49:25,723 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:49:25,884 raif_hack.model INFO     Corr coef: -0.13
2021-09-24 21:49:25,884 __main__     INFO     Save model
2021-09-24 21:50:05,072 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.517795745557362, 'mdape': 0.31097491208830874, 'rmse': 72904.56861714012, 'r2': 0.8232550101513747, 'raif_metric': 3.4761458393288893}
2021-09-24 21:50:05,223 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2717373745762687, 'mdape': 0.2316570536288103, 'rmse': 38823.747822061225, 'r2': 0.555594092180404, 'raif_metric': 1.875734284199466}
2021-09-24 21:50:05,525 __main__     INFO     X_offer (220238, 70)  y_offer (220238,)	X_manual (897, 70) y_manual (897,)
2021-09-24 21:50:05,530 __main__     INFO     Fit model
2021-09-24 21:50:05,530 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:51:36,624 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:51:36,786 raif_hack.model INFO     Corr coef: -0.12
2021-09-24 21:51:36,786 __main__     INFO     Save model
2021-09-24 21:52:16,319 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5046896384575148, 'mdape': 0.3111202179905962, 'rmse': 72813.7867325154, 'r2': 0.8234612852364638, 'raif_metric': 3.482891375650356}
2021-09-24 21:52:16,483 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29847131098560103, 'mdape': 0.23564203365623812, 'rmse': 66341.81403787073, 'r2': 0.4064697155851329, 'raif_metric': 1.984501098301718}
2021-09-24 21:52:16,789 __main__     INFO     X_offer (220246, 70)  y_offer (220246,)	X_manual (905, 70) y_manual (905,)
2021-09-24 21:52:16,794 __main__     INFO     Fit model
2021-09-24 21:52:16,794 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:53:47,158 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:53:47,312 raif_hack.model INFO     Corr coef: -0.13
2021-09-24 21:53:47,312 __main__     INFO     Save model
2021-09-24 21:54:25,883 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5165766205422833, 'mdape': 0.313043132451149, 'rmse': 73236.91757108613, 'r2': 0.8206134210024186, 'raif_metric': 3.4934351699735022}
2021-09-24 21:54:26,053 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3366211559433432, 'mdape': 0.2562169809997136, 'rmse': 102425.39018535013, 'r2': 0.2639904785511079, 'raif_metric': 2.136582628682969}
2021-09-24 21:54:26,359 __main__     INFO     X_offer (220241, 70)  y_offer (220241,)	X_manual (900, 70) y_manual (900,)
2021-09-24 21:54:26,364 __main__     INFO     Fit model
2021-09-24 21:54:26,364 raif_hack.model INFO     Fit lightgbm
2021-09-24 21:55:57,738 raif_hack.model INFO     Find corr coefficient
2021-09-24 21:55:57,897 raif_hack.model INFO     Corr coef: -0.10
2021-09-24 21:55:57,897 __main__     INFO     Save model
2021-09-24 21:56:36,499 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.506248763260844, 'mdape': 0.31211548344062573, 'rmse': 72669.55336152969, 'r2': 0.8240158870414738, 'raif_metric': 3.4879824763256195}
2021-09-24 21:56:36,661 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3000221363614682, 'mdape': 0.24305658012620107, 'rmse': 92220.11177045516, 'r2': 0.19344983122964032, 'raif_metric': 2.0211215677547933}
2021-09-24 21:56:36,662 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    pd.DataFrame({'Value': model.feature_importance(model, importance_type='gain'), 'Feature': features}).sort_values(
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 126, in feature_importance
    return model.feature_importance(importance_type=importance_type)
TypeError: feature_importance() missing 1 required positional argument: 'model'

2021-09-24 22:02:51,850 __main__     INFO     Input shape: (279792, 77)
2021-09-24 22:02:52,022 __main__     INFO     X_offer (46632, 70)  y_offer (46632,)	X_manual (0, 70) y_manual (0,)
2021-09-24 22:02:52,022 __main__     INFO     Fit model
2021-09-24 22:02:52,022 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:03:12,106 __main__     INFO     Input shape: (279792, 77)
2021-09-24 22:03:12,281 __main__     INFO     X_offer (46632, 70)  y_offer (46632,)	X_manual (0, 70) y_manual (0,)
2021-09-24 22:03:12,281 __main__     INFO     Fit model
2021-09-24 22:03:12,281 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:03:43,554 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:03:43,572 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    self._find_corr_coefficient(X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 65, in _find_corr_coefficient
    predictions = self.pipeline.predict(X_manual)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 418, in predict
    Xt = transform.transform(Xt)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\fixes.py", line 222, in __call__
    return self.function(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 733, in _transform_one
    res = transformer.transform(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_data.py", line 883, in transform
    X = self._validate_data(X, reset=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 726, in check_array
    raise ValueError("Found array with %d sample(s) (shape=%s) while a"
ValueError: Found array with 0 sample(s) (shape=(0, 67)) while a minimum of 1 is required by StandardScaler.

2021-09-24 22:04:21,526 __main__     INFO     Input shape: (279792, 77)
2021-09-24 22:04:21,696 __main__     INFO     X_offer (46632, 70)  y_offer (46632,)	X_manual (0, 70) y_manual (0,)
2021-09-24 22:04:21,697 __main__     INFO     Fit model
2021-09-24 22:04:21,697 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:04:52,470 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:04:52,476 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    self._find_corr_coefficient(X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 65, in _find_corr_coefficient
    predictions = self.pipeline.predict(X_manual)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 418, in predict
    Xt = transform.transform(Xt)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\fixes.py", line 222, in __call__
    return self.function(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 733, in _transform_one
    res = transformer.transform(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_data.py", line 883, in transform
    X = self._validate_data(X, reset=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 726, in check_array
    raise ValueError("Found array with %d sample(s) (shape=%s) while a"
ValueError: Found array with 0 sample(s) (shape=(0, 67)) while a minimum of 1 is required by StandardScaler.

2021-09-24 22:11:16,485 __main__     INFO     Input shape: (279792, 77)
2021-09-24 22:11:16,878 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 22:11:16,878 __main__     INFO     Fit model
2021-09-24 22:11:16,878 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:13:05,875 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:13:05,889 raif_hack.model INFO     Corr coef: -0.27
2021-09-24 22:13:05,889 __main__     INFO     Save model
2021-09-24 22:13:53,871 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213174574860717, 'mdape': 0.3122631481017292, 'rmse': 73904.70855375721, 'r2': 0.8175017157290172, 'raif_metric': 3.4950161908262674}
2021-09-24 22:13:53,884 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.35336916696175386, 'mdape': 0.3496002535108539, 'rmse': 164207.1662585025, 'r2': 0.3673889340117703, 'raif_metric': 3.5210506572299045}
2021-09-24 22:13:54,200 __main__     INFO     X_offer (274754, 70)  y_offer (274754,)	X_manual (15, 70) y_manual (15,)
2021-09-24 22:13:54,204 __main__     INFO     Fit model
2021-09-24 22:13:54,204 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:15:43,037 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:15:43,051 raif_hack.model INFO     Corr coef: -0.18
2021-09-24 22:15:43,051 __main__     INFO     Save model
2021-09-24 22:16:31,986 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522461656628799, 'mdape': 0.3129804264281112, 'rmse': 73896.3200152816, 'r2': 0.8175526752202835, 'raif_metric': 3.4960124019450705}
2021-09-24 22:16:32,000 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2680612453063719, 'mdape': 0.25106736784301126, 'rmse': 38809.59203044066, 'r2': 0.7641483151859892, 'raif_metric': 2.0474670939615596}
2021-09-24 22:16:32,299 __main__     INFO     X_offer (274754, 70)  y_offer (274754,)	X_manual (15, 70) y_manual (15,)
2021-09-24 22:16:32,304 __main__     INFO     Fit model
2021-09-24 22:16:32,304 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:18:21,562 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:18:21,576 raif_hack.model INFO     Corr coef: -0.02
2021-09-24 22:18:21,577 __main__     INFO     Save model
2021-09-24 22:19:08,718 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5182465836685102, 'mdape': 0.3126369481160223, 'rmse': 74007.02268133033, 'r2': 0.817014930263674, 'raif_metric': 3.4948407493958995}
2021-09-24 22:19:08,732 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3688876649371654, 'mdape': 0.23370847437612066, 'rmse': 62992.3695871641, 'r2': -4.744890032857658, 'raif_metric': 1.7280110091911178}
2021-09-24 22:19:09,047 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-24 22:19:09,051 __main__     INFO     Fit model
2021-09-24 22:19:09,051 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:20:56,551 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:20:56,565 raif_hack.model INFO     Corr coef: -0.30
2021-09-24 22:20:56,565 __main__     INFO     Save model
2021-09-24 22:21:44,003 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208629549237367, 'mdape': 0.3132598204181753, 'rmse': 73988.63667343982, 'r2': 0.8170357115884074, 'raif_metric': 3.495800682973357}
2021-09-24 22:21:44,017 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24081040650328953, 'mdape': 0.1962809550366686, 'rmse': 22066.91653055871, 'r2': 0.5355464563827922, 'raif_metric': 1.3254005070232053}
2021-09-24 22:21:44,320 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 22:21:44,325 __main__     INFO     Fit model
2021-09-24 22:21:44,325 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:23:33,217 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:23:33,230 raif_hack.model INFO     Corr coef: -0.14
2021-09-24 22:23:33,230 __main__     INFO     Save model
2021-09-24 22:24:20,800 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5203089767107003, 'mdape': 0.31247838499668, 'rmse': 73917.99978256343, 'r2': 0.8174209382719136, 'raif_metric': 3.4931520345491465}
2021-09-24 22:24:20,813 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2402073774376583, 'mdape': 0.2439097646165275, 'rmse': 13856.973219242054, 'r2': -0.03186558867659306, 'raif_metric': 1.17753759678402}
2021-09-24 22:24:21,127 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 22:24:21,131 __main__     INFO     Fit model
2021-09-24 22:24:21,131 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:26:08,901 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:26:08,914 raif_hack.model INFO     Corr coef: -0.21
2021-09-24 22:26:08,914 __main__     INFO     Save model
2021-09-24 22:26:56,054 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5216430178519287, 'mdape': 0.3132549346126408, 'rmse': 73997.66448688867, 'r2': 0.8170290429851232, 'raif_metric': 3.496934089205922}
2021-09-24 22:26:56,067 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24879964024886686, 'mdape': 0.23507724409220265, 'rmse': 17681.351798692776, 'r2': 0.8747399068235031, 'raif_metric': 1.8962663260644979}
2021-09-24 22:26:56,372 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-24 22:26:56,376 __main__     INFO     Fit model
2021-09-24 22:26:56,376 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:28:44,420 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:28:44,434 raif_hack.model INFO     Corr coef: -0.28
2021-09-24 22:28:44,434 __main__     INFO     Save model
2021-09-24 22:29:32,025 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221646184097013, 'mdape': 0.31283081384384887, 'rmse': 74030.05139803534, 'r2': 0.8168793747945056, 'raif_metric': 3.4968812803874525}
2021-09-24 22:29:32,039 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22985679690425512, 'mdape': 0.1691867558934648, 'rmse': 46956.168383334516, 'r2': 0.8116028504853446, 'raif_metric': 1.37148993683309}
2021-09-24 22:29:32,344 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-24 22:29:32,349 __main__     INFO     Fit model
2021-09-24 22:29:32,349 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:31:21,559 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:31:21,573 raif_hack.model INFO     Corr coef: -0.19
2021-09-24 22:31:21,573 __main__     INFO     Save model
2021-09-24 22:32:09,790 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5174505696071556, 'mdape': 0.3122455091621474, 'rmse': 73847.22874401965, 'r2': 0.817700693663941, 'raif_metric': 3.490098756460639}
2021-09-24 22:32:09,803 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2565654786423414, 'mdape': 0.2176339386582914, 'rmse': 59533.710900590704, 'r2': 0.05543195481572161, 'raif_metric': 1.342119639514246}
2021-09-24 22:32:10,104 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 22:32:10,109 __main__     INFO     Fit model
2021-09-24 22:32:10,109 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:33:59,839 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:33:59,852 raif_hack.model INFO     Corr coef: -0.20
2021-09-24 22:33:59,852 __main__     INFO     Save model
2021-09-24 22:34:48,450 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5181096058123758, 'mdape': 0.31244129148149613, 'rmse': 73870.37521748463, 'r2': 0.8175920789652725, 'raif_metric': 3.492749628853485}
2021-09-24 22:34:48,463 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2729831134217825, 'mdape': 0.2537819744633994, 'rmse': 16825.140580431165, 'r2': 0.4124256638926411, 'raif_metric': 1.7695717376179254}
2021-09-24 22:34:48,781 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 22:34:48,786 __main__     INFO     Fit model
2021-09-24 22:34:48,786 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:36:37,409 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:36:37,422 raif_hack.model INFO     Corr coef: -0.27
2021-09-24 22:36:37,422 __main__     INFO     Save model
2021-09-24 22:37:25,181 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522508146526303, 'mdape': 0.3130623026818569, 'rmse': 74040.54849636587, 'r2': 0.8168956031895476, 'raif_metric': 3.496175200466356}
2021-09-24 22:37:25,194 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28986055113255915, 'mdape': 0.2430496580856727, 'rmse': 42632.72263346373, 'r2': -0.7627447978510333, 'raif_metric': 1.5891457586974058}
2021-09-24 22:37:25,509 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-24 22:37:25,511 __main__     INFO     Fit model
2021-09-24 22:37:25,511 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:39:14,246 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:39:14,260 raif_hack.model INFO     Corr coef: 0.13
2021-09-24 22:39:14,260 __main__     INFO     Save model
2021-09-24 22:40:02,263 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5199687157558959, 'mdape': 0.3125037057595309, 'rmse': 73915.64235856889, 'r2': 0.8174346180903497, 'raif_metric': 3.494425582610347}
2021-09-24 22:40:02,277 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.33756531899990955, 'mdape': 0.18825064708023148, 'rmse': 17761.74940259093, 'r2': 0.4025868951935473, 'raif_metric': 1.7458742280395485}
2021-09-24 22:40:02,592 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 22:40:02,597 __main__     INFO     Fit model
2021-09-24 22:40:02,597 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:41:51,617 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:41:51,631 raif_hack.model INFO     Corr coef: -0.15
2021-09-24 22:41:51,631 __main__     INFO     Save model
2021-09-24 22:42:40,357 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5230282064113794, 'mdape': 0.3128987062600923, 'rmse': 73780.84105721602, 'r2': 0.8180129937148095, 'raif_metric': 3.492849868735056}
2021-09-24 22:42:40,369 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.27743224124475924, 'mdape': 0.09903251022222996, 'rmse': 15664.174052426846, 'r2': 0.7053872623299815, 'raif_metric': 2.129732659152516}
2021-09-24 22:42:40,684 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-24 22:42:40,687 __main__     INFO     Fit model
2021-09-24 22:42:40,687 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:44:28,791 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:44:28,803 raif_hack.model INFO     Corr coef: 0.01
2021-09-24 22:44:28,803 __main__     INFO     Save model
2021-09-24 22:45:15,953 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232398339481814, 'mdape': 0.3125808314687822, 'rmse': 73878.51927047163, 'r2': 0.8175875139208489, 'raif_metric': 3.495361190742557}
2021-09-24 22:45:15,966 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17748015831542793, 'mdape': 0.21446359061569845, 'rmse': 9202.70572830319, 'r2': 0.35900058807757207, 'raif_metric': 0.2625824982868356}
2021-09-24 22:45:16,266 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-24 22:45:16,268 __main__     INFO     Fit model
2021-09-24 22:45:16,268 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:47:05,128 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:47:05,142 raif_hack.model INFO     Corr coef: -0.15
2021-09-24 22:47:05,142 __main__     INFO     Save model
2021-09-24 22:47:53,011 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5186536166382962, 'mdape': 0.3120853213271929, 'rmse': 73888.25619935826, 'r2': 0.8175810149627507, 'raif_metric': 3.493085755102011}
2021-09-24 22:47:53,024 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 1.0173863113317396, 'mdape': 0.30423615383973024, 'rmse': 36008.82091797101, 'r2': 0.2395299831339579, 'raif_metric': 3.16412485636075}
2021-09-24 22:47:53,338 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-24 22:47:53,341 __main__     INFO     Fit model
2021-09-24 22:47:53,341 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:49:41,819 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:49:41,831 raif_hack.model INFO     Corr coef: -0.03
2021-09-24 22:49:41,831 __main__     INFO     Save model
2021-09-24 22:50:30,402 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5206518274085319, 'mdape': 0.31286872696781126, 'rmse': 73989.16554294826, 'r2': 0.8170211461336154, 'raif_metric': 3.4972639977263196}
2021-09-24 22:50:30,415 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2815912151628937, 'mdape': 0.34307484004722266, 'rmse': 18220.720869891986, 'r2': -0.48878423395795156, 'raif_metric': 1.8667075557116855}
2021-09-24 22:50:30,718 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 22:50:30,720 __main__     INFO     Fit model
2021-09-24 22:50:30,720 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:52:19,945 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:52:19,958 raif_hack.model INFO     Corr coef: -0.12
2021-09-24 22:52:19,958 __main__     INFO     Save model
2021-09-24 22:53:07,745 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211211018507504, 'mdape': 0.31231862012467926, 'rmse': 73896.84579586786, 'r2': 0.8174042676605572, 'raif_metric': 3.4906003108563293}
2021-09-24 22:53:07,757 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16138802171984845, 'mdape': 0.0886476689809533, 'rmse': 12980.793075705564, 'r2': -4.837897195578046, 'raif_metric': 1.103211071405547}
2021-09-24 22:53:08,068 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-24 22:53:08,071 __main__     INFO     Fit model
2021-09-24 22:53:08,071 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:54:56,190 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:54:56,202 raif_hack.model INFO     Corr coef: -0.22
2021-09-24 22:54:56,202 __main__     INFO     Save model
2021-09-24 22:55:43,705 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5209423120735261, 'mdape': 0.3131698333657678, 'rmse': 73965.99708384562, 'r2': 0.8170782602592672, 'raif_metric': 3.4980038828938866}
2021-09-24 22:55:43,717 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25025022950450326, 'mdape': 0.2447146867980535, 'rmse': 13881.971851847078, 'r2': 0.10226890560818147, 'raif_metric': 1.5647633481445196}
2021-09-24 22:55:44,022 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 22:55:44,025 __main__     INFO     Fit model
2021-09-24 22:55:44,025 raif_hack.model INFO     Fit lightgbm
2021-09-24 22:57:32,666 raif_hack.model INFO     Find corr coefficient
2021-09-24 22:57:32,680 raif_hack.model INFO     Corr coef: -0.04
2021-09-24 22:57:32,680 __main__     INFO     Save model
2021-09-24 22:58:20,796 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5228543844703928, 'mdape': 0.31316181365624374, 'rmse': 74028.17193192526, 'r2': 0.8170030564099249, 'raif_metric': 3.4979075885242854}
2021-09-24 22:58:20,809 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2931632706610669, 'mdape': 0.238500088741088, 'rmse': 32133.78433108579, 'r2': 0.5481848693127178, 'raif_metric': 1.8982685499076517}
2021-09-24 22:58:21,123 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 22:58:21,125 __main__     INFO     Fit model
2021-09-24 22:58:21,125 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:00:10,246 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:00:10,259 raif_hack.model INFO     Corr coef: -0.14
2021-09-24 23:00:10,259 __main__     INFO     Save model
2021-09-24 23:00:57,604 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5185775681558, 'mdape': 0.3121740845758363, 'rmse': 73905.62047130665, 'r2': 0.8175162979869666, 'raif_metric': 3.4908837507521113}
2021-09-24 23:00:57,616 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2367866710463897, 'mdape': 0.19924965611377335, 'rmse': 18034.427493388685, 'r2': 0.6550474831879705, 'raif_metric': 1.32355778029823}
2021-09-24 23:00:57,923 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-24 23:00:57,925 __main__     INFO     Fit model
2021-09-24 23:00:57,925 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:02:46,162 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:02:46,177 raif_hack.model INFO     Corr coef: 0.05
2021-09-24 23:02:46,177 __main__     INFO     Save model
2021-09-24 23:03:33,485 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5199643680899628, 'mdape': 0.3125219099339909, 'rmse': 74043.69234361625, 'r2': 0.8168024782303223, 'raif_metric': 3.493251925698008}
2021-09-24 23:03:33,497 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3164912258625871, 'mdape': 0.26621442372836046, 'rmse': 18135.010944107104, 'r2': -1.0092873400747786, 'raif_metric': 2.998723974354179}
2021-09-24 23:03:33,809 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 23:03:33,811 __main__     INFO     Fit model
2021-09-24 23:03:33,811 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:05:21,784 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:05:21,796 raif_hack.model INFO     Corr coef: -0.16
2021-09-24 23:05:21,796 __main__     INFO     Save model
2021-09-24 23:06:08,876 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522097431625453, 'mdape': 0.3128277847489054, 'rmse': 74006.80497013715, 'r2': 0.8169028786635183, 'raif_metric': 3.495110425476716}
2021-09-24 23:06:08,888 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26411730475122985, 'mdape': 0.2688420315003652, 'rmse': 28610.19052950852, 'r2': 0.4592032970055452, 'raif_metric': 1.5667575856415545}
2021-09-24 23:06:09,193 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 23:06:09,195 __main__     INFO     Fit model
2021-09-24 23:06:09,195 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:07:57,535 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:07:57,549 raif_hack.model INFO     Corr coef: -0.21
2021-09-24 23:07:57,549 __main__     INFO     Save model
2021-09-24 23:08:46,762 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520991224358307, 'mdape': 0.3126619324535465, 'rmse': 74011.98086202522, 'r2': 0.8168769765095032, 'raif_metric': 3.4935183094786875}
2021-09-24 23:08:46,776 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3111373844276031, 'mdape': 0.3746979440848726, 'rmse': 39568.234623733944, 'r2': 0.2566608426438569, 'raif_metric': 2.4278670138306477}
2021-09-24 23:08:47,090 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-24 23:08:47,092 __main__     INFO     Fit model
2021-09-24 23:08:47,092 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:10:36,485 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:10:36,497 raif_hack.model INFO     Corr coef: 0.14
2021-09-24 23:10:36,497 __main__     INFO     Save model
2021-09-24 23:11:24,106 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5197384169383112, 'mdape': 0.3129760455630358, 'rmse': 73902.92499333776, 'r2': 0.8174016190605298, 'raif_metric': 3.493320729810113}
2021-09-24 23:11:24,118 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21626973140906258, 'mdape': 0.05565231407747911, 'rmse': 24555.02563303667, 'r2': -2.579603090024309, 'raif_metric': 1.5}
2021-09-24 23:11:24,432 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-24 23:11:24,435 __main__     INFO     Fit model
2021-09-24 23:11:24,435 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:13:13,461 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:13:13,476 raif_hack.model INFO     Corr coef: -0.19
2021-09-24 23:13:13,476 __main__     INFO     Save model
2021-09-24 23:14:00,624 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5216763120677887, 'mdape': 0.3127076554215477, 'rmse': 73967.25112768364, 'r2': 0.8172760134600623, 'raif_metric': 3.494048399542224}
2021-09-24 23:14:00,638 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2272036059314735, 'mdape': 0.18442611896841982, 'rmse': 13885.592753634444, 'r2': 0.6302763409985201, 'raif_metric': 1.224031210932998}
2021-09-24 23:14:00,952 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-24 23:14:00,954 __main__     INFO     Fit model
2021-09-24 23:14:00,954 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:15:49,063 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:15:49,075 raif_hack.model INFO     Corr coef: -0.05
2021-09-24 23:15:49,075 __main__     INFO     Save model
2021-09-24 23:16:36,174 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5203061909539701, 'mdape': 0.31218800075756536, 'rmse': 73829.653260486, 'r2': 0.8178506868350007, 'raif_metric': 3.490956232442372}
2021-09-24 23:16:36,187 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2767973607358291, 'mdape': 0.10075260743925304, 'rmse': 13590.770570547133, 'r2': 0.5434226590112086, 'raif_metric': 3.079812202798365}
2021-09-24 23:16:36,494 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 23:16:36,496 __main__     INFO     Fit model
2021-09-24 23:16:36,496 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:18:24,558 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:18:24,571 raif_hack.model INFO     Corr coef: 0.07
2021-09-24 23:18:24,571 __main__     INFO     Save model
2021-09-24 23:19:11,992 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5207779173264961, 'mdape': 0.31286973723203837, 'rmse': 74040.98562826462, 'r2': 0.8167797060019779, 'raif_metric': 3.496191070428326}
2021-09-24 23:19:12,005 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30493994005808417, 'mdape': 0.15588840984276192, 'rmse': 44300.63700113316, 'r2': 0.583838532339398, 'raif_metric': 2.0281128328196796}
2021-09-24 23:19:12,321 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-24 23:19:12,323 __main__     INFO     Fit model
2021-09-24 23:19:12,323 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:21:01,307 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:21:01,321 raif_hack.model INFO     Corr coef: 0.15
2021-09-24 23:21:01,322 __main__     INFO     Save model
2021-09-24 23:21:48,672 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521161488101138, 'mdape': 0.31287754697626624, 'rmse': 73950.96647986142, 'r2': 0.8171673640274216, 'raif_metric': 3.4957283541671935}
2021-09-24 23:21:48,685 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.381655626961979, 'mdape': 0.2747496708012261, 'rmse': 87787.70682297873, 'r2': 0.7216020685729208, 'raif_metric': 3.687001710282827}
2021-09-24 23:21:48,989 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 23:21:48,991 __main__     INFO     Fit model
2021-09-24 23:21:48,991 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:23:37,556 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:23:37,569 raif_hack.model INFO     Corr coef: -0.19
2021-09-24 23:23:37,570 __main__     INFO     Save model
2021-09-24 23:24:25,063 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5231039759768803, 'mdape': 0.3125968811625673, 'rmse': 73892.64914892295, 'r2': 0.8175079941767109, 'raif_metric': 3.496168838196194}
2021-09-24 23:24:25,076 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23483443406084717, 'mdape': 0.2403223571003748, 'rmse': 12210.44651255443, 'r2': 0.6015091339050427, 'raif_metric': 1.3705299083850142}
2021-09-24 23:24:25,397 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-24 23:24:25,400 __main__     INFO     Fit model
2021-09-24 23:24:25,400 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:26:14,168 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:26:14,182 raif_hack.model INFO     Corr coef: -0.20
2021-09-24 23:26:14,183 __main__     INFO     Save model
2021-09-24 23:27:01,981 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210751135121137, 'mdape': 0.31280136340817644, 'rmse': 73853.28643110588, 'r2': 0.817651146472294, 'raif_metric': 3.4933140683604664}
2021-09-24 23:27:01,995 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21058649468774107, 'mdape': 0.23461956251821625, 'rmse': 19001.020993052553, 'r2': 0.8192836583322359, 'raif_metric': 0.6884777777226073}
2021-09-24 23:27:02,306 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-24 23:27:02,308 __main__     INFO     Fit model
2021-09-24 23:27:02,308 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:28:50,355 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:28:50,367 raif_hack.model INFO     Corr coef: -0.29
2021-09-24 23:28:50,367 __main__     INFO     Save model
2021-09-24 23:29:37,592 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.519502190308779, 'mdape': 0.31289913001457836, 'rmse': 73954.2808465001, 'r2': 0.8171592210306544, 'raif_metric': 3.495028834761432}
2021-09-24 23:29:37,604 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21769357219922883, 'mdape': 0.2420677891598178, 'rmse': 22475.00777599057, 'r2': 0.22126405759853862, 'raif_metric': 1.3632822959598798}
2021-09-24 23:29:37,912 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 23:29:37,915 __main__     INFO     Fit model
2021-09-24 23:29:37,915 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:31:25,754 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:31:25,768 raif_hack.model INFO     Corr coef: 0.13
2021-09-24 23:31:25,768 __main__     INFO     Save model
2021-09-24 23:32:12,428 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5229859845319464, 'mdape': 0.3129976872786486, 'rmse': 73963.28102402904, 'r2': 0.8170552961926645, 'raif_metric': 3.49840885116092}
2021-09-24 23:32:12,441 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2438620485490277, 'mdape': 0.2112246142718429, 'rmse': 19588.510476382304, 'r2': 0.3668197537595823, 'raif_metric': 1.2548232449381989}
2021-09-24 23:32:12,750 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-24 23:32:12,753 __main__     INFO     Fit model
2021-09-24 23:32:12,753 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:34:01,509 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:34:01,522 raif_hack.model INFO     Corr coef: -0.20
2021-09-24 23:34:01,522 __main__     INFO     Save model
2021-09-24 23:34:49,119 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5237859820322268, 'mdape': 0.3128772222806486, 'rmse': 74028.72914758818, 'r2': 0.8168618564279557, 'raif_metric': 3.4987649107312597}
2021-09-24 23:34:49,132 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30011190990616865, 'mdape': 0.28630978621416503, 'rmse': 27133.772395626314, 'r2': -0.35902255977071285, 'raif_metric': 2.4414561011592015}
2021-09-24 23:34:49,443 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-24 23:34:49,446 __main__     INFO     Fit model
2021-09-24 23:34:49,446 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:36:37,983 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:36:37,998 raif_hack.model INFO     Corr coef: -0.21
2021-09-24 23:36:37,998 __main__     INFO     Save model
2021-09-24 23:37:24,991 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5234299958635862, 'mdape': 0.31331816869029105, 'rmse': 74055.85062867036, 'r2': 0.8168167896649394, 'raif_metric': 3.4987262129094936}
2021-09-24 23:37:25,005 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.19489635866909938, 'mdape': 0.1790502083427, 'rmse': 22625.959561173342, 'r2': 0.4642904560714476, 'raif_metric': 1.2097571776830824}
2021-09-24 23:37:25,317 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 23:37:25,321 __main__     INFO     Fit model
2021-09-24 23:37:25,321 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:39:13,335 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:39:13,347 raif_hack.model INFO     Corr coef: -0.41
2021-09-24 23:39:13,347 __main__     INFO     Save model
2021-09-24 23:40:00,128 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5223557711643596, 'mdape': 0.3125314759953249, 'rmse': 73964.56607252604, 'r2': 0.817224232915782, 'raif_metric': 3.4943531243775805}
2021-09-24 23:40:00,141 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.18259911923579775, 'mdape': 0.1360534060527942, 'rmse': 43529.89136030539, 'r2': 0.18031631176139984, 'raif_metric': 1.3116649890701924}
2021-09-24 23:40:00,449 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-24 23:40:00,452 __main__     INFO     Fit model
2021-09-24 23:40:00,452 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:41:48,018 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:41:48,030 raif_hack.model INFO     Corr coef: 0.25
2021-09-24 23:41:48,030 __main__     INFO     Save model
2021-09-24 23:42:34,899 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5230318630958941, 'mdape': 0.31319272961307343, 'rmse': 73910.8207233403, 'r2': 0.8175176358686499, 'raif_metric': 3.4983422055172535}
2021-09-24 23:42:34,911 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2828631788710904, 'mdape': 0.26087544502416965, 'rmse': 30391.891363244547, 'r2': -0.06919972440452793, 'raif_metric': 2.723926447712492}
2021-09-24 23:42:35,213 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 23:42:35,215 __main__     INFO     Fit model
2021-09-24 23:42:35,215 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:44:24,312 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:44:24,325 raif_hack.model INFO     Corr coef: -0.25
2021-09-24 23:44:24,325 __main__     INFO     Save model
2021-09-24 23:45:13,230 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52153667245476, 'mdape': 0.31262655563962954, 'rmse': 74026.390167228, 'r2': 0.8170394728829684, 'raif_metric': 3.494626024220427}
2021-09-24 23:45:13,243 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21389881737149052, 'mdape': 0.21303256477236307, 'rmse': 17231.120653366484, 'r2': 0.3850665179913597, 'raif_metric': 1.3735928127010983}
2021-09-24 23:45:13,561 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 23:45:13,563 __main__     INFO     Fit model
2021-09-24 23:45:13,563 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:45:30,859 __main__     INFO     START predict.py
2021-09-24 23:45:30,859 __main__     INFO     Load test df
2021-09-24 23:45:30,892 __main__     INFO     Input shape: (2974, 76)
2021-09-24 23:45:30,896 __main__     INFO     Load model
2021-09-24 23:45:30,934 __main__     INFO     Predict
2021-09-24 23:45:31,059 __main__     INFO     Predict
2021-09-24 23:45:31,158 __main__     INFO     Predict
2021-09-24 23:45:31,280 __main__     INFO     Predict
2021-09-24 23:45:31,408 __main__     INFO     Predict
2021-09-24 23:45:31,540 __main__     INFO     Predict
2021-09-24 23:45:31,674 __main__     INFO     Predict
2021-09-24 23:45:31,801 __main__     INFO     Predict
2021-09-24 23:45:31,928 __main__     INFO     Predict
2021-09-24 23:45:32,053 __main__     INFO     Predict
2021-09-24 23:45:32,177 __main__     INFO     Predict
2021-09-24 23:45:32,300 __main__     INFO     Predict
2021-09-24 23:45:32,427 __main__     INFO     Predict
2021-09-24 23:45:32,554 __main__     INFO     Predict
2021-09-24 23:45:32,677 __main__     INFO     Predict
2021-09-24 23:45:32,804 __main__     INFO     Predict
2021-09-24 23:45:32,928 __main__     INFO     Predict
2021-09-24 23:45:33,051 __main__     INFO     Predict
2021-09-24 23:45:33,175 __main__     INFO     Predict
2021-09-24 23:45:33,274 __main__     INFO     Predict
2021-09-24 23:45:33,400 __main__     INFO     Predict
2021-09-24 23:45:33,525 __main__     INFO     Predict
2021-09-24 23:45:33,652 __main__     INFO     Predict
2021-09-24 23:45:33,776 __main__     INFO     Predict
2021-09-24 23:45:33,899 __main__     INFO     Predict
2021-09-24 23:45:34,018 __main__     INFO     Predict
2021-09-24 23:45:34,142 __main__     INFO     Predict
2021-09-24 23:45:34,269 __main__     INFO     Predict
2021-09-24 23:45:34,394 __main__     INFO     Predict
2021-09-24 23:45:34,517 __main__     INFO     Predict
2021-09-24 23:45:34,640 __main__     INFO     Predict
2021-09-24 23:45:34,747 __main__     INFO     Predict
2021-09-24 23:45:34,875 __main__     INFO     Predict
2021-09-24 23:45:34,999 __main__     INFO     Predict
2021-09-24 23:45:35,124 __main__     INFO     Predict
2021-09-24 23:45:35,207 __main__     INFO     Save results
2021-09-24 23:45:35,218 __main__     INFO     END predict.py
2021-09-24 23:45:46,219 __main__     INFO     START predict.py
2021-09-24 23:45:46,219 __main__     INFO     Load test df
2021-09-24 23:45:46,250 __main__     INFO     Input shape: (2974, 76)
2021-09-24 23:45:46,253 __main__     INFO     Load model
2021-09-24 23:45:46,294 __main__     INFO     Predict
2021-09-24 23:45:46,422 __main__     INFO     Predict
2021-09-24 23:45:46,545 __main__     INFO     Predict
2021-09-24 23:45:46,661 __main__     INFO     Predict
2021-09-24 23:45:46,789 __main__     INFO     Predict
2021-09-24 23:45:46,904 __main__     INFO     Predict
2021-09-24 23:45:47,029 __main__     INFO     Predict
2021-09-24 23:45:47,157 __main__     INFO     Predict
2021-09-24 23:45:47,282 __main__     INFO     Predict
2021-09-24 23:45:47,408 __main__     INFO     Predict
2021-09-24 23:45:47,535 __main__     INFO     Predict
2021-09-24 23:45:47,662 __main__     INFO     Predict
2021-09-24 23:45:47,785 __main__     INFO     Predict
2021-09-24 23:45:47,907 __main__     INFO     Predict
2021-09-24 23:45:48,036 __main__     INFO     Predict
2021-09-24 23:45:48,162 __main__     INFO     Predict
2021-09-24 23:45:48,287 __main__     INFO     Predict
2021-09-24 23:45:48,410 __main__     INFO     Predict
2021-09-24 23:45:48,534 __main__     INFO     Predict
2021-09-24 23:45:48,658 __main__     INFO     Predict
2021-09-24 23:45:48,783 __main__     INFO     Predict
2021-09-24 23:45:48,908 __main__     INFO     Predict
2021-09-24 23:45:49,039 __main__     INFO     Predict
2021-09-24 23:45:49,165 __main__     INFO     Predict
2021-09-24 23:45:49,274 __main__     INFO     Predict
2021-09-24 23:45:49,400 __main__     INFO     Predict
2021-09-24 23:45:49,528 __main__     INFO     Predict
2021-09-24 23:45:49,660 __main__     INFO     Predict
2021-09-24 23:45:49,790 __main__     INFO     Predict
2021-09-24 23:45:49,914 __main__     INFO     Predict
2021-09-24 23:45:50,040 __main__     INFO     Predict
2021-09-24 23:45:50,164 __main__     INFO     Predict
2021-09-24 23:45:50,291 __main__     INFO     Predict
2021-09-24 23:45:50,437 __main__     INFO     Predict
2021-09-24 23:45:50,577 __main__     INFO     Predict
2021-09-24 23:45:50,661 __main__     INFO     Save results
2021-09-24 23:45:50,672 __main__     INFO     END predict.py
2021-09-24 23:47:03,563 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:47:03,577 raif_hack.model INFO     Corr coef: -0.26
2021-09-24 23:47:03,577 __main__     INFO     Save model
2021-09-24 23:47:51,457 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5209646502210992, 'mdape': 0.312656578762948, 'rmse': 73811.99633202268, 'r2': 0.8179317100989326, 'raif_metric': 3.4948211300142997}
2021-09-24 23:47:51,470 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21605340131662265, 'mdape': 0.096265623166489, 'rmse': 12193.411086080265, 'r2': 0.5226222327264292, 'raif_metric': 1.2483594835500373}
2021-09-24 23:47:51,795 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-24 23:47:51,798 __main__     INFO     Fit model
2021-09-24 23:47:51,798 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:49:41,047 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:49:41,060 raif_hack.model INFO     Corr coef: -0.24
2021-09-24 23:49:41,060 __main__     INFO     Save model
2021-09-24 23:50:27,805 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204580011370274, 'mdape': 0.3121445208015611, 'rmse': 73871.16585374248, 'r2': 0.8174310089421676, 'raif_metric': 3.490587131306772}
2021-09-24 23:50:27,818 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1707516064827139, 'mdape': 0.14729690895717196, 'rmse': 21774.624333097923, 'r2': 0.4620639989804688, 'raif_metric': 0.9285815300147247}
2021-09-24 23:50:28,118 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-24 23:50:28,121 __main__     INFO     Fit model
2021-09-24 23:50:28,121 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:52:16,002 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:52:16,014 raif_hack.model INFO     Corr coef: 0.06
2021-09-24 23:52:16,014 __main__     INFO     Save model
2021-09-24 23:53:03,463 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5205417185763572, 'mdape': 0.31300150480084965, 'rmse': 73948.39420429371, 'r2': 0.8172434085696134, 'raif_metric': 3.4961915363673515}
2021-09-24 23:53:03,475 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.14739387725386413, 'mdape': 0.025731754611397838, 'rmse': 22091.64392134863, 'r2': 0.7080662795894794, 'raif_metric': 1.3215072018505853}
2021-09-24 23:53:03,785 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-24 23:53:03,788 __main__     INFO     Fit model
2021-09-24 23:53:03,788 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:54:52,814 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:54:52,827 raif_hack.model INFO     Corr coef: 0.05
2021-09-24 23:54:52,827 __main__     INFO     Save model
2021-09-24 23:55:41,016 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5205919752821029, 'mdape': 0.31273369935392337, 'rmse': 73959.92176729551, 'r2': 0.8170377772928197, 'raif_metric': 3.491762130988244}
2021-09-24 23:55:41,029 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3925620806945823, 'mdape': 0.17792517537042715, 'rmse': 64716.76068475247, 'r2': -5.249154496886992, 'raif_metric': 2.2101532478770136}
2021-09-24 23:55:41,336 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-24 23:55:41,338 __main__     INFO     Fit model
2021-09-24 23:55:41,339 raif_hack.model INFO     Fit lightgbm
2021-09-24 23:57:29,832 raif_hack.model INFO     Find corr coefficient
2021-09-24 23:57:29,845 raif_hack.model INFO     Corr coef: -0.16
2021-09-24 23:57:29,845 __main__     INFO     Save model
2021-09-24 23:58:17,077 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5200659097225626, 'mdape': 0.31278292275804465, 'rmse': 73943.5868859372, 'r2': 0.8173837605381028, 'raif_metric': 3.4946273303104936}
2021-09-24 23:58:17,091 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24049064296939449, 'mdape': 0.18947046527510988, 'rmse': 14125.20090652729, 'r2': -0.3194460816292093, 'raif_metric': 1.3477963117263398}
2021-09-24 23:58:17,406 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-24 23:58:17,409 __main__     INFO     Fit model
2021-09-24 23:58:17,409 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:00:05,180 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:00:05,193 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 00:00:05,193 __main__     INFO     Save model
2021-09-25 00:00:52,125 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5200114506700033, 'mdape': 0.31239789751654196, 'rmse': 73910.65149090298, 'r2': 0.8175313698437022, 'raif_metric': 3.494051622351471}
2021-09-25 00:00:52,137 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3794964828893018, 'mdape': 0.40877034109690896, 'rmse': 25256.973972602093, 'r2': 0.030542624707258992, 'raif_metric': 3.366380295316109}
2021-09-25 00:00:52,450 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 00:00:52,459 __main__     INFO     Fit model
2021-09-25 00:00:52,459 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:02:40,989 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:02:41,003 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 00:02:41,003 __main__     INFO     Save model
2021-09-25 00:03:28,967 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5212950541317503, 'mdape': 0.3129331228612683, 'rmse': 74005.56269085928, 'r2': 0.8170024943933231, 'raif_metric': 3.497925284013854}
2021-09-25 00:03:28,980 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2722924056430591, 'mdape': 0.2665959474859942, 'rmse': 29512.421510324268, 'r2': -0.5460783005116887, 'raif_metric': 2.407816621909745}
2021-09-25 00:03:29,286 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 00:03:29,288 __main__     INFO     Fit model
2021-09-25 00:03:29,288 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:05:17,491 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:05:17,503 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 00:05:17,503 __main__     INFO     Save model
2021-09-25 00:06:05,672 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.524668582854283, 'mdape': 0.31319692700010937, 'rmse': 73997.34038549673, 'r2': 0.8169694103654814, 'raif_metric': 3.498369562808979}
2021-09-25 00:06:05,684 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15940255554055346, 'mdape': 0.10026209307213695, 'rmse': 14558.487838691843, 'r2': 0.2163896921311147, 'raif_metric': 0.7867307645482955}
2021-09-25 00:06:05,989 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 00:06:05,991 __main__     INFO     Fit model
2021-09-25 00:06:05,991 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:07:54,369 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:07:54,381 raif_hack.model INFO     Corr coef: -0.23
2021-09-25 00:07:54,382 __main__     INFO     Save model
2021-09-25 00:08:41,694 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5217499126329521, 'mdape': 0.31287539275290843, 'rmse': 73853.31718869555, 'r2': 0.8176604100426093, 'raif_metric': 3.4950840141069244}
2021-09-25 00:08:41,707 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2340711627705338, 'mdape': 0.1582209027784124, 'rmse': 27613.459171420425, 'r2': 0.014334776707270014, 'raif_metric': 2.0254283055892808}
2021-09-25 00:08:42,011 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 00:08:42,013 __main__     INFO     Fit model
2021-09-25 00:08:42,013 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:10:30,185 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:10:30,198 raif_hack.model INFO     Corr coef: -0.30
2021-09-25 00:10:30,198 __main__     INFO     Save model
2021-09-25 00:11:18,468 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5247268902046556, 'mdape': 0.3131309654952276, 'rmse': 74096.395641788, 'r2': 0.8166505093058742, 'raif_metric': 3.4999042250643604}
2021-09-25 00:11:18,481 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24745694851154446, 'mdape': 0.2128800397822439, 'rmse': 30087.910750782125, 'r2': 0.265595853773839, 'raif_metric': 1.7818824962790991}
2021-09-25 00:11:18,785 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 00:11:18,788 __main__     INFO     Fit model
2021-09-25 00:11:18,788 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:13:07,024 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:13:07,036 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 00:13:07,037 __main__     INFO     Save model
2021-09-25 00:13:54,892 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211210725770765, 'mdape': 0.31261993452937975, 'rmse': 73995.9572869404, 'r2': 0.8169702352554731, 'raif_metric': 3.4941878657481227}
2021-09-25 00:13:54,906 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3131648902583659, 'mdape': 0.28926323855608843, 'rmse': 17670.08540519943, 'r2': 0.6874900738838234, 'raif_metric': 2.9271962302782444}
2021-09-25 00:13:55,209 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 00:13:55,211 __main__     INFO     Fit model
2021-09-25 00:13:55,211 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:15:43,335 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:15:43,347 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 00:15:43,348 __main__     INFO     Save model
2021-09-25 00:16:30,419 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.524857561852289, 'mdape': 0.31320063700431366, 'rmse': 74209.66213694953, 'r2': 0.8161185282164412, 'raif_metric': 3.4990004632171843}
2021-09-25 00:16:30,432 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1391675184025807, 'mdape': 0.1320819832847239, 'rmse': 10990.01166407057, 'r2': 0.6303995971252299, 'raif_metric': 0.2265810182613009}
2021-09-25 00:16:30,736 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 00:16:30,739 __main__     INFO     Fit model
2021-09-25 00:16:30,739 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:18:18,890 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:18:18,903 raif_hack.model INFO     Corr coef: 0.21
2021-09-25 00:18:18,903 __main__     INFO     Save model
2021-09-25 00:19:06,452 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52024426008372, 'mdape': 0.31220881352766516, 'rmse': 73983.42355295518, 'r2': 0.8171347151403882, 'raif_metric': 3.494035181529948}
2021-09-25 00:19:06,465 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2907306231791478, 'mdape': 0.2303624730829683, 'rmse': 23031.994042158865, 'r2': 0.952235275198143, 'raif_metric': 2.124487406658367}
2021-09-25 00:19:06,769 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 00:19:06,772 __main__     INFO     Fit model
2021-09-25 00:19:06,772 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:20:54,848 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:20:54,860 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 00:20:54,861 __main__     INFO     Save model
2021-09-25 00:21:42,061 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.523263944961646, 'mdape': 0.3132451165889311, 'rmse': 74172.24883738531, 'r2': 0.8161649545406691, 'raif_metric': 3.4981404968728396}
2021-09-25 00:21:42,073 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15663322442322292, 'mdape': 0.1390669194653123, 'rmse': 15192.948265824578, 'r2': 0.6120278736302989, 'raif_metric': 0.5284623264797533}
2021-09-25 00:21:42,379 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-25 00:21:42,382 __main__     INFO     Fit model
2021-09-25 00:21:42,383 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:23:30,245 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:23:30,258 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 00:23:30,258 __main__     INFO     Save model
2021-09-25 00:24:17,513 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208374169428165, 'mdape': 0.3127867921126219, 'rmse': 73787.51946033086, 'r2': 0.8180186331116114, 'raif_metric': 3.4988220639766174}
2021-09-25 00:24:17,527 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.31006971982939513, 'mdape': 0.26521698323417464, 'rmse': 86602.83735960828, 'r2': 0.6338960031128051, 'raif_metric': 2.938243913575351}
2021-09-25 00:24:17,837 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 00:24:17,839 __main__     INFO     Fit model
2021-09-25 00:24:17,839 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:26:06,913 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:26:06,927 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 00:26:06,927 __main__     INFO     Save model
2021-09-25 00:26:55,015 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5220725249451528, 'mdape': 0.3125622513008298, 'rmse': 73793.42613323948, 'r2': 0.8179860889551148, 'raif_metric': 3.492434682860263}
2021-09-25 00:26:55,029 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.36321913885217316, 'mdape': 0.43019661670041565, 'rmse': 33764.237266504024, 'r2': 0.5123318940296306, 'raif_metric': 3.3952540837482976}
2021-09-25 00:26:55,336 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 00:26:55,339 __main__     INFO     Fit model
2021-09-25 00:26:55,339 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:28:43,939 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:28:43,951 raif_hack.model INFO     Corr coef: -0.37
2021-09-25 00:28:43,951 __main__     INFO     Save model
2021-09-25 00:29:31,410 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5198984142987269, 'mdape': 0.3122726658410657, 'rmse': 73889.97042293745, 'r2': 0.817656197721148, 'raif_metric': 3.4906362586049684}
2021-09-25 00:29:31,422 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1987158053239411, 'mdape': 0.0714761778986029, 'rmse': 21988.532788986842, 'r2': -1.386826987056979, 'raif_metric': 1.5562764501942004}
2021-09-25 00:29:31,726 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 00:29:31,729 __main__     INFO     Fit model
2021-09-25 00:29:31,729 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:31:20,068 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:31:20,081 raif_hack.model INFO     Corr coef: -0.28
2021-09-25 00:31:20,081 __main__     INFO     Save model
2021-09-25 00:32:07,538 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520390499698068, 'mdape': 0.31240497447513854, 'rmse': 73779.4430878629, 'r2': 0.8179629427574819, 'raif_metric': 3.4936508573764287}
2021-09-25 00:32:07,550 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2365165419038484, 'mdape': 0.23938491995275737, 'rmse': 20778.59221245431, 'r2': 0.9784795946012138, 'raif_metric': 1.7831699309386149}
2021-09-25 00:32:07,856 __main__     INFO     X_offer (274756, 70)  y_offer (274756,)	X_manual (17, 70) y_manual (17,)
2021-09-25 00:32:07,858 __main__     INFO     Fit model
2021-09-25 00:32:07,859 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:33:56,551 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:33:56,565 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 00:33:56,565 __main__     INFO     Save model
2021-09-25 00:34:44,927 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221501694376836, 'mdape': 0.31282153780995403, 'rmse': 73910.2054583923, 'r2': 0.8173860463958904, 'raif_metric': 3.4938800969487294}
2021-09-25 00:34:44,941 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3302544797901737, 'mdape': 0.25506462896771165, 'rmse': 22579.89080857674, 'r2': 0.6635619748759698, 'raif_metric': 1.9804326784414699}
2021-09-25 00:34:45,247 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-25 00:34:45,250 __main__     INFO     Fit model
2021-09-25 00:34:45,250 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:36:33,562 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:36:33,575 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 00:36:33,575 __main__     INFO     Save model
2021-09-25 00:37:21,838 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521400826168313, 'mdape': 0.31282405485276893, 'rmse': 73954.94596989424, 'r2': 0.8172834833310691, 'raif_metric': 3.496565234187236}
2021-09-25 00:37:21,852 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22522778124934367, 'mdape': 0.11128916549797574, 'rmse': 15492.23354129517, 'r2': 0.19859997368796534, 'raif_metric': 1.6025183955303004}
2021-09-25 00:37:22,155 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 00:37:22,158 __main__     INFO     Fit model
2021-09-25 00:37:22,158 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:39:10,280 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:39:10,293 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 00:39:10,293 __main__     INFO     Save model
2021-09-25 00:39:57,426 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522930662823037, 'mdape': 0.31281052411610516, 'rmse': 73932.23023594501, 'r2': 0.8171535234930261, 'raif_metric': 3.4960421627358973}
2021-09-25 00:39:57,439 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.35654121590821886, 'mdape': 0.26942243563157353, 'rmse': 34736.43280968003, 'r2': 0.7466933475614408, 'raif_metric': 3.304984523582127}
2021-09-25 00:39:57,744 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 00:39:57,746 __main__     INFO     Fit model
2021-09-25 00:39:57,746 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:41:46,265 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:41:46,278 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 00:41:46,278 __main__     INFO     Save model
2021-09-25 00:42:34,194 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521518787824156, 'mdape': 0.3129771108686487, 'rmse': 74024.51410879496, 'r2': 0.8168747972637427, 'raif_metric': 3.49824762969112}
2021-09-25 00:42:34,207 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.19675095909122983, 'mdape': 0.10658800797678078, 'rmse': 29910.32654781557, 'r2': 0.17808248018745843, 'raif_metric': 1.4809650552360132}
2021-09-25 00:42:34,516 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 00:42:34,518 __main__     INFO     Fit model
2021-09-25 00:42:34,518 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:44:22,202 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:44:22,214 raif_hack.model INFO     Corr coef: 0.02
2021-09-25 00:44:22,214 __main__     INFO     Save model
2021-09-25 00:45:09,568 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5238914054414687, 'mdape': 0.31332552594875224, 'rmse': 74092.06405991875, 'r2': 0.8167458472702147, 'raif_metric': 3.502353327755192}
2021-09-25 00:45:09,581 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.35999588812387734, 'mdape': 0.2643986859011272, 'rmse': 44185.5406963572, 'r2': 0.438212083956832, 'raif_metric': 3.2414804445473058}
2021-09-25 00:45:09,885 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 00:45:09,887 __main__     INFO     Fit model
2021-09-25 00:45:09,887 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:46:58,236 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:46:58,249 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 00:46:58,249 __main__     INFO     Save model
2021-09-25 00:47:45,835 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213398842176888, 'mdape': 0.3129155444388263, 'rmse': 73924.99325763788, 'r2': 0.8172302306951411, 'raif_metric': 3.4947665528063534}
2021-09-25 00:47:45,848 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3579758459961842, 'mdape': 0.2320542113090393, 'rmse': 14306.695703197069, 'r2': 0.4689386906833575, 'raif_metric': 2.291989617184529}
2021-09-25 00:47:46,152 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 00:47:46,154 __main__     INFO     Fit model
2021-09-25 00:47:46,154 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:49:34,352 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:49:34,365 raif_hack.model INFO     Corr coef: -0.24
2021-09-25 00:49:34,365 __main__     INFO     Save model
2021-09-25 00:50:23,028 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5199953134911257, 'mdape': 0.31310395756919107, 'rmse': 73966.42496838082, 'r2': 0.8173061539202344, 'raif_metric': 3.497162143627082}
2021-09-25 00:50:23,041 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25135232149708525, 'mdape': 0.2718198299477594, 'rmse': 15050.878584828743, 'r2': 0.5180984465489846, 'raif_metric': 1.8344728273196218}
2021-09-25 00:50:23,346 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 00:50:23,349 __main__     INFO     Fit model
2021-09-25 00:50:23,349 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:52:11,724 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:52:11,738 raif_hack.model INFO     Corr coef: 0.02
2021-09-25 00:52:11,738 __main__     INFO     Save model
2021-09-25 00:52:59,523 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.524710347832899, 'mdape': 0.31320334155189355, 'rmse': 74017.89606101325, 'r2': 0.8168423156191309, 'raif_metric': 3.5000234008551545}
2021-09-25 00:52:59,536 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26428887463809764, 'mdape': 0.18009386383858478, 'rmse': 18916.621303735094, 'r2': 0.688239003238274, 'raif_metric': 1.6468231904386292}
2021-09-25 00:52:59,838 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 00:52:59,841 __main__     INFO     Fit model
2021-09-25 00:52:59,841 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:54:49,003 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:54:49,015 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 00:54:49,015 __main__     INFO     Save model
2021-09-25 00:55:36,052 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5195674587117938, 'mdape': 0.3126519078380782, 'rmse': 73841.86187701672, 'r2': 0.8177459927037395, 'raif_metric': 3.4945652938591496}
2021-09-25 00:55:36,064 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.20756310629493704, 'mdape': 0.18503694112178337, 'rmse': 16056.018050089098, 'r2': -0.012708888147056285, 'raif_metric': 1.3237125996861634}
2021-09-25 00:55:36,369 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 00:55:36,372 __main__     INFO     Fit model
2021-09-25 00:55:36,372 raif_hack.model INFO     Fit lightgbm
2021-09-25 00:57:24,497 raif_hack.model INFO     Find corr coefficient
2021-09-25 00:57:24,510 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 00:57:24,510 __main__     INFO     Save model
2021-09-25 00:58:12,711 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210699647624193, 'mdape': 0.31283925676848817, 'rmse': 73914.05191545561, 'r2': 0.8172988700651533, 'raif_metric': 3.4945156375604483}
2021-09-25 00:58:12,724 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4072157762336525, 'mdape': 0.27083736237378797, 'rmse': 89521.59230869926, 'r2': 0.5868906661866885, 'raif_metric': 2.858469600830019}
2021-09-25 00:58:13,028 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 00:58:13,030 __main__     INFO     Fit model
2021-09-25 00:58:13,030 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:00:00,674 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:00:00,685 raif_hack.model INFO     Corr coef: -0.00
2021-09-25 01:00:00,685 __main__     INFO     Save model
2021-09-25 01:00:47,270 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5233666824676009, 'mdape': 0.31304710415474296, 'rmse': 74043.61878327753, 'r2': 0.8166524162983873, 'raif_metric': 3.4961664711899765}
2021-09-25 01:00:47,281 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15051132357324248, 'mdape': 0.049434411650387325, 'rmse': 34757.37332535821, 'r2': 0.2393954272635137, 'raif_metric': 1.173635963789128}
2021-09-25 01:00:47,584 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 01:00:47,593 __main__     INFO     Fit model
2021-09-25 01:00:47,593 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:02:35,990 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:02:36,003 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 01:02:36,004 __main__     INFO     Save model
2021-09-25 01:03:22,851 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204089924107198, 'mdape': 0.31275128087938486, 'rmse': 73979.18078223045, 'r2': 0.8171179707796835, 'raif_metric': 3.4943894007721803}
2021-09-25 01:03:22,865 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23767556961279301, 'mdape': 0.2558779570291086, 'rmse': 17285.410211274426, 'r2': 0.7674066988570384, 'raif_metric': 1.2852601697441342}
2021-09-25 01:03:23,166 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 01:03:23,168 __main__     INFO     Fit model
2021-09-25 01:03:23,169 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:05:10,568 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:05:10,581 raif_hack.model INFO     Corr coef: 0.44
2021-09-25 01:05:10,581 __main__     INFO     Save model
2021-09-25 01:05:57,588 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5198081595635315, 'mdape': 0.3129091139437994, 'rmse': 73901.64775425041, 'r2': 0.8173086727921468, 'raif_metric': 3.4972390506301436}
2021-09-25 01:05:57,601 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1917930998848119, 'mdape': 0.14081364095594162, 'rmse': 14105.250453289986, 'r2': 0.8021703403235765, 'raif_metric': 1.2971599124789632}
2021-09-25 01:05:57,900 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 01:05:57,903 __main__     INFO     Fit model
2021-09-25 01:05:57,903 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:07:45,664 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:07:45,677 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 01:07:45,677 __main__     INFO     Save model
2021-09-25 01:08:34,195 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5191347094683194, 'mdape': 0.31287937324870285, 'rmse': 73965.67459292641, 'r2': 0.8171090444663438, 'raif_metric': 3.4940332272557013}
2021-09-25 01:08:34,208 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.5129482339859711, 'mdape': 0.37643857877537157, 'rmse': 26081.823763474385, 'r2': 0.6475307083752568, 'raif_metric': 4.219256808149882}
2021-09-25 01:08:34,513 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 01:08:34,515 __main__     INFO     Fit model
2021-09-25 01:08:34,515 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:10:22,455 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:10:22,467 raif_hack.model INFO     Corr coef: 0.15
2021-09-25 01:10:22,467 __main__     INFO     Save model
2021-09-25 01:11:10,520 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222865926589344, 'mdape': 0.31274356032476097, 'rmse': 74080.07950176735, 'r2': 0.8166158205359288, 'raif_metric': 3.494067100927311}
2021-09-25 01:11:10,532 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17155685483200858, 'mdape': 0.16092689632257215, 'rmse': 12733.27264541449, 'r2': -0.04500622692996359, 'raif_metric': 0.28816484840439677}
2021-09-25 01:11:10,835 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 01:11:10,837 __main__     INFO     Fit model
2021-09-25 01:11:10,837 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:12:58,634 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:12:58,646 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 01:12:58,646 __main__     INFO     Save model
2021-09-25 01:13:46,465 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5188290723039273, 'mdape': 0.31284560841093423, 'rmse': 73874.09287375121, 'r2': 0.8176578733970534, 'raif_metric': 3.497866973642315}
2021-09-25 01:13:46,477 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17019283619767978, 'mdape': 0.19440965912254798, 'rmse': 28704.33305999236, 'r2': 0.8049090191466869, 'raif_metric': 0.3044327240292665}
2021-09-25 01:13:46,778 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 01:13:46,780 __main__     INFO     Fit model
2021-09-25 01:13:46,780 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:15:34,007 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:15:34,020 raif_hack.model INFO     Corr coef: 0.25
2021-09-25 01:15:34,020 __main__     INFO     Save model
2021-09-25 01:16:22,033 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521529405299212, 'mdape': 0.31316291488492043, 'rmse': 73952.05240902797, 'r2': 0.817215393976105, 'raif_metric': 3.4970417758493477}
2021-09-25 01:16:22,045 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.40048449486025156, 'mdape': 0.3519496427845454, 'rmse': 29736.150640757678, 'r2': 0.9222792317172512, 'raif_metric': 3.7830685150604486}
2021-09-25 01:16:22,346 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 01:16:22,349 __main__     INFO     Fit model
2021-09-25 01:16:22,349 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:18:09,953 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:18:09,966 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 01:18:09,966 __main__     INFO     Save model
2021-09-25 01:18:56,679 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521701016249258, 'mdape': 0.3129366724935092, 'rmse': 73953.30212057622, 'r2': 0.8171639137091402, 'raif_metric': 3.496013622979432}
2021-09-25 01:18:56,691 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22796221406275274, 'mdape': 0.22106935556266796, 'rmse': 23340.348934014033, 'r2': 0.7319147564716149, 'raif_metric': 1.3641492516332514}
2021-09-25 01:18:56,991 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 01:18:56,999 __main__     INFO     Fit model
2021-09-25 01:18:56,999 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:20:44,786 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:20:44,798 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 01:20:44,799 __main__     INFO     Save model
2021-09-25 01:21:31,774 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5206382740804631, 'mdape': 0.31294468769770195, 'rmse': 74018.13586027815, 'r2': 0.816932451497804, 'raif_metric': 3.5004838408778234}
2021-09-25 01:21:31,786 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.19281084436818438, 'mdape': 0.18857542968700883, 'rmse': 11823.616493981055, 'r2': -0.004482013482800085, 'raif_metric': 0.8679324514023755}
2021-09-25 01:21:32,085 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 01:21:32,088 __main__     INFO     Fit model
2021-09-25 01:21:32,088 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:23:19,550 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:23:19,562 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 01:23:19,563 __main__     INFO     Save model
2021-09-25 01:24:08,064 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211543355222836, 'mdape': 0.31278084970481135, 'rmse': 73921.58426145707, 'r2': 0.8174554846011638, 'raif_metric': 3.4951937272836564}
2021-09-25 01:24:08,077 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26927243152215546, 'mdape': 0.224123807504028, 'rmse': 11781.699215610657, 'r2': 0.8730505359338603, 'raif_metric': 1.8051692281752503}
2021-09-25 01:24:08,388 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 01:24:08,391 __main__     INFO     Fit model
2021-09-25 01:24:08,391 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:25:56,299 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:25:56,310 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 01:25:56,310 __main__     INFO     Save model
2021-09-25 01:26:43,683 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5217088519969526, 'mdape': 0.3123310947792638, 'rmse': 73994.80388134131, 'r2': 0.8169812081176796, 'raif_metric': 3.4957817274509706}
2021-09-25 01:26:43,694 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.18904566528329467, 'mdape': 0.1537946358519392, 'rmse': 10145.438961743748, 'r2': 0.4931433362460661, 'raif_metric': 0.5114579151422579}
2021-09-25 01:26:43,994 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 01:26:43,996 __main__     INFO     Fit model
2021-09-25 01:26:43,996 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:28:32,430 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:28:32,443 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 01:28:32,443 __main__     INFO     Save model
2021-09-25 01:29:19,728 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5179204942824738, 'mdape': 0.31272323355391723, 'rmse': 73946.81554096483, 'r2': 0.8173520129528439, 'raif_metric': 3.4926660142227264}
2021-09-25 01:29:19,741 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3006943732479609, 'mdape': 0.23348149436078608, 'rmse': 18677.436928171424, 'r2': 0.18609450903791935, 'raif_metric': 1.3194662737253304}
2021-09-25 01:29:20,040 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 01:29:20,043 __main__     INFO     Fit model
2021-09-25 01:29:20,043 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:31:07,557 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:31:07,570 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 01:31:07,570 __main__     INFO     Save model
2021-09-25 01:31:54,810 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5234572901613046, 'mdape': 0.31267454966425895, 'rmse': 73996.58790313873, 'r2': 0.8170632300887531, 'raif_metric': 3.4962584598078665}
2021-09-25 01:31:54,823 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29826913297983637, 'mdape': 0.22436132695374036, 'rmse': 24466.402846183148, 'r2': -2.3021623781218423, 'raif_metric': 1.72429783361692}
2021-09-25 01:31:55,122 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 01:31:55,125 __main__     INFO     Fit model
2021-09-25 01:31:55,125 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:33:42,830 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:33:42,843 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 01:33:42,843 __main__     INFO     Save model
2021-09-25 01:34:30,581 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.525011099551745, 'mdape': 0.31332077889581106, 'rmse': 74074.36780357147, 'r2': 0.8166313414436192, 'raif_metric': 3.4979919708765053}
2021-09-25 01:34:30,594 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.32175764117748645, 'mdape': 0.23218863960405545, 'rmse': 42493.15305474854, 'r2': 0.20900678194829303, 'raif_metric': 1.6787030682922306}
2021-09-25 01:34:30,895 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 01:34:30,897 __main__     INFO     Fit model
2021-09-25 01:34:30,897 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:36:19,160 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:36:19,173 raif_hack.model INFO     Corr coef: 0.08
2021-09-25 01:36:19,173 __main__     INFO     Save model
2021-09-25 01:37:07,442 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208312645308377, 'mdape': 0.31213587542042565, 'rmse': 73860.63713179377, 'r2': 0.8175094845436208, 'raif_metric': 3.496103772823754}
2021-09-25 01:37:07,454 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2791331718205403, 'mdape': 0.19162566876599382, 'rmse': 21845.964980350334, 'r2': 0.4208410558548451, 'raif_metric': 1.5918791426540833}
2021-09-25 01:37:07,762 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 01:37:07,764 __main__     INFO     Fit model
2021-09-25 01:37:07,764 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:38:55,543 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:38:55,554 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 01:38:55,554 __main__     INFO     Save model
2021-09-25 01:39:42,623 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5230381867068306, 'mdape': 0.3130592158283468, 'rmse': 73992.90976261208, 'r2': 0.8169707045396508, 'raif_metric': 3.496983742533838}
2021-09-25 01:39:42,634 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.0557940743631221, 'mdape': 0.05021691968351773, 'rmse': 3638.933949660788, 'r2': 0.9914373859285817, 'raif_metric': 0.0}
2021-09-25 01:39:42,935 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 01:39:42,937 __main__     INFO     Fit model
2021-09-25 01:39:42,937 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:41:30,356 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:41:30,369 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 01:41:30,369 __main__     INFO     Save model
2021-09-25 01:42:16,983 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5235246570349408, 'mdape': 0.31368283862221014, 'rmse': 74060.95142440769, 'r2': 0.816725206971199, 'raif_metric': 3.5006306949457473}
2021-09-25 01:42:16,996 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30534714308392563, 'mdape': 0.25762571053331207, 'rmse': 15047.0429806623, 'r2': -2.1629552148479205, 'raif_metric': 2.2572028675107925}
2021-09-25 01:42:17,296 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 01:42:17,298 __main__     INFO     Fit model
2021-09-25 01:42:17,298 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:44:04,916 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:44:04,929 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 01:44:04,929 __main__     INFO     Save model
2021-09-25 01:44:51,810 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521962759239684, 'mdape': 0.3126475609104674, 'rmse': 73875.52386419188, 'r2': 0.8176397733336299, 'raif_metric': 3.495820439201184}
2021-09-25 01:44:51,823 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26842233687276335, 'mdape': 0.2887771212440029, 'rmse': 16844.24238821596, 'r2': 0.4805764682286545, 'raif_metric': 0.9688756599638972}
2021-09-25 01:44:52,123 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 01:44:52,126 __main__     INFO     Fit model
2021-09-25 01:44:52,126 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:46:39,732 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:46:39,745 raif_hack.model INFO     Corr coef: 0.15
2021-09-25 01:46:39,745 __main__     INFO     Save model
2021-09-25 01:47:27,010 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232537533698258, 'mdape': 0.31286218595913146, 'rmse': 74079.35090718858, 'r2': 0.8167776238042155, 'raif_metric': 3.4961751931633693}
2021-09-25 01:47:27,022 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4205235048663518, 'mdape': 0.2539635634862191, 'rmse': 26783.816524516893, 'r2': -0.8948770873629392, 'raif_metric': 2.8165403322451272}
2021-09-25 01:47:27,322 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 01:47:27,326 __main__     INFO     Fit model
2021-09-25 01:47:27,327 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:49:14,938 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:49:14,950 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 01:49:14,950 __main__     INFO     Save model
2021-09-25 01:50:01,638 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210640947874023, 'mdape': 0.31269495162963257, 'rmse': 73985.52074334199, 'r2': 0.8171401991830537, 'raif_metric': 3.499073321120085}
2021-09-25 01:50:01,650 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.34456104334501764, 'mdape': 0.25735966048171444, 'rmse': 18944.902788252977, 'r2': -0.45344991565782355, 'raif_metric': 3.1887069735117004}
2021-09-25 01:50:01,950 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-25 01:50:01,953 __main__     INFO     Fit model
2021-09-25 01:50:01,953 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:51:49,917 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:51:49,930 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 01:51:49,930 __main__     INFO     Save model
2021-09-25 01:52:38,059 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5201398225245653, 'mdape': 0.3123020065679387, 'rmse': 73926.14862239502, 'r2': 0.8174811150661249, 'raif_metric': 3.4922353760509095}
2021-09-25 01:52:38,073 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2766905494850217, 'mdape': 0.2619188625578851, 'rmse': 19987.392824883707, 'r2': 0.38234382582576276, 'raif_metric': 1.6965701050591018}
2021-09-25 01:52:38,375 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-25 01:52:38,378 __main__     INFO     Fit model
2021-09-25 01:52:38,378 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:54:26,466 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:54:26,479 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 01:54:26,480 __main__     INFO     Save model
2021-09-25 01:55:14,310 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5192058706956413, 'mdape': 0.31261452978912296, 'rmse': 73876.7348804682, 'r2': 0.8175068378702349, 'raif_metric': 3.4953108502773023}
2021-09-25 01:55:14,324 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2326191741886912, 'mdape': 0.21706661319570286, 'rmse': 16901.802181616415, 'r2': 0.6384414844493734, 'raif_metric': 1.222707255555959}
2021-09-25 01:55:14,630 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 01:55:14,632 __main__     INFO     Fit model
2021-09-25 01:55:14,632 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:57:02,588 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:57:02,600 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 01:57:02,600 __main__     INFO     Save model
2021-09-25 01:57:50,427 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5227396157868094, 'mdape': 0.3127792064564753, 'rmse': 73943.65735782975, 'r2': 0.8172294425485401, 'raif_metric': 3.4971224331395256}
2021-09-25 01:57:50,440 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23521525561027237, 'mdape': 0.1348737887470307, 'rmse': 99677.13801310674, 'r2': 0.5573828605199425, 'raif_metric': 2.269536441078019}
2021-09-25 01:57:50,743 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 01:57:50,746 __main__     INFO     Fit model
2021-09-25 01:57:50,746 raif_hack.model INFO     Fit lightgbm
2021-09-25 01:59:38,717 raif_hack.model INFO     Find corr coefficient
2021-09-25 01:59:38,729 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 01:59:38,729 __main__     INFO     Save model
2021-09-25 02:00:26,309 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5193299337917472, 'mdape': 0.31267257560243655, 'rmse': 73934.05630124232, 'r2': 0.8172917825609723, 'raif_metric': 3.4953054958192618}
2021-09-25 02:00:26,321 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3046285120051827, 'mdape': 0.40144663563399297, 'rmse': 23013.813636236093, 'r2': 0.3825237800803519, 'raif_metric': 2.3486310159100086}
2021-09-25 02:00:26,624 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 02:00:26,627 __main__     INFO     Fit model
2021-09-25 02:00:26,627 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:02:14,141 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:02:14,153 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 02:02:14,153 __main__     INFO     Save model
2021-09-25 02:03:01,519 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221768047983186, 'mdape': 0.3132436406066806, 'rmse': 74196.28483920496, 'r2': 0.8160704363019886, 'raif_metric': 3.5007788209124238}
2021-09-25 02:03:01,531 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.5242358246151902, 'mdape': 0.19952800648916283, 'rmse': 14375.832092049477, 'r2': 0.6878339681813923, 'raif_metric': 2.5961228694039096}
2021-09-25 02:03:01,837 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 02:03:01,839 __main__     INFO     Fit model
2021-09-25 02:03:01,840 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:04:49,944 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:04:49,957 raif_hack.model INFO     Corr coef: 0.13
2021-09-25 02:04:49,957 __main__     INFO     Save model
2021-09-25 02:05:37,102 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5183302571148685, 'mdape': 0.3127470883937112, 'rmse': 73918.89932762494, 'r2': 0.8175644234565134, 'raif_metric': 3.492580154623726}
2021-09-25 02:05:37,115 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4216874919435485, 'mdape': 0.2680605129274675, 'rmse': 79996.55866501696, 'r2': 0.66850212325865, 'raif_metric': 2.892839749986661}
2021-09-25 02:05:37,418 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 02:05:37,421 __main__     INFO     Fit model
2021-09-25 02:05:37,421 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:07:25,879 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:07:25,892 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 02:07:25,892 __main__     INFO     Save model
2021-09-25 02:08:13,816 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5169133609403003, 'mdape': 0.31243127712355406, 'rmse': 73900.88060431721, 'r2': 0.8173719343271761, 'raif_metric': 3.492248288596075}
2021-09-25 02:08:13,829 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3787545228917259, 'mdape': 0.24868147151954503, 'rmse': 46285.30473188003, 'r2': 0.7242885222679971, 'raif_metric': 2.7196999265918773}
2021-09-25 02:08:14,132 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 02:08:14,134 __main__     INFO     Fit model
2021-09-25 02:08:14,134 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:10:01,530 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:10:01,542 raif_hack.model INFO     Corr coef: 0.38
2021-09-25 02:10:01,543 __main__     INFO     Save model
2021-09-25 02:10:48,850 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522438545500107, 'mdape': 0.31277126143768486, 'rmse': 73917.57633164473, 'r2': 0.8173690538215221, 'raif_metric': 3.498810810581383}
2021-09-25 02:10:48,862 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3748759915733742, 'mdape': 0.3190509860238995, 'rmse': 191062.2460371112, 'r2': 0.1700281489445693, 'raif_metric': 3.3535861847508643}
2021-09-25 02:10:49,166 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 02:10:49,168 __main__     INFO     Fit model
2021-09-25 02:10:49,168 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:12:36,684 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:12:36,697 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 02:12:36,698 __main__     INFO     Save model
2021-09-25 02:13:23,847 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5240663542587622, 'mdape': 0.31280625849002236, 'rmse': 74103.58819093466, 'r2': 0.8166343766156653, 'raif_metric': 3.497192527916392}
2021-09-25 02:13:23,860 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24937522401725473, 'mdape': 0.1580747354267251, 'rmse': 25450.7218301812, 'r2': 0.6426258870109729, 'raif_metric': 1.9471695015478454}
2021-09-25 02:13:24,168 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 02:13:24,171 __main__     INFO     Fit model
2021-09-25 02:13:24,171 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:15:11,768 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:15:11,782 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 02:15:11,782 __main__     INFO     Save model
2021-09-25 02:15:58,475 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210963794258614, 'mdape': 0.31272809114593814, 'rmse': 74063.1251000768, 'r2': 0.8168456340666828, 'raif_metric': 3.496479996368524}
2021-09-25 02:15:58,488 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28876473308227063, 'mdape': 0.2327425126844057, 'rmse': 27964.89642323641, 'r2': 0.7644286729668045, 'raif_metric': 1.8867641172638505}
2021-09-25 02:15:58,790 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 02:15:58,794 __main__     INFO     Fit model
2021-09-25 02:15:58,794 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:17:46,358 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:17:46,370 raif_hack.model INFO     Corr coef: -0.23
2021-09-25 02:17:46,370 __main__     INFO     Save model
2021-09-25 02:18:34,265 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222211433082649, 'mdape': 0.31308251106349605, 'rmse': 73972.41413485841, 'r2': 0.8171880353120234, 'raif_metric': 3.496174532260069}
2021-09-25 02:18:34,277 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17791750027116646, 'mdape': 0.21436716685155244, 'rmse': 20155.65482246053, 'r2': 0.319603063677101, 'raif_metric': 0.7565572566695561}
2021-09-25 02:18:34,585 __main__     INFO     X_offer (274757, 70)  y_offer (274757,)	X_manual (18, 70) y_manual (18,)
2021-09-25 02:18:34,587 __main__     INFO     Fit model
2021-09-25 02:18:34,587 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:20:22,578 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:20:22,592 raif_hack.model INFO     Corr coef: -0.00
2021-09-25 02:20:22,592 __main__     INFO     Save model
2021-09-25 02:21:11,084 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5188770713238953, 'mdape': 0.31290387931978936, 'rmse': 73925.29759729882, 'r2': 0.8173290276935385, 'raif_metric': 3.494867690796989}
2021-09-25 02:21:11,098 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3496948619627067, 'mdape': 0.27392945547494413, 'rmse': 37285.26511178448, 'r2': 0.6645617801336423, 'raif_metric': 2.986372302198215}
2021-09-25 02:21:11,402 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 02:21:11,404 __main__     INFO     Fit model
2021-09-25 02:21:11,404 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:22:59,290 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:22:59,303 raif_hack.model INFO     Corr coef: 0.16
2021-09-25 02:22:59,303 __main__     INFO     Save model
2021-09-25 02:23:46,232 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5229496892899925, 'mdape': 0.31282992330620474, 'rmse': 73974.61502983904, 'r2': 0.8171677696883344, 'raif_metric': 3.4971771854533746}
2021-09-25 02:23:46,245 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2655188141400107, 'mdape': 0.14903507258062249, 'rmse': 35097.47642928795, 'r2': 0.4998152336564635, 'raif_metric': 2.188671538827682}
2021-09-25 02:23:46,547 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 02:23:46,549 __main__     INFO     Fit model
2021-09-25 02:23:46,549 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:25:34,279 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:25:34,292 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 02:25:34,292 __main__     INFO     Save model
2021-09-25 02:26:22,989 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5203623785164293, 'mdape': 0.3128964695481048, 'rmse': 74014.60186382552, 'r2': 0.8168950603171947, 'raif_metric': 3.4961268231116778}
2021-09-25 02:26:23,003 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24179099479622648, 'mdape': 0.23505764481750097, 'rmse': 37297.982729679454, 'r2': 0.7797639834874581, 'raif_metric': 1.7832991040899155}
2021-09-25 02:26:23,304 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 02:26:23,306 __main__     INFO     Fit model
2021-09-25 02:26:23,306 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:28:10,745 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:28:10,758 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 02:28:10,758 __main__     INFO     Save model
2021-09-25 02:28:58,159 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5164718899361838, 'mdape': 0.3128797132092157, 'rmse': 74018.61256962424, 'r2': 0.8169622721526832, 'raif_metric': 3.497734550850488}
2021-09-25 02:28:58,171 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4595356694650654, 'mdape': 0.3784854908574703, 'rmse': 24578.768921565632, 'r2': 0.08450707706894844, 'raif_metric': 3.9043079230155926}
2021-09-25 02:28:58,474 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:28:58,477 __main__     INFO     Fit model
2021-09-25 02:28:58,477 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:30:45,857 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:30:45,870 raif_hack.model INFO     Corr coef: -0.05
2021-09-25 02:30:45,870 __main__     INFO     Save model
2021-09-25 02:31:33,109 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5233444863966565, 'mdape': 0.31240666184461513, 'rmse': 73949.4857310953, 'r2': 0.8172988075131762, 'raif_metric': 3.4921620424526956}
2021-09-25 02:31:33,121 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.44132536582436344, 'mdape': 0.3693746777339396, 'rmse': 40013.29101898746, 'r2': -1.0251357894111064, 'raif_metric': 3.398102024189658}
2021-09-25 02:31:33,422 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:31:33,424 __main__     INFO     Fit model
2021-09-25 02:31:33,425 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:33:21,256 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:33:21,269 raif_hack.model INFO     Corr coef: -0.05
2021-09-25 02:33:21,269 __main__     INFO     Save model
2021-09-25 02:34:09,029 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5198413967441156, 'mdape': 0.3127330874625259, 'rmse': 74044.73435151063, 'r2': 0.8168757462995848, 'raif_metric': 3.4946950389252422}
2021-09-25 02:34:09,041 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3308803217125518, 'mdape': 0.3244083423918224, 'rmse': 17425.168040051343, 'r2': 0.03785905255154054, 'raif_metric': 2.868594843323705}
2021-09-25 02:34:09,343 __main__     INFO     X_offer (274742, 70)  y_offer (274742,)	X_manual (3, 70) y_manual (3,)
2021-09-25 02:34:09,345 __main__     INFO     Fit model
2021-09-25 02:34:09,345 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:35:57,204 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:35:57,215 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 02:35:57,215 __main__     INFO     Save model
2021-09-25 02:36:44,743 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5187173199437811, 'mdape': 0.3125886485004101, 'rmse': 73866.03776843582, 'r2': 0.8177276122667231, 'raif_metric': 3.4909859127721847}
2021-09-25 02:36:44,755 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15936999561386797, 'mdape': 0.08126571196540137, 'rmse': 8700.500000662878, 'r2': -0.28266291327177173, 'raif_metric': 0.9026977190986396}
2021-09-25 02:36:45,057 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:36:45,059 __main__     INFO     Fit model
2021-09-25 02:36:45,059 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:38:33,123 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:38:33,135 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 02:38:33,135 __main__     INFO     Save model
2021-09-25 02:39:20,089 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221220050812367, 'mdape': 0.3129912604389551, 'rmse': 73965.97367604681, 'r2': 0.8173400151489109, 'raif_metric': 3.495986933077912}
2021-09-25 02:39:20,101 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.12553088624001368, 'mdape': 0.11957943115242532, 'rmse': 8744.077388842943, 'r2': 0.7489510374891688, 'raif_metric': 0.12241689824157345}
2021-09-25 02:39:20,406 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 02:39:20,408 __main__     INFO     Fit model
2021-09-25 02:39:20,408 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:41:08,027 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:41:08,040 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 02:41:08,041 __main__     INFO     Save model
2021-09-25 02:41:55,226 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5209773550697363, 'mdape': 0.31283482222400094, 'rmse': 73958.35253415976, 'r2': 0.8171050293888925, 'raif_metric': 3.494210878466098}
2021-09-25 02:41:55,239 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26740553466265277, 'mdape': 0.27593030811712854, 'rmse': 17790.518323560296, 'r2': -0.09601881021437153, 'raif_metric': 1.5912862125160248}
2021-09-25 02:41:55,541 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:41:55,543 __main__     INFO     Fit model
2021-09-25 02:41:55,543 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:43:43,175 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:43:43,188 raif_hack.model INFO     Corr coef: -0.26
2021-09-25 02:43:43,188 __main__     INFO     Save model
2021-09-25 02:44:30,824 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208331431774884, 'mdape': 0.31255298552318883, 'rmse': 74006.23774013689, 'r2': 0.8170421265401655, 'raif_metric': 3.49486337372779}
2021-09-25 02:44:30,836 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.27570959417633056, 'mdape': 0.25243558286705925, 'rmse': 152950.14478872047, 'r2': 0.2729461555728946, 'raif_metric': 2.1511628882258957}
2021-09-25 02:44:31,138 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:44:31,140 __main__     INFO     Fit model
2021-09-25 02:44:31,140 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:46:18,576 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:46:18,588 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 02:46:18,589 __main__     INFO     Save model
2021-09-25 02:47:05,589 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5226807409257062, 'mdape': 0.3126120934410915, 'rmse': 74020.779382055, 'r2': 0.8169432410018088, 'raif_metric': 3.495092611162016}
2021-09-25 02:47:05,601 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21582658890276932, 'mdape': 0.16362056677130773, 'rmse': 22149.78200134721, 'r2': 0.7226897388333964, 'raif_metric': 1.43120597318518}
2021-09-25 02:47:05,902 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 02:47:05,904 __main__     INFO     Fit model
2021-09-25 02:47:05,904 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:48:53,981 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:48:53,994 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 02:48:53,994 __main__     INFO     Save model
2021-09-25 02:49:41,916 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5189617620333875, 'mdape': 0.3125795570898042, 'rmse': 73977.35626154025, 'r2': 0.817116738510331, 'raif_metric': 3.49524001738436}
2021-09-25 02:49:41,929 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2220879274922484, 'mdape': 0.2337539305414655, 'rmse': 43432.81055299661, 'r2': 0.69983693233595, 'raif_metric': 0.7341462375132808}
2021-09-25 02:49:42,235 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 02:49:42,238 __main__     INFO     Fit model
2021-09-25 02:49:42,238 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:51:29,645 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:51:29,657 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 02:51:29,657 __main__     INFO     Save model
2021-09-25 02:52:16,365 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520734018548994, 'mdape': 0.3129826418937589, 'rmse': 74013.87894343348, 'r2': 0.8169274239211513, 'raif_metric': 3.49766738670857}
2021-09-25 02:52:16,378 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2658288656166717, 'mdape': 0.25035155885208765, 'rmse': 19055.25354148346, 'r2': 0.7156374967401061, 'raif_metric': 1.9214875604482962}
2021-09-25 02:52:16,680 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 02:52:16,682 __main__     INFO     Fit model
2021-09-25 02:52:16,682 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:54:04,266 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:54:04,279 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 02:54:04,279 __main__     INFO     Save model
2021-09-25 02:54:51,733 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5219349484768223, 'mdape': 0.31252025342068296, 'rmse': 74072.30471778533, 'r2': 0.8165326188615611, 'raif_metric': 3.4974074977209164}
2021-09-25 02:54:51,746 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28439562494621423, 'mdape': 0.33591824879986537, 'rmse': 28087.840935819677, 'r2': -0.11467171824244216, 'raif_metric': 2.87824406269943}
2021-09-25 02:54:52,053 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 02:54:52,056 __main__     INFO     Fit model
2021-09-25 02:54:52,056 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:56:41,867 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:56:41,881 raif_hack.model INFO     Corr coef: -0.24
2021-09-25 02:56:41,881 __main__     INFO     Save model
2021-09-25 02:57:31,614 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5192903211378876, 'mdape': 0.3122633957805576, 'rmse': 73931.62278708888, 'r2': 0.817345628314571, 'raif_metric': 3.4956273436077216}
2021-09-25 02:57:31,627 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21670590688886554, 'mdape': 0.1592879438282071, 'rmse': 43357.44346830018, 'r2': 0.33703044876997246, 'raif_metric': 1.7667979902208828}
2021-09-25 02:57:31,941 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 02:57:31,944 __main__     INFO     Fit model
2021-09-25 02:57:31,944 raif_hack.model INFO     Fit lightgbm
2021-09-25 02:59:22,664 raif_hack.model INFO     Find corr coefficient
2021-09-25 02:59:22,678 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 02:59:22,678 __main__     INFO     Save model
2021-09-25 03:00:11,865 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232482286530182, 'mdape': 0.3130168871453965, 'rmse': 73891.7687478327, 'r2': 0.8176059372741, 'raif_metric': 3.495866214785953}
2021-09-25 03:00:11,878 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.12155672097561068, 'mdape': 0.09096056569700596, 'rmse': 5825.480802887867, 'r2': 0.591833627456168, 'raif_metric': 0.3176805653576331}
2021-09-25 03:00:12,190 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 03:00:12,192 __main__     INFO     Fit model
2021-09-25 03:00:12,192 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:02:02,217 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:02:02,230 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 03:02:02,231 __main__     INFO     Save model
2021-09-25 03:02:51,712 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5235956204124699, 'mdape': 0.3129274688450974, 'rmse': 73939.23350984915, 'r2': 0.8173527959820237, 'raif_metric': 3.4969365792099163}
2021-09-25 03:02:51,725 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.14199325382318548, 'mdape': 0.07932984357050743, 'rmse': 18572.392183929598, 'r2': 0.636833063633234, 'raif_metric': 0.5395929218295067}
2021-09-25 03:02:52,036 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 03:02:52,038 __main__     INFO     Fit model
2021-09-25 03:02:52,038 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:04:43,409 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:04:43,423 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 03:04:43,424 __main__     INFO     Save model
2021-09-25 03:05:34,029 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5195847560044622, 'mdape': 0.3125051091637133, 'rmse': 73852.10211976891, 'r2': 0.8177213384603025, 'raif_metric': 3.4930846993206033}
2021-09-25 03:05:34,043 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2062371527183476, 'mdape': 0.1911250560103319, 'rmse': 19011.822295869057, 'r2': 0.39122744560339273, 'raif_metric': 1.2886078084632384}
2021-09-25 03:05:34,356 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 03:05:34,358 __main__     INFO     Fit model
2021-09-25 03:05:34,358 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:07:25,290 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:07:25,304 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 03:07:25,304 __main__     INFO     Save model
2021-09-25 03:08:15,108 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5231426067209506, 'mdape': 0.31274774021405344, 'rmse': 74022.29854594292, 'r2': 0.8170976945720104, 'raif_metric': 3.4971857844576384}
2021-09-25 03:08:15,121 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26616664551010005, 'mdape': 0.2841485768312281, 'rmse': 28138.344885264956, 'r2': 0.592713614066974, 'raif_metric': 2.1911114089676085}
2021-09-25 03:08:15,437 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 03:08:15,439 __main__     INFO     Fit model
2021-09-25 03:08:15,439 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:10:05,509 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:10:05,523 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 03:10:05,523 __main__     INFO     Save model
2021-09-25 03:10:55,454 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.523301311382099, 'mdape': 0.3127241587162538, 'rmse': 73930.35208411324, 'r2': 0.8174695614715927, 'raif_metric': 3.4975122884526417}
2021-09-25 03:10:55,467 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2551036977285789, 'mdape': 0.2775400729902758, 'rmse': 14929.92733281555, 'r2': 0.7999371530733648, 'raif_metric': 1.311061283946181}
2021-09-25 03:10:55,783 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 03:10:55,785 __main__     INFO     Fit model
2021-09-25 03:10:55,785 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:12:46,174 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:12:46,188 raif_hack.model INFO     Corr coef: -0.40
2021-09-25 03:12:46,188 __main__     INFO     Save model
2021-09-25 03:13:35,492 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211957875893387, 'mdape': 0.3131019880748934, 'rmse': 73960.86977215212, 'r2': 0.8172849553666232, 'raif_metric': 3.49773110391263}
2021-09-25 03:13:35,505 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29661047474591495, 'mdape': 0.25523399686838777, 'rmse': 34068.78361450745, 'r2': -0.4182688446440874, 'raif_metric': 3.744889815091345}
2021-09-25 03:13:35,815 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 03:13:35,817 __main__     INFO     Fit model
2021-09-25 03:13:35,817 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:15:27,186 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:15:27,201 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 03:15:27,201 __main__     INFO     Save model
2021-09-25 03:16:18,638 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5199846234116277, 'mdape': 0.31258875623925025, 'rmse': 73930.58988928101, 'r2': 0.8173838593000147, 'raif_metric': 3.494120129166965}
2021-09-25 03:16:18,651 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23834725912236768, 'mdape': 0.2622317828939197, 'rmse': 18509.975525230995, 'r2': 0.0788390080678647, 'raif_metric': 1.3455885533169265}
2021-09-25 03:16:18,967 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 03:16:18,970 __main__     INFO     Fit model
2021-09-25 03:16:18,970 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:18:09,229 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:18:09,242 raif_hack.model INFO     Corr coef: 0.16
2021-09-25 03:18:09,242 __main__     INFO     Save model
2021-09-25 03:18:57,719 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5216706478842321, 'mdape': 0.3128365789836309, 'rmse': 74070.42152064038, 'r2': 0.816595793019207, 'raif_metric': 3.497252219394421}
2021-09-25 03:18:57,731 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.32385048889704704, 'mdape': 0.12902819882658112, 'rmse': 26998.927819387995, 'r2': -1.1964100051593491, 'raif_metric': 2.2814140731176646}
2021-09-25 03:18:58,038 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 03:18:58,040 __main__     INFO     Fit model
2021-09-25 03:18:58,040 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:20:48,314 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:20:48,327 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 03:20:48,327 __main__     INFO     Save model
2021-09-25 03:21:39,332 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520237200857207, 'mdape': 0.31294732820008136, 'rmse': 74006.50938368363, 'r2': 0.817071166972899, 'raif_metric': 3.496620865663673}
2021-09-25 03:21:39,345 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2982528686743587, 'mdape': 0.2834927232315936, 'rmse': 21551.175222674734, 'r2': -1.9993381394563805, 'raif_metric': 1.5024342064267147}
2021-09-25 03:21:39,669 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 03:21:39,671 __main__     INFO     Fit model
2021-09-25 03:21:39,671 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:23:30,705 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:23:30,719 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 03:23:30,719 __main__     INFO     Save model
2021-09-25 03:24:21,105 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5214982076012171, 'mdape': 0.31262188936200297, 'rmse': 73974.56176751613, 'r2': 0.8172212753801822, 'raif_metric': 3.496153897291346}
2021-09-25 03:24:21,118 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2551689866332175, 'mdape': 0.31137892928449656, 'rmse': 16685.03557267436, 'r2': -0.24014408837790469, 'raif_metric': 1.5629165737610045}
2021-09-25 03:24:21,439 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 03:24:21,441 __main__     INFO     Fit model
2021-09-25 03:24:21,441 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:26:12,373 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:26:12,386 raif_hack.model INFO     Corr coef: 0.12
2021-09-25 03:26:12,387 __main__     INFO     Save model
2021-09-25 03:27:02,981 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520661163911904, 'mdape': 0.3127477426550542, 'rmse': 73962.55825179484, 'r2': 0.8172925971949548, 'raif_metric': 3.4950188414354546}
2021-09-25 03:27:02,994 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.31182067056819324, 'mdape': 0.1589978287098801, 'rmse': 18232.461057292123, 'r2': -0.46883520558171, 'raif_metric': 2.5208579546789975}
2021-09-25 03:27:03,311 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 03:27:03,313 __main__     INFO     Fit model
2021-09-25 03:27:03,313 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:28:53,829 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:28:53,843 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 03:28:53,843 __main__     INFO     Save model
2021-09-25 03:29:44,146 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5201557469457354, 'mdape': 0.312187465859459, 'rmse': 73775.36259266737, 'r2': 0.81810777344038, 'raif_metric': 3.491384636464082}
2021-09-25 03:29:44,160 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21349848147193262, 'mdape': 0.19322293035958454, 'rmse': 12468.169950497962, 'r2': 0.8358537666808247, 'raif_metric': 1.135501936818156}
2021-09-25 03:29:44,472 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 03:29:44,475 __main__     INFO     Fit model
2021-09-25 03:29:44,475 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:31:33,914 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:31:33,927 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 03:31:33,927 __main__     INFO     Save model
2021-09-25 03:32:21,216 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5241404435672286, 'mdape': 0.31302837129835054, 'rmse': 73947.78382085281, 'r2': 0.817176160452022, 'raif_metric': 3.4988213963870427}
2021-09-25 03:32:21,228 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25604838503366945, 'mdape': 0.2914289733396995, 'rmse': 17454.978411798504, 'r2': -0.5989506340766861, 'raif_metric': 1.7894724367712782}
2021-09-25 03:32:21,530 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 03:32:21,532 __main__     INFO     Fit model
2021-09-25 03:32:21,532 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:34:09,740 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:34:09,754 raif_hack.model INFO     Corr coef: -0.29
2021-09-25 03:34:09,754 __main__     INFO     Save model
2021-09-25 03:34:56,834 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5193427071368295, 'mdape': 0.31265875988804187, 'rmse': 73866.44651479262, 'r2': 0.8176001770636452, 'raif_metric': 3.4942178877357053}
2021-09-25 03:34:56,847 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29062232664759136, 'mdape': 0.23256736202203815, 'rmse': 52382.80475464472, 'r2': -0.8387285101229667, 'raif_metric': 2.037813031243384}
2021-09-25 03:34:57,151 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 03:34:57,153 __main__     INFO     Fit model
2021-09-25 03:34:57,153 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:36:45,007 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:36:45,019 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 03:36:45,020 __main__     INFO     Save model
2021-09-25 03:37:32,714 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5192937045397397, 'mdape': 0.3129745821467729, 'rmse': 73972.77565327707, 'r2': 0.8171783336454596, 'raif_metric': 3.4973295961951356}
2021-09-25 03:37:32,727 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.14206013576342935, 'mdape': 0.08048854116396517, 'rmse': 9582.911276463781, 'r2': 0.25181408115443593, 'raif_metric': 0.5952856293560338}
2021-09-25 03:37:33,029 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 03:37:33,032 __main__     INFO     Fit model
2021-09-25 03:37:33,032 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:39:20,288 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:39:20,301 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 03:39:20,301 __main__     INFO     Save model
2021-09-25 03:40:06,993 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5209652907631748, 'mdape': 0.3128386081640253, 'rmse': 73930.36142606512, 'r2': 0.8172125807577926, 'raif_metric': 3.4946230185031304}
2021-09-25 03:40:07,006 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2689577712711184, 'mdape': 0.2783704816998434, 'rmse': 18412.330351568293, 'r2': 0.7777153455456295, 'raif_metric': 2.0111121626338817}
2021-09-25 03:40:07,309 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 03:40:07,311 __main__     INFO     Fit model
2021-09-25 03:40:07,311 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:41:55,363 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:41:55,377 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 03:41:55,377 __main__     INFO     Save model
2021-09-25 03:42:43,011 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5207752324701433, 'mdape': 0.3123798533871432, 'rmse': 74045.56889226983, 'r2': 0.8167838393879842, 'raif_metric': 3.492680633350907}
2021-09-25 03:42:43,024 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2826099263486791, 'mdape': 0.3913880500478981, 'rmse': 33997.112954904915, 'r2': 0.5138053584756365, 'raif_metric': 2.3016503749786286}
2021-09-25 03:42:43,327 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 03:42:43,329 __main__     INFO     Fit model
2021-09-25 03:42:43,329 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:44:30,254 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:44:30,266 raif_hack.model INFO     Corr coef: 0.10
2021-09-25 03:44:30,267 __main__     INFO     Save model
2021-09-25 03:45:18,417 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5225724231033608, 'mdape': 0.3129520881387915, 'rmse': 73949.63356450005, 'r2': 0.8172421900152969, 'raif_metric': 3.498910529210567}
2021-09-25 03:45:18,429 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1406598583421968, 'mdape': 0.04629081816062786, 'rmse': 13473.106019871491, 'r2': 0.9300629594175702, 'raif_metric': 0.8486261622346407}
2021-09-25 03:45:18,730 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 03:45:18,732 __main__     INFO     Fit model
2021-09-25 03:45:18,732 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:47:06,253 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:47:06,266 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 03:47:06,266 __main__     INFO     Save model
2021-09-25 03:47:53,838 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208758244791878, 'mdape': 0.3126880301741477, 'rmse': 73969.54816114139, 'r2': 0.8170932707986862, 'raif_metric': 3.495299788066198}
2021-09-25 03:47:53,852 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15937695818042724, 'mdape': 0.1373905403363693, 'rmse': 12301.492701809419, 'r2': 0.8583877616931328, 'raif_metric': 0.5866801766809027}
2021-09-25 03:47:54,163 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 03:47:54,165 __main__     INFO     Fit model
2021-09-25 03:47:54,165 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:49:42,335 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:49:42,347 raif_hack.model INFO     Corr coef: -0.24
2021-09-25 03:49:42,347 __main__     INFO     Save model
2021-09-25 03:50:29,750 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.518853980920761, 'mdape': 0.31243735212437757, 'rmse': 73912.77222025253, 'r2': 0.8174691870736721, 'raif_metric': 3.4950593898874116}
2021-09-25 03:50:29,762 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.306584154030023, 'mdape': 0.25686665288977306, 'rmse': 107461.61397565217, 'r2': 0.6224812147463572, 'raif_metric': 2.275240718117642}
2021-09-25 03:50:30,063 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 03:50:30,065 __main__     INFO     Fit model
2021-09-25 03:50:30,065 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:52:17,629 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:52:17,641 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 03:52:17,641 __main__     INFO     Save model
2021-09-25 03:53:03,992 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5235729590890728, 'mdape': 0.31278590722392446, 'rmse': 73865.90421284539, 'r2': 0.8176450350691569, 'raif_metric': 3.4985211141479002}
2021-09-25 03:53:04,004 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21073000254187332, 'mdape': 0.16918582846431185, 'rmse': 9614.469849854799, 'r2': 0.5484975542634303, 'raif_metric': 0.6790090534942479}
2021-09-25 03:53:04,306 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 03:53:04,308 __main__     INFO     Fit model
2021-09-25 03:53:04,308 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:54:52,495 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:54:52,507 raif_hack.model INFO     Corr coef: -0.26
2021-09-25 03:54:52,507 __main__     INFO     Save model
2021-09-25 03:55:39,413 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211246270295247, 'mdape': 0.3126695790315018, 'rmse': 73919.41404592391, 'r2': 0.8173657353307785, 'raif_metric': 3.49227348567886}
2021-09-25 03:55:39,426 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24299397733279487, 'mdape': 0.2294377745761774, 'rmse': 15082.407450307552, 'r2': 0.11854021143129467, 'raif_metric': 1.3298756603765893}
2021-09-25 03:55:39,728 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 03:55:39,731 __main__     INFO     Fit model
2021-09-25 03:55:39,731 raif_hack.model INFO     Fit lightgbm
2021-09-25 03:57:27,424 raif_hack.model INFO     Find corr coefficient
2021-09-25 03:57:27,436 raif_hack.model INFO     Corr coef: 0.24
2021-09-25 03:57:27,436 __main__     INFO     Save model
2021-09-25 03:58:14,899 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5231158468751453, 'mdape': 0.3128241115984317, 'rmse': 73973.02046821317, 'r2': 0.8171703866426875, 'raif_metric': 3.4955263047560265}
2021-09-25 03:58:14,912 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24022136330501992, 'mdape': 0.18364635570434415, 'rmse': 15288.039354545514, 'r2': 0.7916186485916956, 'raif_metric': 1.8127187305024266}
2021-09-25 03:58:15,214 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 03:58:15,216 __main__     INFO     Fit model
2021-09-25 03:58:15,217 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:00:02,626 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:00:02,638 raif_hack.model INFO     Corr coef: -0.34
2021-09-25 04:00:02,638 __main__     INFO     Save model
2021-09-25 04:00:49,698 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521217604056326, 'mdape': 0.31275121751021157, 'rmse': 74003.30452312276, 'r2': 0.817024042157953, 'raif_metric': 3.4955416360973217}
2021-09-25 04:00:49,710 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.14010860383374718, 'mdape': 0.15100934958537932, 'rmse': 18536.78128702795, 'r2': 0.8865309808700021, 'raif_metric': 0.09839081507056413}
2021-09-25 04:00:50,012 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 04:00:50,014 __main__     INFO     Fit model
2021-09-25 04:00:50,014 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:02:37,545 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:02:37,558 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 04:02:37,558 __main__     INFO     Save model
2021-09-25 04:03:25,103 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521523920157754, 'mdape': 0.31268377645387124, 'rmse': 73801.82846353119, 'r2': 0.817817673759257, 'raif_metric': 3.4924160289149837}
2021-09-25 04:03:25,116 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21831702274358877, 'mdape': 0.10075117570004384, 'rmse': 21619.88493087259, 'r2': 0.505326332556023, 'raif_metric': 1.636725767215323}
2021-09-25 04:03:25,417 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 04:03:25,420 __main__     INFO     Fit model
2021-09-25 04:03:25,420 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:05:13,146 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:05:13,159 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 04:05:13,159 __main__     INFO     Save model
2021-09-25 04:05:59,450 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213366986024377, 'mdape': 0.31283930233095386, 'rmse': 73947.60828354431, 'r2': 0.8172676555253386, 'raif_metric': 3.496533407548815}
2021-09-25 04:05:59,462 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2713594965780728, 'mdape': 0.22064094139244897, 'rmse': 20770.257108357404, 'r2': 0.07157693217332262, 'raif_metric': 1.31775132507725}
2021-09-25 04:05:59,764 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 04:05:59,766 __main__     INFO     Fit model
2021-09-25 04:05:59,767 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:07:47,003 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:07:47,015 raif_hack.model INFO     Corr coef: -0.20
2021-09-25 04:07:47,015 __main__     INFO     Save model
2021-09-25 04:08:33,851 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.51978492798022, 'mdape': 0.31299047913350275, 'rmse': 73967.18820081171, 'r2': 0.8172547148684747, 'raif_metric': 3.4967838744466078}
2021-09-25 04:08:33,863 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2914402930960928, 'mdape': 0.2811483447044602, 'rmse': 34848.14146654509, 'r2': -1.8610329695382357, 'raif_metric': 2.2684988601559177}
2021-09-25 04:08:34,163 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 04:08:34,166 __main__     INFO     Fit model
2021-09-25 04:08:34,166 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:10:21,510 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:10:21,524 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 04:10:21,524 __main__     INFO     Save model
2021-09-25 04:11:09,241 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5186624636754227, 'mdape': 0.31324590225748244, 'rmse': 73983.01876626852, 'r2': 0.817094294842672, 'raif_metric': 3.499751235413637}
2021-09-25 04:11:09,254 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24541513611956023, 'mdape': 0.1866421554049716, 'rmse': 18468.499302149165, 'r2': 0.38802552151660763, 'raif_metric': 1.980556188977747}
2021-09-25 04:11:09,556 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 04:11:09,558 __main__     INFO     Fit model
2021-09-25 04:11:09,558 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:12:57,198 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:12:57,211 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 04:12:57,211 __main__     INFO     Save model
2021-09-25 04:13:44,267 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5193453626233697, 'mdape': 0.3127030157462832, 'rmse': 73965.43829494699, 'r2': 0.8170655743262387, 'raif_metric': 3.494644851046956}
2021-09-25 04:13:44,280 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2788011332838053, 'mdape': 0.07349239942213447, 'rmse': 35171.73744498833, 'r2': 0.3565729120152319, 'raif_metric': 2.2301120257318767}
2021-09-25 04:13:44,584 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 04:13:44,587 __main__     INFO     Fit model
2021-09-25 04:13:44,587 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:15:32,293 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:15:32,306 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 04:15:32,306 __main__     INFO     Save model
2021-09-25 04:16:19,268 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520969204770879, 'mdape': 0.3134204295132229, 'rmse': 74045.28363192345, 'r2': 0.816807059778759, 'raif_metric': 3.502311064464909}
2021-09-25 04:16:19,280 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23300398517608495, 'mdape': 0.24203814553942155, 'rmse': 20182.29470137269, 'r2': 0.6699888021689588, 'raif_metric': 1.2776933647185058}
2021-09-25 04:16:19,583 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 04:16:19,585 __main__     INFO     Fit model
2021-09-25 04:16:19,585 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:18:07,263 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:18:07,275 raif_hack.model INFO     Corr coef: 0.06
2021-09-25 04:18:07,275 __main__     INFO     Save model
2021-09-25 04:18:54,398 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5196373644370027, 'mdape': 0.31252996442019443, 'rmse': 73869.98820654668, 'r2': 0.8176099770359591, 'raif_metric': 3.4949210678060494}
2021-09-25 04:18:54,411 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.19958429423412297, 'mdape': 0.16656075387218178, 'rmse': 14134.07798573307, 'r2': 0.498591884271808, 'raif_metric': 0.9919180442314177}
2021-09-25 04:18:54,712 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 04:18:54,714 __main__     INFO     Fit model
2021-09-25 04:18:54,714 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:20:42,477 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:20:42,489 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 04:20:42,489 __main__     INFO     Save model
2021-09-25 04:21:29,668 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5193701791981267, 'mdape': 0.3124553904099869, 'rmse': 73957.43758131379, 'r2': 0.8170111241649094, 'raif_metric': 3.4968414719557965}
2021-09-25 04:21:29,680 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3919024571274093, 'mdape': 0.3481514292271079, 'rmse': 105880.51798989087, 'r2': 0.49228464215112633, 'raif_metric': 3.900401529548026}
2021-09-25 04:21:29,982 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 04:21:29,984 __main__     INFO     Fit model
2021-09-25 04:21:29,984 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:23:18,148 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:23:18,160 raif_hack.model INFO     Corr coef: -0.25
2021-09-25 04:23:18,160 __main__     INFO     Save model
2021-09-25 04:24:04,625 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5182392442253496, 'mdape': 0.3124503044946098, 'rmse': 73910.79919032638, 'r2': 0.8175339168363293, 'raif_metric': 3.4937321123068643}
2021-09-25 04:24:04,637 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3040514835340381, 'mdape': 0.3363514383277584, 'rmse': 28598.22700151774, 'r2': 0.3192104602943351, 'raif_metric': 1.833808378299853}
2021-09-25 04:24:04,939 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 04:24:04,949 __main__     INFO     Fit model
2021-09-25 04:24:04,949 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:25:52,451 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:25:52,463 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 04:25:52,463 __main__     INFO     Save model
2021-09-25 04:26:39,631 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5218025808082685, 'mdape': 0.312814883634293, 'rmse': 73996.24639635097, 'r2': 0.8170980586760802, 'raif_metric': 3.4956727541684476}
2021-09-25 04:26:39,643 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.373283067949892, 'mdape': 0.46277876697534825, 'rmse': 28195.477136248388, 'r2': -2.0536374128600325, 'raif_metric': 3.879508208267578}
2021-09-25 04:26:39,945 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 04:26:39,947 __main__     INFO     Fit model
2021-09-25 04:26:39,947 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:28:27,780 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:28:27,793 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 04:28:27,793 __main__     INFO     Save model
2021-09-25 04:29:15,231 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5197399198137262, 'mdape': 0.3126477612515526, 'rmse': 73952.4325892323, 'r2': 0.8172556967111494, 'raif_metric': 3.4946019028383644}
2021-09-25 04:29:15,244 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21521883460491925, 'mdape': 0.20873375813439715, 'rmse': 16770.31613999015, 'r2': 0.7585483933801743, 'raif_metric': 1.1043271946568187}
2021-09-25 04:29:15,547 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 04:29:15,549 __main__     INFO     Fit model
2021-09-25 04:29:15,549 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:31:03,167 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:31:03,178 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 04:31:03,178 __main__     INFO     Save model
2021-09-25 04:31:50,174 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5212865616948723, 'mdape': 0.31254647566014726, 'rmse': 73918.82928473465, 'r2': 0.8174023077476382, 'raif_metric': 3.4955658968922987}
2021-09-25 04:31:50,186 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.15706016678008186, 'mdape': 0.10489293214734952, 'rmse': 23890.091660646525, 'r2': 0.21555376449920916, 'raif_metric': 1.0740670456114274}
2021-09-25 04:31:50,488 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 04:31:50,490 __main__     INFO     Fit model
2021-09-25 04:31:50,490 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:33:37,936 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:33:37,949 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 04:33:37,949 __main__     INFO     Save model
2021-09-25 04:34:25,057 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5226716669749008, 'mdape': 0.3128469436247274, 'rmse': 74003.39707998426, 'r2': 0.8170175524801995, 'raif_metric': 3.498008505172963}
2021-09-25 04:34:25,070 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21336242704516165, 'mdape': 0.21161722589679033, 'rmse': 14325.926777898805, 'r2': -0.5115512485025833, 'raif_metric': 1.1888070200576915}
2021-09-25 04:34:25,372 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 04:34:25,374 __main__     INFO     Fit model
2021-09-25 04:34:25,374 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:36:12,748 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:36:12,761 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 04:36:12,761 __main__     INFO     Save model
2021-09-25 04:36:58,692 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222607186339772, 'mdape': 0.3125287452365789, 'rmse': 73910.90743385835, 'r2': 0.8175149263075641, 'raif_metric': 3.494847459190527}
2021-09-25 04:36:58,705 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.20876311794148125, 'mdape': 0.1924088292319299, 'rmse': 24816.170587663448, 'r2': 0.9520745169289532, 'raif_metric': 0.8975818558585898}
2021-09-25 04:36:59,009 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 04:36:59,011 __main__     INFO     Fit model
2021-09-25 04:36:59,011 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:38:47,081 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:38:47,094 raif_hack.model INFO     Corr coef: -0.01
2021-09-25 04:38:47,094 __main__     INFO     Save model
2021-09-25 04:39:33,725 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5224024663896805, 'mdape': 0.3129864842066127, 'rmse': 74130.95595868501, 'r2': 0.8164131888236309, 'raif_metric': 3.4947473763822248}
2021-09-25 04:39:33,737 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.08141793699588472, 'mdape': 0.08796617659860581, 'rmse': 11753.342945756502, 'r2': 0.9335853410290891, 'raif_metric': 0.027859866836261692}
2021-09-25 04:39:34,040 __main__     INFO     X_offer (274757, 70)  y_offer (274757,)	X_manual (18, 70) y_manual (18,)
2021-09-25 04:39:34,042 __main__     INFO     Fit model
2021-09-25 04:39:34,042 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:41:21,166 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:41:21,181 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 04:41:21,181 __main__     INFO     Save model
2021-09-25 04:42:08,526 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232054942065518, 'mdape': 0.3127089077842544, 'rmse': 73944.32421801602, 'r2': 0.8173098369536012, 'raif_metric': 3.495298154389473}
2021-09-25 04:42:08,541 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24072576339666465, 'mdape': 0.21408395659292878, 'rmse': 17500.620854707835, 'r2': -0.043497168667681496, 'raif_metric': 1.3098400663849223}
2021-09-25 04:42:08,844 __main__     INFO     X_offer (274754, 70)  y_offer (274754,)	X_manual (15, 70) y_manual (15,)
2021-09-25 04:42:08,846 __main__     INFO     Fit model
2021-09-25 04:42:08,846 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:43:57,098 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:43:57,112 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 04:43:57,112 __main__     INFO     Save model
2021-09-25 04:44:44,545 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.519991303901368, 'mdape': 0.3125970863694696, 'rmse': 73911.90442678469, 'r2': 0.8174456054107646, 'raif_metric': 3.495276372610408}
2021-09-25 04:44:44,559 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2598436443289602, 'mdape': 0.26331020365031826, 'rmse': 40712.968766857506, 'r2': 0.7915434684441344, 'raif_metric': 1.6560497726332737}
2021-09-25 04:44:44,861 __main__     INFO     X_offer (274755, 70)  y_offer (274755,)	X_manual (16, 70) y_manual (16,)
2021-09-25 04:44:44,863 __main__     INFO     Fit model
2021-09-25 04:44:44,863 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:46:32,634 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:46:32,648 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 04:46:32,648 __main__     INFO     Save model
2021-09-25 04:47:20,616 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5207592826280605, 'mdape': 0.3126542523686693, 'rmse': 73809.19607720197, 'r2': 0.8178782952006127, 'raif_metric': 3.4942073614650586}
2021-09-25 04:47:20,629 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24488548815857936, 'mdape': 0.1660677568795, 'rmse': 16403.391384635503, 'r2': 0.6366335555324895, 'raif_metric': 1.8954076394244264}
2021-09-25 04:47:20,932 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 04:47:20,935 __main__     INFO     Fit model
2021-09-25 04:47:20,935 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:49:08,543 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:49:08,555 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 04:49:08,555 __main__     INFO     Save model
2021-09-25 04:49:56,422 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5212001674703897, 'mdape': 0.3123812485256652, 'rmse': 74020.88571792569, 'r2': 0.8168483656890597, 'raif_metric': 3.4939653970262903}
2021-09-25 04:49:56,434 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.197289894187112, 'mdape': 0.19798349239063906, 'rmse': 9862.247167887776, 'r2': -0.09341435110645224, 'raif_metric': 0.6063504235857936}
2021-09-25 04:49:56,736 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 04:49:56,738 __main__     INFO     Fit model
2021-09-25 04:49:56,738 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:51:44,235 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:51:44,247 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 04:51:44,247 __main__     INFO     Save model
2021-09-25 04:52:31,316 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520916330886555, 'mdape': 0.31237745654198124, 'rmse': 73914.41325941759, 'r2': 0.8174754259976147, 'raif_metric': 3.494595959916147}
2021-09-25 04:52:31,328 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.20896836739791666, 'mdape': 0.2180184964698802, 'rmse': 15054.60284108238, 'r2': 0.43041369170871846, 'raif_metric': 1.299746609195607}
2021-09-25 04:52:31,632 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 04:52:31,635 __main__     INFO     Fit model
2021-09-25 04:52:31,635 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:54:19,328 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:54:19,340 raif_hack.model INFO     Corr coef: -0.35
2021-09-25 04:54:19,340 __main__     INFO     Save model
2021-09-25 04:55:05,994 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222647660952182, 'mdape': 0.31274253985460543, 'rmse': 73913.50603096535, 'r2': 0.8174853671661851, 'raif_metric': 3.497899400747216}
2021-09-25 04:55:06,006 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.33217668110483356, 'mdape': 0.26348336991670057, 'rmse': 121557.14199775827, 'r2': -0.18301038583381724, 'raif_metric': 2.2272121356272243}
2021-09-25 04:55:06,308 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 04:55:06,310 __main__     INFO     Fit model
2021-09-25 04:55:06,310 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:56:53,934 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:56:53,947 raif_hack.model INFO     Corr coef: -0.02
2021-09-25 04:56:53,947 __main__     INFO     Save model
2021-09-25 04:57:40,672 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5223256331940531, 'mdape': 0.3127825193072351, 'rmse': 73966.74291714035, 'r2': 0.8172158115820408, 'raif_metric': 3.4979752445725847}
2021-09-25 04:57:40,685 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.34514089161821787, 'mdape': 0.2383460471905793, 'rmse': 43528.0545281678, 'r2': -1.0461560942264168, 'raif_metric': 2.0839099605271376}
2021-09-25 04:57:40,987 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 04:57:40,989 __main__     INFO     Fit model
2021-09-25 04:57:40,989 raif_hack.model INFO     Fit lightgbm
2021-09-25 04:59:28,553 raif_hack.model INFO     Find corr coefficient
2021-09-25 04:59:28,566 raif_hack.model INFO     Corr coef: -0.05
2021-09-25 04:59:28,566 __main__     INFO     Save model
2021-09-25 05:00:16,198 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213165832227982, 'mdape': 0.312514126505989, 'rmse': 73961.8187459041, 'r2': 0.8172875203033891, 'raif_metric': 3.493836263904628}
2021-09-25 05:00:16,211 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22788815682004282, 'mdape': 0.08151432586485517, 'rmse': 37009.52359875543, 'r2': 0.7757742386386989, 'raif_metric': 1.1514365082328935}
2021-09-25 05:00:16,514 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 05:00:16,517 __main__     INFO     Fit model
2021-09-25 05:00:16,517 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:02:04,317 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:02:04,329 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 05:02:04,329 __main__     INFO     Save model
2021-09-25 05:02:52,043 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5201001215438235, 'mdape': 0.312749442247617, 'rmse': 73940.8669596298, 'r2': 0.8174816049897093, 'raif_metric': 3.4959737260957007}
2021-09-25 05:02:52,055 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.26240512735946414, 'mdape': 0.21926924969202283, 'rmse': 26706.180042222262, 'r2': 0.5412743072882343, 'raif_metric': 2.3226064767417074}
2021-09-25 05:02:52,357 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 05:02:52,359 __main__     INFO     Fit model
2021-09-25 05:02:52,360 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:04:40,210 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:04:40,222 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 05:04:40,222 __main__     INFO     Save model
2021-09-25 05:05:27,940 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5225782633710547, 'mdape': 0.3129502524878979, 'rmse': 73942.55505163576, 'r2': 0.8172358019981174, 'raif_metric': 3.4937826796183633}
2021-09-25 05:05:27,952 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2735995913035493, 'mdape': 0.222374367041089, 'rmse': 43228.13026322856, 'r2': 0.7957875597705701, 'raif_metric': 2.0856904356481}
2021-09-25 05:05:28,255 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 05:05:28,257 __main__     INFO     Fit model
2021-09-25 05:05:28,257 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:07:16,036 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:07:16,048 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 05:07:16,048 __main__     INFO     Save model
2021-09-25 05:08:03,394 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5201025059963054, 'mdape': 0.31264209573887397, 'rmse': 73957.70108827892, 'r2': 0.8172949410852901, 'raif_metric': 3.49423046317047}
2021-09-25 05:08:03,406 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30009083735480807, 'mdape': 0.31319415397994743, 'rmse': 22225.44719664336, 'r2': 0.0609445180575211, 'raif_metric': 2.5650062723401845}
2021-09-25 05:08:03,706 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 05:08:03,708 __main__     INFO     Fit model
2021-09-25 05:08:03,708 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:09:51,487 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:09:51,500 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 05:09:51,500 __main__     INFO     Save model
2021-09-25 05:10:38,683 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5203507748628315, 'mdape': 0.3124020139721456, 'rmse': 73975.6795726285, 'r2': 0.8171174393869971, 'raif_metric': 3.4922781736719863}
2021-09-25 05:10:38,696 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1981998842749427, 'mdape': 0.12551875636572155, 'rmse': 14123.141814994682, 'r2': 0.5636006732101491, 'raif_metric': 1.2989628359730196}
2021-09-25 05:10:38,998 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 05:10:39,008 __main__     INFO     Fit model
2021-09-25 05:10:39,008 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:12:26,829 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:12:26,841 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 05:12:26,841 __main__     INFO     Save model
2021-09-25 05:13:14,793 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210524152591416, 'mdape': 0.3125129175483088, 'rmse': 73942.31470146454, 'r2': 0.8172315199856481, 'raif_metric': 3.494377098577791}
2021-09-25 05:13:14,805 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24743247001212657, 'mdape': 0.1311294077987628, 'rmse': 10421.682334885667, 'r2': 0.9504181735374553, 'raif_metric': 2.2563790795700083}
2021-09-25 05:13:15,106 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 05:13:15,108 __main__     INFO     Fit model
2021-09-25 05:13:15,108 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:15:03,294 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:15:03,308 raif_hack.model INFO     Corr coef: -0.28
2021-09-25 05:15:03,308 __main__     INFO     Save model
2021-09-25 05:15:50,772 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210925612907527, 'mdape': 0.31285827507742725, 'rmse': 73924.22571136837, 'r2': 0.8174639388006094, 'raif_metric': 3.49343627544566}
2021-09-25 05:15:50,785 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23340161437682191, 'mdape': 0.19503049626414976, 'rmse': 13025.249860612292, 'r2': 0.7828551832674332, 'raif_metric': 1.6125447298695577}
2021-09-25 05:15:51,087 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 05:15:51,090 __main__     INFO     Fit model
2021-09-25 05:15:51,090 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:17:38,680 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:17:38,693 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 05:17:38,693 __main__     INFO     Save model
2021-09-25 05:18:26,318 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5228052381994432, 'mdape': 0.31276148952012406, 'rmse': 74023.2184200188, 'r2': 0.8170220325639207, 'raif_metric': 3.4982700408515184}
2021-09-25 05:18:26,331 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3744569450814757, 'mdape': 0.32955936905967914, 'rmse': 20736.959931411107, 'r2': -0.08285731345394787, 'raif_metric': 3.2613150675695812}
2021-09-25 05:18:26,632 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 05:18:26,634 __main__     INFO     Fit model
2021-09-25 05:18:26,635 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:20:14,433 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:20:14,445 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 05:20:14,445 __main__     INFO     Save model
2021-09-25 05:21:02,093 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5198148369608404, 'mdape': 0.31267397661540763, 'rmse': 73948.9141902737, 'r2': 0.817244818219998, 'raif_metric': 3.493905822132786}
2021-09-25 05:21:02,106 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22272020369883458, 'mdape': 0.22635099094938796, 'rmse': 14073.226525707962, 'r2': -0.12032428275163709, 'raif_metric': 0.8486574466951853}
2021-09-25 05:21:02,409 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 05:21:02,412 __main__     INFO     Fit model
2021-09-25 05:21:02,412 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:22:50,187 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:22:50,199 raif_hack.model INFO     Corr coef: -0.27
2021-09-25 05:22:50,199 __main__     INFO     Save model
2021-09-25 05:23:37,217 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5194032999247868, 'mdape': 0.3125122228341447, 'rmse': 73887.35207245055, 'r2': 0.8176024140290999, 'raif_metric': 3.492951280850892}
2021-09-25 05:23:37,229 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2896848437664704, 'mdape': 0.2592549103238818, 'rmse': 26386.11199185248, 'r2': -0.301767283516883, 'raif_metric': 2.722195993097829}
2021-09-25 05:23:37,534 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 05:23:37,536 __main__     INFO     Fit model
2021-09-25 05:23:37,536 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:25:25,472 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:25:25,484 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 05:25:25,484 __main__     INFO     Save model
2021-09-25 05:26:13,255 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5231982450823431, 'mdape': 0.31276784629368876, 'rmse': 74097.75871144887, 'r2': 0.8165000891844285, 'raif_metric': 3.497690170021179}
2021-09-25 05:26:13,268 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.31265090982296884, 'mdape': 0.21212559110384444, 'rmse': 155687.2097536045, 'r2': 0.39428422828729803, 'raif_metric': 2.73676402489422}
2021-09-25 05:26:13,574 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 05:26:13,577 __main__     INFO     Fit model
2021-09-25 05:26:13,577 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:28:01,171 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:28:01,183 raif_hack.model INFO     Corr coef: -0.00
2021-09-25 05:28:01,183 __main__     INFO     Save model
2021-09-25 05:28:48,462 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520355693009964, 'mdape': 0.3123222983861622, 'rmse': 73977.26329533946, 'r2': 0.8170734831861519, 'raif_metric': 3.4939713674340176}
2021-09-25 05:28:48,474 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21727027054359996, 'mdape': 0.32255102200817304, 'rmse': 20349.528348608244, 'r2': -0.31964333993648, 'raif_metric': 1.2328267944298033}
2021-09-25 05:28:48,776 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 05:28:48,779 __main__     INFO     Fit model
2021-09-25 05:28:48,779 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:30:36,809 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:30:36,821 raif_hack.model INFO     Corr coef: -0.26
2021-09-25 05:30:36,821 __main__     INFO     Save model
2021-09-25 05:31:23,401 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5231250764678697, 'mdape': 0.3128729155740069, 'rmse': 73887.67170891243, 'r2': 0.8175186107048363, 'raif_metric': 3.496390901437528}
2021-09-25 05:31:23,414 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21669932293570202, 'mdape': 0.22041247591745022, 'rmse': 22805.486770761967, 'r2': 0.7906525869340562, 'raif_metric': 1.703677913049572}
2021-09-25 05:31:23,716 __main__     INFO     X_offer (274753, 70)  y_offer (274753,)	X_manual (14, 70) y_manual (14,)
2021-09-25 05:31:23,719 __main__     INFO     Fit model
2021-09-25 05:31:23,719 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:33:11,560 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:33:11,574 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 05:33:11,574 __main__     INFO     Save model
2021-09-25 05:33:59,396 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5218875768994087, 'mdape': 0.3132394867308799, 'rmse': 74155.66206774041, 'r2': 0.8163265216654878, 'raif_metric': 3.4985302276048404}
2021-09-25 05:33:59,410 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.32543442968239467, 'mdape': 0.2654568027823136, 'rmse': 61791.169847935395, 'r2': 0.67715678850844, 'raif_metric': 2.3861627003058863}
2021-09-25 05:33:59,727 __main__     INFO     X_offer (274743, 70)  y_offer (274743,)	X_manual (4, 70) y_manual (4,)
2021-09-25 05:33:59,730 __main__     INFO     Fit model
2021-09-25 05:33:59,730 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:35:47,591 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:35:47,603 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 05:35:47,603 __main__     INFO     Save model
2021-09-25 05:36:35,708 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204550547975184, 'mdape': 0.3127438010218635, 'rmse': 73955.53883763705, 'r2': 0.817155780629969, 'raif_metric': 3.4934448268598834}
2021-09-25 05:36:35,720 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3244104535268264, 'mdape': 0.33535484096757406, 'rmse': 23368.609045470716, 'r2': 0.5813050450867261, 'raif_metric': 1.857509035842921}
2021-09-25 05:36:36,035 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 05:36:36,038 __main__     INFO     Fit model
2021-09-25 05:36:36,038 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:38:24,217 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:38:24,230 raif_hack.model INFO     Corr coef: -0.33
2021-09-25 05:38:24,230 __main__     INFO     Save model
2021-09-25 05:39:11,855 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5200298880316045, 'mdape': 0.312411530515076, 'rmse': 73888.1324588147, 'r2': 0.8174437101608782, 'raif_metric': 3.4947818216106183}
2021-09-25 05:39:11,868 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1930364947912812, 'mdape': 0.1641207502267172, 'rmse': 24535.757545490364, 'r2': 0.6465717520348743, 'raif_metric': 0.5552829290508583}
2021-09-25 05:39:12,186 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 05:39:12,188 __main__     INFO     Fit model
2021-09-25 05:39:12,189 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:40:59,873 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:40:59,886 raif_hack.model INFO     Corr coef: -0.20
2021-09-25 05:40:59,887 __main__     INFO     Save model
2021-09-25 05:41:46,464 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5210049039183693, 'mdape': 0.3130683639504407, 'rmse': 74063.30403611595, 'r2': 0.8167708250725612, 'raif_metric': 3.4969040015673394}
2021-09-25 05:41:46,477 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2496105801118305, 'mdape': 0.26001099986553733, 'rmse': 24706.218206601556, 'r2': 0.7911793644194808, 'raif_metric': 1.9219798342638115}
2021-09-25 05:41:46,794 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 05:41:46,796 __main__     INFO     Fit model
2021-09-25 05:41:46,796 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:43:35,272 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:43:35,285 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 05:43:35,285 __main__     INFO     Save model
2021-09-25 05:44:22,131 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5200397934778394, 'mdape': 0.3121794123340832, 'rmse': 73836.83908194186, 'r2': 0.817847053107847, 'raif_metric': 3.4944207472668287}
2021-09-25 05:44:22,144 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2595144956234078, 'mdape': 0.20319510676142027, 'rmse': 19899.873459853632, 'r2': 0.32828081506753215, 'raif_metric': 2.0373622251758565}
2021-09-25 05:44:22,462 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 05:44:22,473 __main__     INFO     Fit model
2021-09-25 05:44:22,473 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:46:09,666 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:46:09,678 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 05:46:09,678 __main__     INFO     Save model
2021-09-25 05:46:56,891 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5202873109674915, 'mdape': 0.3131740472890605, 'rmse': 74036.33573201507, 'r2': 0.8168490603908292, 'raif_metric': 3.497635978665888}
2021-09-25 05:46:56,903 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16891369980802406, 'mdape': 0.18377117824750405, 'rmse': 8089.608994103419, 'r2': 0.95725675940548, 'raif_metric': 0.4334318627626392}
2021-09-25 05:46:57,223 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 05:46:57,225 __main__     INFO     Fit model
2021-09-25 05:46:57,225 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:48:45,113 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:48:45,126 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 05:48:45,127 __main__     INFO     Save model
2021-09-25 05:49:31,712 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5216642728274845, 'mdape': 0.3122316145617968, 'rmse': 73834.0436906854, 'r2': 0.8177659164122002, 'raif_metric': 3.4924990094058628}
2021-09-25 05:49:31,726 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.20589116331429594, 'mdape': 0.2023267077952728, 'rmse': 13001.439454192185, 'r2': 0.6860295860255632, 'raif_metric': 0.7279545670844746}
2021-09-25 05:49:32,043 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 05:49:32,045 __main__     INFO     Fit model
2021-09-25 05:49:32,045 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:51:19,781 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:51:19,793 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 05:51:19,793 __main__     INFO     Save model
2021-09-25 05:52:06,853 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521907698347605, 'mdape': 0.3127918222766839, 'rmse': 73929.57679087321, 'r2': 0.8172709011576447, 'raif_metric': 3.4958545624283697}
2021-09-25 05:52:06,866 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2942385503697334, 'mdape': 0.26454857456305714, 'rmse': 15388.525195867045, 'r2': 0.5373613442613703, 'raif_metric': 2.4514059654845965}
2021-09-25 05:52:07,186 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 05:52:07,188 __main__     INFO     Fit model
2021-09-25 05:52:07,188 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:53:55,122 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:53:55,134 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 05:53:55,134 __main__     INFO     Save model
2021-09-25 05:54:41,828 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5202778382643323, 'mdape': 0.3127162016477283, 'rmse': 73830.59533201533, 'r2': 0.8177467581899681, 'raif_metric': 3.497189821240984}
2021-09-25 05:54:41,841 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.38439450981171264, 'mdape': 0.33209448853325435, 'rmse': 25588.418761943503, 'r2': 0.5075556423152685, 'raif_metric': 3.304276314944437}
2021-09-25 05:54:42,160 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 05:54:42,163 __main__     INFO     Fit model
2021-09-25 05:54:42,163 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:56:29,583 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:56:29,595 raif_hack.model INFO     Corr coef: -0.11
2021-09-25 05:56:29,595 __main__     INFO     Save model
2021-09-25 05:57:17,756 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5225046123548824, 'mdape': 0.3131994106020336, 'rmse': 73967.47709388657, 'r2': 0.8173454548596548, 'raif_metric': 3.4984730366720433}
2021-09-25 05:57:17,769 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.18951798836198722, 'mdape': 0.06348945870600783, 'rmse': 23839.878721587615, 'r2': 0.6450782957147547, 'raif_metric': 1.4018732259987308}
2021-09-25 05:57:18,086 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 05:57:18,089 __main__     INFO     Fit model
2021-09-25 05:57:18,089 raif_hack.model INFO     Fit lightgbm
2021-09-25 05:59:06,127 raif_hack.model INFO     Find corr coefficient
2021-09-25 05:59:06,139 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 05:59:06,139 __main__     INFO     Save model
2021-09-25 05:59:53,355 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5195962361477797, 'mdape': 0.3129932712996043, 'rmse': 73882.38830571117, 'r2': 0.8176537698459132, 'raif_metric': 3.493687470213761}
2021-09-25 05:59:53,368 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2072755109055902, 'mdape': 0.18408192767296563, 'rmse': 30368.85115954796, 'r2': 0.7154966906260822, 'raif_metric': 1.3528829775999744}
2021-09-25 05:59:53,685 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 05:59:53,687 __main__     INFO     Fit model
2021-09-25 05:59:53,687 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:01:41,288 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:01:41,301 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 06:01:41,301 __main__     INFO     Save model
2021-09-25 06:02:28,395 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221314468146683, 'mdape': 0.3126731264405762, 'rmse': 73949.09119304168, 'r2': 0.8172489545949372, 'raif_metric': 3.4977107474684144}
2021-09-25 06:02:28,408 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1992279814434371, 'mdape': 0.16079557381724835, 'rmse': 20878.879854116218, 'r2': 0.16385809517971617, 'raif_metric': 1.2917510045900775}
2021-09-25 06:02:28,727 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 06:02:28,729 __main__     INFO     Fit model
2021-09-25 06:02:28,729 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:04:16,220 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:04:16,232 raif_hack.model INFO     Corr coef: -0.24
2021-09-25 06:04:16,232 __main__     INFO     Save model
2021-09-25 06:05:02,469 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521458527281678, 'mdape': 0.3124868949667783, 'rmse': 73892.80087407252, 'r2': 0.8177125133048568, 'raif_metric': 3.494795954743776}
2021-09-25 06:05:02,481 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2509848734500991, 'mdape': 0.19137808162095288, 'rmse': 29801.117894846288, 'r2': 0.5033373024414515, 'raif_metric': 2.2259575549699013}
2021-09-25 06:05:02,797 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 06:05:02,800 __main__     INFO     Fit model
2021-09-25 06:05:02,800 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:06:50,113 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:06:50,126 raif_hack.model INFO     Corr coef: -0.01
2021-09-25 06:06:50,126 __main__     INFO     Save model
2021-09-25 06:07:38,021 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5229580098819004, 'mdape': 0.31331400757437106, 'rmse': 74066.1869847119, 'r2': 0.8167190181496025, 'raif_metric': 3.500786574041035}
2021-09-25 06:07:38,034 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22987662708690604, 'mdape': 0.1774106533478169, 'rmse': 14441.092559870394, 'r2': 0.5213867600539204, 'raif_metric': 1.9212146293436345}
2021-09-25 06:07:38,358 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 06:07:38,360 __main__     INFO     Fit model
2021-09-25 06:07:38,360 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:09:25,894 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:09:25,906 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 06:09:25,906 __main__     INFO     Save model
2021-09-25 06:10:13,213 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5205442420373527, 'mdape': 0.3121811537017391, 'rmse': 74006.60709892404, 'r2': 0.8169354637591713, 'raif_metric': 3.492958635621374}
2021-09-25 06:10:13,225 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.10929797683354432, 'mdape': 0.07836502928075138, 'rmse': 6600.165742540432, 'r2': 0.386101721850564, 'raif_metric': 0.20108842281039258}
2021-09-25 06:10:13,552 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 06:10:13,563 __main__     INFO     Fit model
2021-09-25 06:10:13,563 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:12:01,250 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:12:01,263 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 06:12:01,263 __main__     INFO     Save model
2021-09-25 06:12:48,377 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.522129614539243, 'mdape': 0.3130275938240419, 'rmse': 74001.6513962207, 'r2': 0.8171744832021526, 'raif_metric': 3.4962442302087267}
2021-09-25 06:12:48,389 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16154065998562483, 'mdape': 0.1743207775312985, 'rmse': 14620.568451132705, 'r2': 0.9350762021605538, 'raif_metric': 0.34312978974075947}
2021-09-25 06:12:48,718 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 06:12:48,721 __main__     INFO     Fit model
2021-09-25 06:12:48,721 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:14:36,687 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:14:36,700 raif_hack.model INFO     Corr coef: -0.09
2021-09-25 06:14:36,700 __main__     INFO     Save model
2021-09-25 06:15:24,074 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204347376322669, 'mdape': 0.31272560800234306, 'rmse': 73919.90559159372, 'r2': 0.8173438168739291, 'raif_metric': 3.4948769577359737}
2021-09-25 06:15:24,086 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.283919466915312, 'mdape': 0.11610705015692538, 'rmse': 17425.108148495885, 'r2': 0.9344211322676121, 'raif_metric': 2.758498850874041}
2021-09-25 06:15:24,404 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 06:15:24,406 __main__     INFO     Fit model
2021-09-25 06:15:24,406 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:17:12,297 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:17:12,309 raif_hack.model INFO     Corr coef: -0.30
2021-09-25 06:17:12,309 __main__     INFO     Save model
2021-09-25 06:18:00,389 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5209759370312717, 'mdape': 0.3125042379425225, 'rmse': 73902.39947051644, 'r2': 0.8173784365135071, 'raif_metric': 3.493117805194198}
2021-09-25 06:18:00,401 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25320052520014513, 'mdape': 0.19525769247414732, 'rmse': 18275.292998924808, 'r2': 0.5317985625249415, 'raif_metric': 2.562869022654704}
2021-09-25 06:18:00,718 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 06:18:00,721 __main__     INFO     Fit model
2021-09-25 06:18:00,721 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:19:49,278 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:19:49,290 raif_hack.model INFO     Corr coef: -0.20
2021-09-25 06:19:49,291 __main__     INFO     Save model
2021-09-25 06:20:37,151 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213801083045548, 'mdape': 0.3125329902181031, 'rmse': 73966.98149941095, 'r2': 0.8173598895524852, 'raif_metric': 3.49380998207711}
2021-09-25 06:20:37,164 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2872829640840193, 'mdape': 0.32490992188926693, 'rmse': 88970.63828362942, 'r2': 0.5837624590033468, 'raif_metric': 2.7198380184578204}
2021-09-25 06:20:37,482 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 06:20:37,484 __main__     INFO     Fit model
2021-09-25 06:20:37,484 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:22:25,029 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:22:25,042 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 06:22:25,042 __main__     INFO     Save model
2021-09-25 06:23:12,651 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5223954113139668, 'mdape': 0.3122696570931104, 'rmse': 73922.26970305892, 'r2': 0.8175199426071253, 'raif_metric': 3.4941150479488536}
2021-09-25 06:23:12,663 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21058471715894947, 'mdape': 0.12337530683299665, 'rmse': 21313.190894775067, 'r2': 0.5114882714850921, 'raif_metric': 1.8253025618211456}
2021-09-25 06:23:12,984 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 06:23:12,986 __main__     INFO     Fit model
2021-09-25 06:23:12,986 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:25:01,294 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:25:01,306 raif_hack.model INFO     Corr coef: 0.03
2021-09-25 06:25:01,306 __main__     INFO     Save model
2021-09-25 06:25:47,974 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5202971483294203, 'mdape': 0.31246045333262445, 'rmse': 73875.76430959492, 'r2': 0.8176582842345208, 'raif_metric': 3.491168802822916}
2021-09-25 06:25:47,987 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4513372668850543, 'mdape': 0.30376434996301394, 'rmse': 79649.04195691372, 'r2': -0.08108265191806407, 'raif_metric': 3.1453843335754916}
2021-09-25 06:25:48,308 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 06:25:48,310 __main__     INFO     Fit model
2021-09-25 06:25:48,310 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:27:35,680 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:27:35,692 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 06:27:35,692 __main__     INFO     Save model
2021-09-25 06:28:22,962 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5229714058596522, 'mdape': 0.3133058581090832, 'rmse': 73983.72006915881, 'r2': 0.8172034735409605, 'raif_metric': 3.499134625757249}
2021-09-25 06:28:22,974 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.36182383879933383, 'mdape': 0.21933438901166227, 'rmse': 12133.18443856719, 'r2': 0.7888153507185844, 'raif_metric': 3.119475975148099}
2021-09-25 06:28:23,307 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 06:28:23,310 __main__     INFO     Fit model
2021-09-25 06:28:23,310 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:30:11,304 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:30:11,317 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 06:30:11,317 __main__     INFO     Save model
2021-09-25 06:30:58,477 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5233294909281627, 'mdape': 0.3125776014245256, 'rmse': 74021.09554764749, 'r2': 0.8169787401102213, 'raif_metric': 3.4959421304086153}
2021-09-25 06:30:58,489 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.242277409858245, 'mdape': 0.22915638015644668, 'rmse': 14958.98530861432, 'r2': 0.964300581208361, 'raif_metric': 1.7055988283359207}
2021-09-25 06:30:58,809 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 06:30:58,812 __main__     INFO     Fit model
2021-09-25 06:30:58,812 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:32:46,991 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:32:47,004 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 06:32:47,004 __main__     INFO     Save model
2021-09-25 06:33:34,112 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5197199636968703, 'mdape': 0.31241957604642234, 'rmse': 73842.08408373575, 'r2': 0.8177318141209704, 'raif_metric': 3.4897554380583955}
2021-09-25 06:33:34,125 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23027806713273738, 'mdape': 0.05487334377827482, 'rmse': 13352.604744001534, 'r2': 0.3085502442371145, 'raif_metric': 2.2480840863220655}
2021-09-25 06:33:34,452 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 06:33:34,454 __main__     INFO     Fit model
2021-09-25 06:33:34,454 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:35:22,505 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:35:22,517 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 06:35:22,517 __main__     INFO     Save model
2021-09-25 06:36:09,326 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208973056337782, 'mdape': 0.3126999821550586, 'rmse': 73919.82118024977, 'r2': 0.8174476120976556, 'raif_metric': 3.4956890565771817}
2021-09-25 06:36:09,338 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.29606028025256326, 'mdape': 0.31717324139577663, 'rmse': 23256.225562416254, 'r2': -1.0669322514049608, 'raif_metric': 2.988942966512022}
2021-09-25 06:36:09,666 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 06:36:09,669 __main__     INFO     Fit model
2021-09-25 06:36:09,669 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:37:58,194 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:37:58,206 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 06:37:58,206 __main__     INFO     Save model
2021-09-25 06:38:44,907 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.520779261157378, 'mdape': 0.3125937583169364, 'rmse': 73887.33344729814, 'r2': 0.8176510051616683, 'raif_metric': 3.496431735639129}
2021-09-25 06:38:44,920 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.44936504890158635, 'mdape': 0.36587851262657217, 'rmse': 23807.763713333137, 'r2': 0.22263836277515647, 'raif_metric': 4.005917280934741}
2021-09-25 06:38:45,253 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 06:38:45,255 __main__     INFO     Fit model
2021-09-25 06:38:45,255 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:40:32,661 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:40:32,675 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 06:40:32,675 __main__     INFO     Save model
2021-09-25 06:41:19,523 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52084538406165, 'mdape': 0.31315609802478256, 'rmse': 73904.58976258528, 'r2': 0.8172358737330462, 'raif_metric': 3.4967488129215902}
2021-09-25 06:41:19,537 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16210316586107515, 'mdape': 0.15572223280956135, 'rmse': 9468.135799824657, 'r2': 0.838040394223711, 'raif_metric': 0.4115885148234102}
2021-09-25 06:41:19,860 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 06:41:19,863 __main__     INFO     Fit model
2021-09-25 06:41:19,863 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:43:07,876 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:43:07,888 raif_hack.model INFO     Corr coef: 0.19
2021-09-25 06:43:07,888 __main__     INFO     Save model
2021-09-25 06:43:55,617 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211738649496578, 'mdape': 0.31269965122496296, 'rmse': 73965.52401030005, 'r2': 0.8171275899472519, 'raif_metric': 3.4962766599992157}
2021-09-25 06:43:55,629 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.32303723849604526, 'mdape': 0.3048104170880837, 'rmse': 19083.4668146885, 'r2': 0.3626262204723606, 'raif_metric': 2.269896277510809}
2021-09-25 06:43:55,952 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 06:43:55,954 __main__     INFO     Fit model
2021-09-25 06:43:55,954 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:45:43,550 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:45:43,563 raif_hack.model INFO     Corr coef: -0.31
2021-09-25 06:45:43,563 __main__     INFO     Save model
2021-09-25 06:46:31,002 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221160555318345, 'mdape': 0.31265399962919677, 'rmse': 73913.85273209952, 'r2': 0.8174660449605293, 'raif_metric': 3.497055678913918}
2021-09-25 06:46:31,014 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17107662586799055, 'mdape': 0.14063861275938389, 'rmse': 22777.990893055223, 'r2': 0.6521897472751245, 'raif_metric': 0.8454862367474293}
2021-09-25 06:46:31,336 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 06:46:31,338 __main__     INFO     Fit model
2021-09-25 06:46:31,338 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:48:19,233 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:48:19,246 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 06:48:19,246 __main__     INFO     Save model
2021-09-25 06:49:05,774 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5186310697505043, 'mdape': 0.3129334250148481, 'rmse': 73936.2117315454, 'r2': 0.8173209543653013, 'raif_metric': 3.492072824409376}
2021-09-25 06:49:05,787 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2711401776679612, 'mdape': 0.18044453122496018, 'rmse': 28023.03567359027, 'r2': 0.7397422181563487, 'raif_metric': 1.8158284227556094}
2021-09-25 06:49:06,111 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 06:49:06,114 __main__     INFO     Fit model
2021-09-25 06:49:06,114 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:50:54,405 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:50:54,418 raif_hack.model INFO     Corr coef: 0.04
2021-09-25 06:50:54,418 __main__     INFO     Save model
2021-09-25 06:51:41,813 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5203355456367078, 'mdape': 0.3128091544111353, 'rmse': 74018.8892717182, 'r2': 0.8170013463708811, 'raif_metric': 3.4982881144543874}
2021-09-25 06:51:41,826 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4144459442618073, 'mdape': 0.19724807588860427, 'rmse': 23013.088348393583, 'r2': -1.8010844910268147, 'raif_metric': 2.667112906864742}
2021-09-25 06:51:42,147 __main__     INFO     X_offer (274742, 70)  y_offer (274742,)	X_manual (3, 70) y_manual (3,)
2021-09-25 06:51:42,150 __main__     INFO     Fit model
2021-09-25 06:51:42,150 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:53:30,026 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:53:30,114 raif_hack.model INFO     Corr coef: 0.53
2021-09-25 06:53:30,114 __main__     INFO     Save model
2021-09-25 06:54:16,899 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5213931174154005, 'mdape': 0.3133155822203353, 'rmse': 73938.95183363976, 'r2': 0.8173816198782985, 'raif_metric': 3.5010893955572295}
2021-09-25 06:54:16,910 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.36430924127145703, 'mdape': 0.5264537805201225, 'rmse': 179729.2165719585, 'r2': 0.4258047405395944, 'raif_metric': 4.926119242300142}
2021-09-25 06:54:17,229 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 06:54:17,231 __main__     INFO     Fit model
2021-09-25 06:54:17,231 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:56:05,572 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:56:05,585 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 06:56:05,585 __main__     INFO     Save model
2021-09-25 06:56:52,942 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5206634084635116, 'mdape': 0.31238215156810434, 'rmse': 73877.44572996319, 'r2': 0.8175818472355255, 'raif_metric': 3.494564574242028}
2021-09-25 06:56:52,955 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.27958607917063766, 'mdape': 0.20705914964075176, 'rmse': 17702.666781647284, 'r2': -0.47032305222504456, 'raif_metric': 2.276815462428276}
2021-09-25 06:56:53,271 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 06:56:53,274 __main__     INFO     Fit model
2021-09-25 06:56:53,274 raif_hack.model INFO     Fit lightgbm
2021-09-25 06:58:40,467 raif_hack.model INFO     Find corr coefficient
2021-09-25 06:58:40,481 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 06:58:40,481 __main__     INFO     Save model
2021-09-25 06:59:26,846 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.525276052482418, 'mdape': 0.31329551181770077, 'rmse': 74035.6088203332, 'r2': 0.8169766514098413, 'raif_metric': 3.4999025830678288}
2021-09-25 06:59:26,859 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4193731435834299, 'mdape': 0.3980437838664277, 'rmse': 64937.33793279377, 'r2': 0.5581850255249756, 'raif_metric': 3.7626345515638957}
2021-09-25 06:59:27,183 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 06:59:27,186 __main__     INFO     Fit model
2021-09-25 06:59:27,186 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:01:15,037 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:01:15,049 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 07:01:15,049 __main__     INFO     Save model
2021-09-25 07:02:01,587 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5202389904682603, 'mdape': 0.3123070611214659, 'rmse': 73912.84039391804, 'r2': 0.8174894979937056, 'raif_metric': 3.4931196708711605}
2021-09-25 07:02:01,601 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3827331552273303, 'mdape': 0.4133222684665734, 'rmse': 47650.150408138164, 'r2': -0.004476447473973355, 'raif_metric': 3.4176202108224465}
2021-09-25 07:02:01,918 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 07:02:01,921 __main__     INFO     Fit model
2021-09-25 07:02:01,921 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:03:48,688 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:03:48,701 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 07:03:48,701 __main__     INFO     Save model
2021-09-25 07:04:35,953 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5200819906697838, 'mdape': 0.3126921169323392, 'rmse': 74056.77880688258, 'r2': 0.8168410903683425, 'raif_metric': 3.496944473163995}
2021-09-25 07:04:35,965 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23753246838460396, 'mdape': 0.2271194445639477, 'rmse': 21962.629199881427, 'r2': -1.5937019582714091, 'raif_metric': 1.7866019068570784}
2021-09-25 07:04:36,284 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 07:04:36,286 __main__     INFO     Fit model
2021-09-25 07:04:36,286 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:06:23,898 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:06:23,910 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 07:06:23,910 __main__     INFO     Save model
2021-09-25 07:07:10,730 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5208011068635983, 'mdape': 0.3126948662189142, 'rmse': 73943.96817541869, 'r2': 0.8173458346179918, 'raif_metric': 3.494510889878527}
2021-09-25 07:07:10,742 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.11837083141541836, 'mdape': 0.07228065539252454, 'rmse': 11732.587678054158, 'r2': 0.9928782655477739, 'raif_metric': 0.2584320068819677}
2021-09-25 07:07:11,066 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 07:07:11,069 __main__     INFO     Fit model
2021-09-25 07:07:11,069 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:08:59,788 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:08:59,800 raif_hack.model INFO     Corr coef: -0.22
2021-09-25 07:08:59,800 __main__     INFO     Save model
2021-09-25 07:09:47,473 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5195648500565089, 'mdape': 0.3124091870347469, 'rmse': 73899.1559747316, 'r2': 0.8174636456296431, 'raif_metric': 3.4912062237829007}
2021-09-25 07:09:47,485 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.5836228723190177, 'mdape': 0.18831493362229504, 'rmse': 17415.25628290313, 'r2': 0.06258429768262874, 'raif_metric': 2.3640223195692305}
2021-09-25 07:09:47,813 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 07:09:47,815 __main__     INFO     Fit model
2021-09-25 07:09:47,815 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:11:35,605 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:11:35,618 raif_hack.model INFO     Corr coef: 0.07
2021-09-25 07:11:35,618 __main__     INFO     Save model
2021-09-25 07:12:22,802 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.519321706542324, 'mdape': 0.3130156672851808, 'rmse': 73841.16855299758, 'r2': 0.8177064334443284, 'raif_metric': 3.4964539232579503}
2021-09-25 07:12:22,814 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2642768541644878, 'mdape': 0.14471423995797678, 'rmse': 18451.99830241452, 'r2': 0.41473774687825915, 'raif_metric': 1.4289757487118655}
2021-09-25 07:12:23,144 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 07:12:23,146 __main__     INFO     Fit model
2021-09-25 07:12:23,146 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:14:10,727 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:14:10,740 raif_hack.model INFO     Corr coef: -0.21
2021-09-25 07:14:10,740 __main__     INFO     Save model
2021-09-25 07:14:57,993 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5214685904211498, 'mdape': 0.31297826536866247, 'rmse': 74093.60115144351, 'r2': 0.8166867839766581, 'raif_metric': 3.4984502514215334}
2021-09-25 07:14:58,006 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.27451876590893537, 'mdape': 0.13323682356252256, 'rmse': 11946.697928067839, 'r2': 0.4448125855045637, 'raif_metric': 1.8047209776230637}
2021-09-25 07:14:58,325 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 07:14:58,327 __main__     INFO     Fit model
2021-09-25 07:14:58,328 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:16:45,706 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:16:45,718 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 07:16:45,718 __main__     INFO     Save model
2021-09-25 07:17:32,136 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5215054347374022, 'mdape': 0.31265747373980035, 'rmse': 73970.53934630145, 'r2': 0.8172166021690622, 'raif_metric': 3.496036354693294}
2021-09-25 07:17:32,148 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.336746266715863, 'mdape': 0.25571839445839545, 'rmse': 75227.87362170611, 'r2': 0.6578628130735158, 'raif_metric': 2.550088869292962}
2021-09-25 07:17:32,468 __main__     INFO     X_offer (274754, 70)  y_offer (274754,)	X_manual (15, 70) y_manual (15,)
2021-09-25 07:17:32,470 __main__     INFO     Fit model
2021-09-25 07:17:32,470 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:19:20,052 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:19:20,065 raif_hack.model INFO     Corr coef: -0.34
2021-09-25 07:19:20,065 __main__     INFO     Save model
2021-09-25 07:20:07,187 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5221853669064869, 'mdape': 0.3126566639212871, 'rmse': 73727.73541908161, 'r2': 0.818300709496788, 'raif_metric': 3.4938887156457246}
2021-09-25 07:20:07,201 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2164417666758896, 'mdape': 0.26006879173686087, 'rmse': 17692.301664582545, 'r2': 0.6229866897127498, 'raif_metric': 1.1258980493822544}
2021-09-25 07:20:07,520 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 07:20:07,522 __main__     INFO     Fit model
2021-09-25 07:20:07,522 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:21:55,234 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:21:55,247 raif_hack.model INFO     Corr coef: -0.05
2021-09-25 07:21:55,247 __main__     INFO     Save model
2021-09-25 07:22:42,617 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5226962232008263, 'mdape': 0.31310068208631514, 'rmse': 73885.95615203989, 'r2': 0.8175227105360652, 'raif_metric': 3.4961508518129336}
2021-09-25 07:22:42,629 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.20114959361036336, 'mdape': 0.16496868336243564, 'rmse': 13889.415569799587, 'r2': -0.4530392095943523, 'raif_metric': 1.2950719544314413}
2021-09-25 07:22:42,947 __main__     INFO     X_offer (274742, 70)  y_offer (274742,)	X_manual (3, 70) y_manual (3,)
2021-09-25 07:22:42,949 __main__     INFO     Fit model
2021-09-25 07:22:42,949 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:24:30,146 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:24:30,158 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 07:24:30,158 __main__     INFO     Save model
2021-09-25 07:25:17,379 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5215892437612508, 'mdape': 0.31308995936302997, 'rmse': 73964.42067538542, 'r2': 0.8172960111866748, 'raif_metric': 3.494695663364133}
2021-09-25 07:25:17,391 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.10444071445960391, 'mdape': 0.12278031173856453, 'rmse': 5888.944515012423, 'r2': 0.7916540628374917, 'raif_metric': 0.0267852462817891}
2021-09-25 07:25:17,709 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 07:25:17,712 __main__     INFO     Fit model
2021-09-25 07:25:17,712 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:27:05,731 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:27:05,745 raif_hack.model INFO     Corr coef: -0.25
2021-09-25 07:27:05,745 __main__     INFO     Save model
2021-09-25 07:27:52,532 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5212533524801914, 'mdape': 0.3131032078992898, 'rmse': 73993.0649887688, 'r2': 0.8170148028827544, 'raif_metric': 3.4984265067569855}
2021-09-25 07:27:52,545 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23527397821649376, 'mdape': 0.0494722067806492, 'rmse': 35954.20866305424, 'r2': 0.2967250698102193, 'raif_metric': 2.7551685128876775}
2021-09-25 07:27:52,870 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 07:27:52,872 __main__     INFO     Fit model
2021-09-25 07:27:52,872 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:29:40,577 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:29:40,591 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 07:29:40,591 __main__     INFO     Save model
2021-09-25 07:30:28,478 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5247168089257954, 'mdape': 0.3123975489787872, 'rmse': 73947.51975782147, 'r2': 0.8172304794120022, 'raif_metric': 3.495238539760979}
2021-09-25 07:30:28,491 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2787622568505563, 'mdape': 0.2351745526316736, 'rmse': 25371.799786331696, 'r2': -0.23976340500438642, 'raif_metric': 1.4492572813247726}
2021-09-25 07:30:28,812 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 07:30:28,815 __main__     INFO     Fit model
2021-09-25 07:30:28,815 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:32:16,341 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:32:16,353 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 07:32:16,354 __main__     INFO     Save model
2021-09-25 07:33:03,454 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5225856356616347, 'mdape': 0.3130570034548441, 'rmse': 74070.3116122287, 'r2': 0.816785898431714, 'raif_metric': 3.4982073234364246}
2021-09-25 07:33:03,466 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25876231898862107, 'mdape': 0.15936657805803756, 'rmse': 26032.99682662043, 'r2': 0.9467014944590304, 'raif_metric': 1.2985866044041292}
2021-09-25 07:33:03,788 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 07:33:03,800 __main__     INFO     Fit model
2021-09-25 07:33:03,800 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:34:52,577 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:34:52,590 raif_hack.model INFO     Corr coef: -0.30
2021-09-25 07:34:52,590 __main__     INFO     Save model
2021-09-25 07:35:39,621 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5227049947478626, 'mdape': 0.3126618849988283, 'rmse': 74032.6005343984, 'r2': 0.8167877402612644, 'raif_metric': 3.4958883845255513}
2021-09-25 07:35:39,633 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2748506281107944, 'mdape': 0.2614109675552971, 'rmse': 27695.30325511923, 'r2': 0.29816335936146654, 'raif_metric': 2.1440273821020344}
2021-09-25 07:35:39,954 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 07:35:39,957 __main__     INFO     Fit model
2021-09-25 07:35:39,957 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:37:27,528 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:37:27,541 raif_hack.model INFO     Corr coef: -0.24
2021-09-25 07:37:27,541 __main__     INFO     Save model
2021-09-25 07:38:15,917 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222250449066483, 'mdape': 0.3134535720415286, 'rmse': 74010.33312225163, 'r2': 0.8170514575712531, 'raif_metric': 3.496128561154202}
2021-09-25 07:38:15,930 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.09876967020343828, 'mdape': 0.06995991134064317, 'rmse': 14421.341545487005, 'r2': 0.8598133698693526, 'raif_metric': 0.07357505771173412}
2021-09-25 07:38:16,251 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 07:38:16,253 __main__     INFO     Fit model
2021-09-25 07:38:16,253 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:40:03,922 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:40:03,935 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 07:40:03,935 __main__     INFO     Save model
2021-09-25 07:40:51,736 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5216023676889834, 'mdape': 0.3130087910236659, 'rmse': 74042.84365295479, 'r2': 0.816827028574825, 'raif_metric': 3.4973299182756477}
2021-09-25 07:40:51,749 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2487049292825741, 'mdape': 0.1190521323689761, 'rmse': 50777.970680114515, 'r2': -0.7049015846675035, 'raif_metric': 1.7255287465436375}
2021-09-25 07:40:52,070 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 07:40:52,072 __main__     INFO     Fit model
2021-09-25 07:40:52,072 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:42:39,570 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:42:39,583 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 07:42:39,583 __main__     INFO     Save model
2021-09-25 07:43:26,353 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5248403744324885, 'mdape': 0.31309758759654527, 'rmse': 73960.36590886781, 'r2': 0.8172651011663479, 'raif_metric': 3.4995517626120525}
2021-09-25 07:43:26,366 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2941333890798008, 'mdape': 0.21525157475273451, 'rmse': 35387.10754782254, 'r2': 0.10446916044529653, 'raif_metric': 1.5849570222456462}
2021-09-25 07:43:26,687 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 07:43:26,689 __main__     INFO     Fit model
2021-09-25 07:43:26,689 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:45:13,943 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:45:13,955 raif_hack.model INFO     Corr coef: 0.03
2021-09-25 07:45:13,955 __main__     INFO     Save model
2021-09-25 07:46:00,778 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.521683821972501, 'mdape': 0.31316983820472116, 'rmse': 74040.22214525628, 'r2': 0.8169035569083276, 'raif_metric': 3.4982716732996177}
2021-09-25 07:46:00,790 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3230318010958079, 'mdape': 0.2898447829018585, 'rmse': 30015.46288710867, 'r2': 0.708319453168593, 'raif_metric': 2.221193628731552}
2021-09-25 07:46:01,094 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 07:46:01,097 __main__     INFO     Fit model
2021-09-25 07:46:01,097 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:47:49,203 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:47:49,215 raif_hack.model INFO     Corr coef: -0.43
2021-09-25 07:47:49,215 __main__     INFO     Save model
2021-09-25 07:48:36,509 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5233447051551823, 'mdape': 0.31336900190413497, 'rmse': 73942.59445726556, 'r2': 0.8172891847965663, 'raif_metric': 3.4973101312401007}
2021-09-25 07:48:36,522 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2714981679041509, 'mdape': 0.26788756296418553, 'rmse': 16252.04225487589, 'r2': 0.6201598707141094, 'raif_metric': 1.514656333885575}
2021-09-25 07:48:36,824 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 07:48:36,826 __main__     INFO     Fit model
2021-09-25 07:48:36,826 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:50:24,777 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:50:24,791 raif_hack.model INFO     Corr coef: 0.01
2021-09-25 07:50:24,791 __main__     INFO     Save model
2021-09-25 07:51:12,249 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5198078789312282, 'mdape': 0.3127173434755949, 'rmse': 73878.92988513997, 'r2': 0.8175886782943458, 'raif_metric': 3.496347528381239}
2021-09-25 07:51:12,262 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.48162763915983736, 'mdape': 0.4487880501243988, 'rmse': 267522.67874714214, 'r2': -0.0033034849506814457, 'raif_metric': 4.52364828388197}
2021-09-25 07:51:12,565 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 07:51:12,567 __main__     INFO     Fit model
2021-09-25 07:51:12,568 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:53:00,503 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:53:00,515 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 07:53:00,515 __main__     INFO     Save model
2021-09-25 07:53:47,912 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5205661347050887, 'mdape': 0.3127121634092356, 'rmse': 73953.21819420795, 'r2': 0.8173196331928411, 'raif_metric': 3.4932938107032765}
2021-09-25 07:53:47,924 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24491611254962647, 'mdape': 0.12059077757476698, 'rmse': 105855.52643528295, 'r2': 0.20285104422753253, 'raif_metric': 2.1878046030731433}
2021-09-25 07:53:48,229 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 07:53:48,232 __main__     INFO     Fit model
2021-09-25 07:53:48,232 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:55:35,575 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:55:35,587 raif_hack.model INFO     Corr coef: -0.29
2021-09-25 07:55:35,587 __main__     INFO     Save model
2021-09-25 07:56:22,390 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211172823200705, 'mdape': 0.312631201537097, 'rmse': 73908.29434514776, 'r2': 0.8173901657293607, 'raif_metric': 3.496434139980591}
2021-09-25 07:56:22,402 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25140350600138633, 'mdape': 0.2657312245122278, 'rmse': 17982.86704666761, 'r2': 0.47677872823629996, 'raif_metric': 1.4907132728004042}
2021-09-25 07:56:22,718 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 07:56:22,721 __main__     INFO     Fit model
2021-09-25 07:56:22,721 raif_hack.model INFO     Fit lightgbm
2021-09-25 07:58:10,714 raif_hack.model INFO     Find corr coefficient
2021-09-25 07:58:10,727 raif_hack.model INFO     Corr coef: -0.06
2021-09-25 07:58:10,727 __main__     INFO     Save model
2021-09-25 07:58:57,894 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5199939997919112, 'mdape': 0.31257936195520575, 'rmse': 73984.01115645007, 'r2': 0.8169764964420774, 'raif_metric': 3.495920616274504}
2021-09-25 07:58:57,908 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3051844103880879, 'mdape': 0.2950276395476962, 'rmse': 27085.24798486755, 'r2': 0.1654224800677504, 'raif_metric': 1.8898365450505423}
2021-09-25 07:58:58,223 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 07:58:58,226 __main__     INFO     Fit model
2021-09-25 07:58:58,226 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:00:45,978 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:00:45,991 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 08:00:45,991 __main__     INFO     Save model
2021-09-25 08:01:32,824 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5242416804897723, 'mdape': 0.31351650187182095, 'rmse': 74039.64606627177, 'r2': 0.8168064546128653, 'raif_metric': 3.5017207371054675}
2021-09-25 08:01:32,837 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.275526988987849, 'mdape': 0.10917399899938818, 'rmse': 38469.077162927235, 'r2': 0.2616497167920804, 'raif_metric': 3.290833611704855}
2021-09-25 08:01:33,156 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:01:33,159 __main__     INFO     Fit model
2021-09-25 08:01:33,159 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:03:20,901 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:03:20,913 raif_hack.model INFO     Corr coef: 0.07
2021-09-25 08:03:20,913 __main__     INFO     Save model
2021-09-25 08:04:08,308 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.525772096999255, 'mdape': 0.3130762480725233, 'rmse': 73947.09397577657, 'r2': 0.8172704659781879, 'raif_metric': 3.4993603859756512}
2021-09-25 08:04:08,321 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2583241816080029, 'mdape': 0.2549921926852535, 'rmse': 116369.43451394068, 'r2': 0.6204019318297604, 'raif_metric': 1.1934640608708578}
2021-09-25 08:04:08,638 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 08:04:08,640 __main__     INFO     Fit model
2021-09-25 08:04:08,640 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:05:56,955 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:05:56,968 raif_hack.model INFO     Corr coef: -0.08
2021-09-25 08:05:56,968 __main__     INFO     Save model
2021-09-25 08:06:44,774 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.51913244660361, 'mdape': 0.3125845941843143, 'rmse': 73932.62725089307, 'r2': 0.8173207391322909, 'raif_metric': 3.4928941889116265}
2021-09-25 08:06:44,787 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22865679599193925, 'mdape': 0.22159269825633368, 'rmse': 20354.155117982562, 'r2': 0.8149727753935232, 'raif_metric': 0.8207124756447759}
2021-09-25 08:06:45,104 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 08:06:45,107 __main__     INFO     Fit model
2021-09-25 08:06:45,107 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:08:32,326 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:08:32,339 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 08:08:32,339 __main__     INFO     Save model
2021-09-25 08:09:19,594 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5220134163365977, 'mdape': 0.3129301834949901, 'rmse': 74081.26875098115, 'r2': 0.8167495920502855, 'raif_metric': 3.4972826904864696}
2021-09-25 08:09:19,606 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30259871136066313, 'mdape': 0.2828392328471868, 'rmse': 17932.126301150376, 'r2': 0.27992087948979916, 'raif_metric': 1.9099135090698904}
2021-09-25 08:09:19,922 __main__     INFO     X_offer (274757, 70)  y_offer (274757,)	X_manual (18, 70) y_manual (18,)
2021-09-25 08:09:19,924 __main__     INFO     Fit model
2021-09-25 08:09:19,924 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:11:07,579 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:11:07,594 raif_hack.model INFO     Corr coef: -0.16
2021-09-25 08:11:07,594 __main__     INFO     Save model
2021-09-25 08:11:54,462 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5218605111151835, 'mdape': 0.31319693131963816, 'rmse': 73866.02676758246, 'r2': 0.8177090046698208, 'raif_metric': 3.4989625054900833}
2021-09-25 08:11:54,476 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.24597903241173627, 'mdape': 0.270360185044286, 'rmse': 13047.813691592786, 'r2': -0.21313961094910994, 'raif_metric': 1.3882364842923713}
2021-09-25 08:11:54,794 __main__     INFO     X_offer (274750, 70)  y_offer (274750,)	X_manual (11, 70) y_manual (11,)
2021-09-25 08:11:54,796 __main__     INFO     Fit model
2021-09-25 08:11:54,796 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:13:42,317 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:13:42,330 raif_hack.model INFO     Corr coef: -0.03
2021-09-25 08:13:42,330 __main__     INFO     Save model
2021-09-25 08:14:30,251 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5228864832650755, 'mdape': 0.3128479096833392, 'rmse': 74007.90317627366, 'r2': 0.8169722200468442, 'raif_metric': 3.4971659656204768}
2021-09-25 08:14:30,264 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28260109532313443, 'mdape': 0.23511746839261105, 'rmse': 18294.006988172117, 'r2': 0.3351065533548767, 'raif_metric': 2.025942076162177}
2021-09-25 08:14:30,582 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 08:14:30,584 __main__     INFO     Fit model
2021-09-25 08:14:30,584 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:16:18,515 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:16:18,528 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 08:16:18,528 __main__     INFO     Save model
2021-09-25 08:17:05,961 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5206181013571936, 'mdape': 0.31254376002112655, 'rmse': 74026.12677479365, 'r2': 0.8169311556532737, 'raif_metric': 3.4951880397248822}
2021-09-25 08:17:05,973 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17757972843049513, 'mdape': 0.19251841136362247, 'rmse': 14021.491285841465, 'r2': 0.5213261141764636, 'raif_metric': 0.5508179387613112}
2021-09-25 08:17:06,296 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 08:17:06,298 __main__     INFO     Fit model
2021-09-25 08:17:06,298 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:18:53,605 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:18:53,617 raif_hack.model INFO     Corr coef: 0.12
2021-09-25 08:18:53,617 __main__     INFO     Save model
2021-09-25 08:19:39,560 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232575293011632, 'mdape': 0.3128540482967133, 'rmse': 73914.05372262659, 'r2': 0.8174443331314017, 'raif_metric': 3.4976602391281917}
2021-09-25 08:19:39,572 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22370360088874305, 'mdape': 0.10983013711579873, 'rmse': 21399.897251066766, 'r2': 0.7584910320936239, 'raif_metric': 1.3116956324812203}
2021-09-25 08:19:39,893 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 08:19:39,896 __main__     INFO     Fit model
2021-09-25 08:19:39,896 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:21:27,389 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:21:27,403 raif_hack.model INFO     Corr coef: 0.16
2021-09-25 08:21:27,403 __main__     INFO     Save model
2021-09-25 08:22:14,097 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52128058206736, 'mdape': 0.31251554231132384, 'rmse': 74037.39364770272, 'r2': 0.8167698109791296, 'raif_metric': 3.4973689328081705}
2021-09-25 08:22:14,111 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.36493069763265507, 'mdape': 0.18721217485396582, 'rmse': 40749.75266847058, 'r2': 0.679594823108522, 'raif_metric': 2.702038606997142}
2021-09-25 08:22:14,425 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:22:14,428 __main__     INFO     Fit model
2021-09-25 08:22:14,428 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:24:02,477 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:24:02,490 raif_hack.model INFO     Corr coef: -0.30
2021-09-25 08:24:02,490 __main__     INFO     Save model
2021-09-25 08:24:49,989 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5197490583621873, 'mdape': 0.3129433791158587, 'rmse': 74062.30669606001, 'r2': 0.816766522957978, 'raif_metric': 3.4980872535670366}
2021-09-25 08:24:50,002 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.25856949567288845, 'mdape': 0.22447598327249016, 'rmse': 14426.799034601287, 'r2': -0.8928474849290962, 'raif_metric': 1.910115026222302}
2021-09-25 08:24:50,320 __main__     INFO     X_offer (274752, 70)  y_offer (274752,)	X_manual (13, 70) y_manual (13,)
2021-09-25 08:24:50,323 __main__     INFO     Fit model
2021-09-25 08:24:50,323 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:26:37,542 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:26:37,555 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 08:26:37,555 __main__     INFO     Save model
2021-09-25 08:27:25,248 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5217754931443215, 'mdape': 0.3128868360647312, 'rmse': 73968.15337004143, 'r2': 0.8171566001285293, 'raif_metric': 3.4949066460841025}
2021-09-25 08:27:25,262 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2770681292805264, 'mdape': 0.26839150997420047, 'rmse': 18737.306282147547, 'r2': 0.20697574103758132, 'raif_metric': 1.7564374808238488}
2021-09-25 08:27:25,579 __main__     INFO     X_offer (274747, 70)  y_offer (274747,)	X_manual (8, 70) y_manual (8,)
2021-09-25 08:27:25,581 __main__     INFO     Fit model
2021-09-25 08:27:25,581 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:29:13,561 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:29:13,573 raif_hack.model INFO     Corr coef: -0.05
2021-09-25 08:29:13,573 __main__     INFO     Save model
2021-09-25 08:30:00,547 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5191425780442815, 'mdape': 0.3125025999832737, 'rmse': 73798.58577611548, 'r2': 0.8179830919319142, 'raif_metric': 3.491876171821146}
2021-09-25 08:30:00,559 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2146401858755697, 'mdape': 0.15803263886841679, 'rmse': 21887.997394911257, 'r2': -0.16098091841552797, 'raif_metric': 1.750219615203559}
2021-09-25 08:30:00,890 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:30:00,893 __main__     INFO     Fit model
2021-09-25 08:30:00,893 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:31:48,767 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:31:48,780 raif_hack.model INFO     Corr coef: -0.04
2021-09-25 08:31:48,780 __main__     INFO     Save model
2021-09-25 08:32:36,361 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5187454363565438, 'mdape': 0.312804735465765, 'rmse': 74029.98159089305, 'r2': 0.8169102615703352, 'raif_metric': 3.494389613966886}
2021-09-25 08:32:36,374 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3232756963859342, 'mdape': 0.318492282964206, 'rmse': 23999.500898494625, 'r2': 0.3038197790984063, 'raif_metric': 2.622063458125124}
2021-09-25 08:32:36,698 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 08:32:36,701 __main__     INFO     Fit model
2021-09-25 08:32:36,701 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:34:25,299 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:34:25,311 raif_hack.model INFO     Corr coef: -0.31
2021-09-25 08:34:25,311 __main__     INFO     Save model
2021-09-25 08:35:13,309 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5172591374847015, 'mdape': 0.3123830984565744, 'rmse': 73811.08664319899, 'r2': 0.8179868146537186, 'raif_metric': 3.489469613911596}
2021-09-25 08:35:13,321 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16425184545974986, 'mdape': 0.1316541015867979, 'rmse': 11373.708967291806, 'r2': 0.7802278714446584, 'raif_metric': 1.0823847330024396}
2021-09-25 08:35:13,639 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:35:13,642 __main__     INFO     Fit model
2021-09-25 08:35:13,642 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:37:01,818 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:37:01,831 raif_hack.model INFO     Corr coef: -0.26
2021-09-25 08:37:01,831 __main__     INFO     Save model
2021-09-25 08:37:48,857 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5211081526546155, 'mdape': 0.3128548548673269, 'rmse': 74044.3341243296, 'r2': 0.816560350499864, 'raif_metric': 3.4984101023727954}
2021-09-25 08:37:48,870 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2802551661467641, 'mdape': 0.29880120741114774, 'rmse': 14819.51528271607, 'r2': 0.8178876964740238, 'raif_metric': 1.847889466294922}
2021-09-25 08:37:49,186 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 08:37:49,188 __main__     INFO     Fit model
2021-09-25 08:37:49,189 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:39:36,929 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:39:36,941 raif_hack.model INFO     Corr coef: -0.07
2021-09-25 08:39:36,941 __main__     INFO     Save model
2021-09-25 08:40:24,799 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5217568867148568, 'mdape': 0.31248987217847346, 'rmse': 73881.84611719886, 'r2': 0.817740030872932, 'raif_metric': 3.4954997200231395}
2021-09-25 08:40:24,811 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17047134663757443, 'mdape': 0.15546485699100623, 'rmse': 13948.480621234356, 'r2': 0.9589087080488217, 'raif_metric': 0.7275707806923867}
2021-09-25 08:40:25,130 __main__     INFO     X_offer (274748, 70)  y_offer (274748,)	X_manual (9, 70) y_manual (9,)
2021-09-25 08:40:25,132 __main__     INFO     Fit model
2021-09-25 08:40:25,132 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:42:12,544 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:42:12,557 raif_hack.model INFO     Corr coef: -0.20
2021-09-25 08:42:12,557 __main__     INFO     Save model
2021-09-25 08:42:59,035 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5219592170139142, 'mdape': 0.3131480787510269, 'rmse': 74050.04408857995, 'r2': 0.8167063967390965, 'raif_metric': 3.497512647555794}
2021-09-25 08:42:59,048 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.4084598864975042, 'mdape': 0.22551244269923734, 'rmse': 21375.879818873123, 'r2': 0.3174597894564051, 'raif_metric': 2.790034575092743}
2021-09-25 08:42:59,366 __main__     INFO     X_offer (274751, 70)  y_offer (274751,)	X_manual (12, 70) y_manual (12,)
2021-09-25 08:42:59,368 __main__     INFO     Fit model
2021-09-25 08:42:59,368 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:44:47,014 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:44:47,027 raif_hack.model INFO     Corr coef: -0.30
2021-09-25 08:44:47,027 __main__     INFO     Save model
2021-09-25 08:45:34,134 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5201764681957284, 'mdape': 0.3129541223579079, 'rmse': 74024.5799509477, 'r2': 0.8168803492561076, 'raif_metric': 3.4978466284228484}
2021-09-25 08:45:34,148 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1756429358815181, 'mdape': 0.07763720614526294, 'rmse': 13752.150492091208, 'r2': 0.938663834338256, 'raif_metric': 1.2099750125930864}
2021-09-25 08:45:34,469 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 08:45:34,471 __main__     INFO     Fit model
2021-09-25 08:45:34,471 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:47:21,713 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:47:21,725 raif_hack.model INFO     Corr coef: -0.19
2021-09-25 08:47:21,725 __main__     INFO     Save model
2021-09-25 08:48:08,562 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5207682121568522, 'mdape': 0.3127983687589643, 'rmse': 73929.07666476937, 'r2': 0.817317574663927, 'raif_metric': 3.4949293367714778}
2021-09-25 08:48:08,574 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.17559754745503695, 'mdape': 0.1370050373661561, 'rmse': 12932.16752806908, 'r2': -0.33582093523333234, 'raif_metric': 1.1008502878544177}
2021-09-25 08:48:08,889 __main__     INFO     X_offer (274745, 70)  y_offer (274745,)	X_manual (6, 70) y_manual (6,)
2021-09-25 08:48:08,892 __main__     INFO     Fit model
2021-09-25 08:48:08,892 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:49:56,280 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:49:56,293 raif_hack.model INFO     Corr coef: -0.29
2021-09-25 08:49:56,293 __main__     INFO     Save model
2021-09-25 08:50:43,789 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5232599727178597, 'mdape': 0.312653368381212, 'rmse': 73972.21189897662, 'r2': 0.8171098571330704, 'raif_metric': 3.4947062273731486}
2021-09-25 08:50:43,802 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.16504992631145238, 'mdape': 0.14055450918710494, 'rmse': 14221.713646534472, 'r2': 0.7605762229413111, 'raif_metric': 0.618586060213986}
2021-09-25 08:50:44,120 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 08:50:44,122 __main__     INFO     Fit model
2021-09-25 08:50:44,122 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:52:31,831 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:52:31,843 raif_hack.model INFO     Corr coef: -0.29
2021-09-25 08:52:31,843 __main__     INFO     Save model
2021-09-25 08:53:19,346 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52247151040344, 'mdape': 0.3128544290501822, 'rmse': 73975.77645619398, 'r2': 0.8171193091539729, 'raif_metric': 3.497191159908258}
2021-09-25 08:53:19,358 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2843427965099747, 'mdape': 0.2432237465067945, 'rmse': 21830.424053374063, 'r2': -0.20617846844201004, 'raif_metric': 2.0888854617248933}
2021-09-25 08:53:19,679 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:53:19,682 __main__     INFO     Fit model
2021-09-25 08:53:19,682 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:55:07,422 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:55:07,435 raif_hack.model INFO     Corr coef: 0.02
2021-09-25 08:55:07,435 __main__     INFO     Save model
2021-09-25 08:55:54,814 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5223374218619556, 'mdape': 0.3127873411375579, 'rmse': 73904.14554884388, 'r2': 0.8174582425526036, 'raif_metric': 3.496012951668902}
2021-09-25 08:55:54,827 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30835176625515937, 'mdape': 0.31708943608877505, 'rmse': 20366.04125847433, 'r2': 0.7851308337194479, 'raif_metric': 3.213614483218021}
2021-09-25 08:55:55,149 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 08:55:55,151 __main__     INFO     Fit model
2021-09-25 08:55:55,151 raif_hack.model INFO     Fit lightgbm
2021-09-25 08:57:43,004 raif_hack.model INFO     Find corr coefficient
2021-09-25 08:57:43,017 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 08:57:43,017 __main__     INFO     Save model
2021-09-25 08:58:30,205 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5233011428510694, 'mdape': 0.31285246391608007, 'rmse': 73970.81936416494, 'r2': 0.8172352876384512, 'raif_metric': 3.4966374334746075}
2021-09-25 08:58:30,218 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.1761999762688909, 'mdape': 0.16044410838107753, 'rmse': 12116.816936713605, 'r2': 0.6149103792821223, 'raif_metric': 0.3923738744113114}
2021-09-25 08:58:30,534 __main__     INFO     X_offer (274742, 70)  y_offer (274742,)	X_manual (3, 70) y_manual (3,)
2021-09-25 08:58:30,536 __main__     INFO     Fit model
2021-09-25 08:58:30,536 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:00:17,752 raif_hack.model INFO     Find corr coefficient
2021-09-25 09:00:17,764 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 09:00:17,764 __main__     INFO     Save model
2021-09-25 09:01:04,385 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5222491094360173, 'mdape': 0.31268230999886304, 'rmse': 74006.99976673306, 'r2': 0.8169808012561062, 'raif_metric': 3.4981754204726356}
2021-09-25 09:01:04,396 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.06659830250002807, 'mdape': 0.07851386238767666, 'rmse': 3506.2195526796154, 'r2': 0.8651354693912718, 'raif_metric': 0.0}
2021-09-25 09:01:04,712 __main__     INFO     X_offer (274744, 70)  y_offer (274744,)	X_manual (5, 70) y_manual (5,)
2021-09-25 09:01:04,715 __main__     INFO     Fit model
2021-09-25 09:01:04,715 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:02:52,703 raif_hack.model INFO     Find corr coefficient
2021-09-25 09:02:52,715 raif_hack.model INFO     Corr coef: -0.23
2021-09-25 09:02:52,716 __main__     INFO     Save model
2021-09-25 09:03:39,998 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.523599939855013, 'mdape': 0.31322795109025625, 'rmse': 74040.67310779558, 'r2': 0.8166145258038564, 'raif_metric': 3.4993274902577878}
2021-09-25 09:03:40,010 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2615509322976152, 'mdape': 0.22195689102031502, 'rmse': 51312.19478651628, 'r2': 0.17326933701518765, 'raif_metric': 2.4612303428308513}
2021-09-25 09:03:40,331 __main__     INFO     X_offer (274749, 70)  y_offer (274749,)	X_manual (10, 70) y_manual (10,)
2021-09-25 09:03:40,333 __main__     INFO     Fit model
2021-09-25 09:03:40,333 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:05:27,926 raif_hack.model INFO     Find corr coefficient
2021-09-25 09:05:27,938 raif_hack.model INFO     Corr coef: -0.02
2021-09-25 09:05:27,939 __main__     INFO     Save model
2021-09-25 09:06:16,675 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52176627090876, 'mdape': 0.3130473928518706, 'rmse': 74029.22416200371, 'r2': 0.8168676212633033, 'raif_metric': 3.4979031904404425}
2021-09-25 09:06:16,688 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28352822801817307, 'mdape': 0.2782521582533102, 'rmse': 20914.39699763374, 'r2': -0.16175271892311116, 'raif_metric': 2.115131271804615}
2021-09-25 09:06:17,003 __main__     INFO     X_offer (274746, 70)  y_offer (274746,)	X_manual (7, 70) y_manual (7,)
2021-09-25 09:06:17,005 __main__     INFO     Fit model
2021-09-25 09:06:17,005 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:08:05,593 raif_hack.model INFO     Find corr coefficient
2021-09-25 09:08:05,606 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 09:08:05,606 __main__     INFO     Save model
2021-09-25 09:08:56,340 __main__     INFO     START predict.py
2021-09-25 09:08:56,340 __main__     INFO     Load test df
2021-09-25 09:08:56,375 __main__     INFO     Input shape: (2974, 76)
2021-09-25 09:08:56,378 __main__     INFO     Load model
2021-09-25 09:08:56,423 __main__     INFO     Predict
2021-09-25 09:08:56,528 __main__     INFO     Predict
2021-09-25 09:08:56,626 __main__     INFO     Predict
2021-09-25 09:08:56,725 __main__     INFO     Predict
2021-09-25 09:08:56,822 __main__     INFO     Predict
2021-09-25 09:08:56,918 __main__     INFO     Predict
2021-09-25 09:08:57,017 __main__     INFO     Predict
2021-09-25 09:08:57,116 __main__     INFO     Predict
2021-09-25 09:08:57,214 __main__     INFO     Predict
2021-09-25 09:08:57,311 __main__     INFO     Predict
2021-09-25 09:08:57,443 __main__     INFO     Predict
2021-09-25 09:08:57,566 __main__     INFO     Predict
2021-09-25 09:08:57,663 __main__     INFO     Predict
2021-09-25 09:08:57,758 __main__     INFO     Predict
2021-09-25 09:08:57,863 __main__     INFO     Predict
2021-09-25 09:08:57,974 __main__     INFO     Predict
2021-09-25 09:08:58,087 __main__     INFO     Predict
2021-09-25 09:08:58,214 __main__     INFO     Predict
2021-09-25 09:08:58,325 __main__     INFO     Predict
2021-09-25 09:08:58,438 __main__     INFO     Predict
2021-09-25 09:08:58,551 __main__     INFO     Predict
2021-09-25 09:08:58,655 __main__     INFO     Predict
2021-09-25 09:08:58,758 __main__     INFO     Predict
2021-09-25 09:08:58,859 __main__     INFO     Predict
2021-09-25 09:08:58,960 __main__     INFO     Predict
2021-09-25 09:08:59,063 __main__     INFO     Predict
2021-09-25 09:08:59,162 __main__     INFO     Predict
2021-09-25 09:08:59,271 __main__     INFO     Predict
2021-09-25 09:08:59,376 __main__     INFO     Predict
2021-09-25 09:08:59,481 __main__     INFO     Predict
2021-09-25 09:08:59,592 __main__     INFO     Predict
2021-09-25 09:08:59,721 __main__     INFO     Predict
2021-09-25 09:08:59,825 __main__     INFO     Predict
2021-09-25 09:08:59,927 __main__     INFO     Predict
2021-09-25 09:09:00,033 __main__     INFO     Predict
2021-09-25 09:09:00,142 __main__     INFO     Predict
2021-09-25 09:09:00,240 __main__     INFO     Predict
2021-09-25 09:09:00,329 __main__     INFO     Predict
2021-09-25 09:09:00,421 __main__     INFO     Predict
2021-09-25 09:09:00,515 __main__     INFO     Predict
2021-09-25 09:09:00,610 __main__     INFO     Predict
2021-09-25 09:09:00,701 __main__     INFO     Predict
2021-09-25 09:09:00,790 __main__     INFO     Predict
2021-09-25 09:09:00,882 __main__     INFO     Predict
2021-09-25 09:09:00,976 __main__     INFO     Predict
2021-09-25 09:09:01,068 __main__     INFO     Predict
2021-09-25 09:09:01,159 __main__     INFO     Predict
2021-09-25 09:09:01,248 __main__     INFO     Predict
2021-09-25 09:09:01,348 __main__     INFO     Predict
2021-09-25 09:09:01,437 __main__     INFO     Predict
2021-09-25 09:09:01,527 __main__     INFO     Predict
2021-09-25 09:09:01,616 __main__     INFO     Predict
2021-09-25 09:09:01,704 __main__     INFO     Predict
2021-09-25 09:09:01,826 __main__     INFO     Predict
2021-09-25 09:09:01,944 __main__     INFO     Predict
2021-09-25 09:09:02,037 __main__     INFO     Predict
2021-09-25 09:09:02,127 __main__     INFO     Predict
2021-09-25 09:09:02,218 __main__     INFO     Predict
2021-09-25 09:09:02,312 __main__     INFO     Predict
2021-09-25 09:09:02,399 __main__     INFO     Predict
2021-09-25 09:09:02,494 __main__     INFO     Predict
2021-09-25 09:09:02,592 __main__     INFO     Predict
2021-09-25 09:09:02,683 __main__     INFO     Predict
2021-09-25 09:09:02,771 __main__     INFO     Predict
2021-09-25 09:09:02,859 __main__     INFO     Predict
2021-09-25 09:09:02,948 __main__     INFO     Predict
2021-09-25 09:09:03,041 __main__     INFO     Predict
2021-09-25 09:09:03,131 __main__     INFO     Predict
2021-09-25 09:09:03,220 __main__     INFO     Predict
2021-09-25 09:09:03,309 __main__     INFO     Predict
2021-09-25 09:09:03,399 __main__     INFO     Predict
2021-09-25 09:09:03,486 __main__     INFO     Predict
2021-09-25 09:09:03,577 __main__     INFO     Predict
2021-09-25 09:09:03,666 __main__     INFO     Predict
2021-09-25 09:09:03,754 __main__     INFO     Predict
2021-09-25 09:09:03,845 __main__     INFO     Predict
2021-09-25 09:09:03,941 __main__     INFO     Predict
2021-09-25 09:09:04,050 __main__     INFO     Predict
2021-09-25 09:09:04,141 __main__     INFO     Predict
2021-09-25 09:09:04,230 __main__     INFO     Predict
2021-09-25 09:09:04,320 __main__     INFO     Predict
2021-09-25 09:09:04,410 __main__     INFO     Predict
2021-09-25 09:09:04,499 __main__     INFO     Predict
2021-09-25 09:09:04,590 __main__     INFO     Predict
2021-09-25 09:09:04,680 __main__     INFO     Predict
2021-09-25 09:09:04,767 __main__     INFO     Predict
2021-09-25 09:09:04,855 __main__     INFO     Predict
2021-09-25 09:09:04,943 __main__     INFO     Predict
2021-09-25 09:09:05,033 __main__     INFO     Predict
2021-09-25 09:09:05,126 __main__     INFO     Predict
2021-09-25 09:09:05,217 __main__     INFO     Predict
2021-09-25 09:09:05,306 __main__     INFO     Predict
2021-09-25 09:09:05,407 __main__     INFO     Predict
2021-09-25 09:09:05,495 __main__     INFO     Predict
2021-09-25 09:09:05,583 __main__     INFO     Predict
2021-09-25 09:09:05,674 __main__     INFO     Predict
2021-09-25 09:09:05,765 __main__     INFO     Predict
2021-09-25 09:09:05,854 __main__     INFO     Predict
2021-09-25 09:09:05,947 __main__     INFO     Predict
2021-09-25 09:09:06,035 __main__     INFO     Predict
2021-09-25 09:09:06,128 __main__     INFO     Predict
2021-09-25 09:09:06,250 __main__     INFO     Predict
2021-09-25 09:09:06,342 __main__     INFO     Predict
2021-09-25 09:09:06,433 __main__     INFO     Predict
2021-09-25 09:09:06,522 __main__     INFO     Predict
2021-09-25 09:09:06,612 __main__     INFO     Predict
2021-09-25 09:09:06,703 __main__     INFO     Predict
2021-09-25 09:09:06,793 __main__     INFO     Predict
2021-09-25 09:09:06,882 __main__     INFO     Predict
2021-09-25 09:09:06,970 __main__     INFO     Predict
2021-09-25 09:09:07,061 __main__     INFO     Predict
2021-09-25 09:09:07,150 __main__     INFO     Predict
2021-09-25 09:09:07,239 __main__     INFO     Predict
2021-09-25 09:09:07,330 __main__     INFO     Predict
2021-09-25 09:09:07,419 __main__     INFO     Predict
2021-09-25 09:09:07,508 __main__     INFO     Predict
2021-09-25 09:09:07,600 __main__     INFO     Predict
2021-09-25 09:09:07,691 __main__     INFO     Predict
2021-09-25 09:09:07,780 __main__     INFO     Predict
2021-09-25 09:09:07,868 __main__     INFO     Predict
2021-09-25 09:09:07,959 __main__     INFO     Predict
2021-09-25 09:09:08,050 __main__     INFO     Predict
2021-09-25 09:09:08,142 __main__     INFO     Predict
2021-09-25 09:09:08,263 __main__     INFO     Predict
2021-09-25 09:09:08,384 __main__     INFO     Predict
2021-09-25 09:09:08,500 __main__     INFO     Predict
2021-09-25 09:09:08,592 __main__     INFO     Predict
2021-09-25 09:09:08,687 __main__     INFO     Predict
2021-09-25 09:09:08,777 __main__     INFO     Predict
2021-09-25 09:09:08,866 __main__     INFO     Predict
2021-09-25 09:09:08,955 __main__     INFO     Predict
2021-09-25 09:09:09,046 __main__     INFO     Predict
2021-09-25 09:09:09,138 __main__     INFO     Predict
2021-09-25 09:09:09,227 __main__     INFO     Predict
2021-09-25 09:09:09,316 __main__     INFO     Predict
2021-09-25 09:09:09,405 __main__     INFO     Predict
2021-09-25 09:09:09,494 __main__     INFO     Predict
2021-09-25 09:09:09,582 __main__     INFO     Predict
2021-09-25 09:09:09,678 __main__     INFO     Predict
2021-09-25 09:09:09,766 __main__     INFO     Predict
2021-09-25 09:09:09,854 __main__     INFO     Predict
2021-09-25 09:09:09,946 __main__     INFO     Predict
2021-09-25 09:09:10,038 __main__     INFO     Predict
2021-09-25 09:09:10,127 __main__     INFO     Predict
2021-09-25 09:09:10,217 __main__     INFO     Predict
2021-09-25 09:09:10,305 __main__     INFO     Predict
2021-09-25 09:09:10,394 __main__     INFO     Predict
2021-09-25 09:09:10,487 __main__     INFO     Predict
2021-09-25 09:09:10,607 __main__     INFO     Predict
2021-09-25 09:09:10,702 __main__     INFO     Predict
2021-09-25 09:09:10,792 __main__     INFO     Predict
2021-09-25 09:09:10,881 __main__     INFO     Predict
2021-09-25 09:09:10,969 __main__     INFO     Predict
2021-09-25 09:09:11,058 __main__     INFO     Predict
2021-09-25 09:09:11,164 __main__     INFO     Predict
2021-09-25 09:09:11,277 __main__     INFO     Predict
2021-09-25 09:09:11,368 __main__     INFO     Predict
2021-09-25 09:09:11,470 __main__     INFO     Predict
2021-09-25 09:09:11,569 __main__     INFO     Predict
2021-09-25 09:09:11,659 __main__     INFO     Predict
2021-09-25 09:09:11,747 __main__     INFO     Predict
2021-09-25 09:09:11,848 __main__     INFO     Predict
2021-09-25 09:09:11,939 __main__     INFO     Predict
2021-09-25 09:09:12,031 __main__     INFO     Predict
2021-09-25 09:09:12,129 __main__     INFO     Predict
2021-09-25 09:09:12,230 __main__     INFO     Predict
2021-09-25 09:09:12,331 __main__     INFO     Predict
2021-09-25 09:09:12,432 __main__     INFO     Predict
2021-09-25 09:09:12,524 __main__     INFO     Predict
2021-09-25 09:09:12,619 __main__     INFO     Predict
2021-09-25 09:09:12,716 __main__     INFO     Predict
2021-09-25 09:09:12,837 __main__     INFO     Predict
2021-09-25 09:09:12,926 __main__     INFO     Predict
2021-09-25 09:09:13,016 __main__     INFO     Predict
2021-09-25 09:09:13,106 __main__     INFO     Predict
2021-09-25 09:09:13,195 __main__     INFO     Predict
2021-09-25 09:09:13,286 __main__     INFO     Predict
2021-09-25 09:09:13,377 __main__     INFO     Predict
2021-09-25 09:09:13,465 __main__     INFO     Predict
2021-09-25 09:09:13,554 __main__     INFO     Predict
2021-09-25 09:09:13,644 __main__     INFO     Predict
2021-09-25 09:09:13,734 __main__     INFO     Predict
2021-09-25 09:09:13,824 __main__     INFO     Predict
2021-09-25 09:09:13,913 __main__     INFO     Predict
2021-09-25 09:09:14,004 __main__     INFO     Predict
2021-09-25 09:09:14,094 __main__     INFO     Predict
2021-09-25 09:09:14,185 __main__     INFO     Predict
2021-09-25 09:09:14,273 __main__     INFO     Predict
2021-09-25 09:09:14,362 __main__     INFO     Predict
2021-09-25 09:09:14,452 __main__     INFO     Predict
2021-09-25 09:09:14,544 __main__     INFO     Predict
2021-09-25 09:09:14,636 __main__     INFO     Predict
2021-09-25 09:09:14,726 __main__     INFO     Predict
2021-09-25 09:09:14,815 __main__     INFO     Predict
2021-09-25 09:09:14,912 __main__     INFO     Predict
2021-09-25 09:09:15,032 __main__     INFO     Predict
2021-09-25 09:09:15,123 __main__     INFO     Predict
2021-09-25 09:09:15,211 __main__     INFO     Predict
2021-09-25 09:09:15,300 __main__     INFO     Predict
2021-09-25 09:09:15,390 __main__     INFO     Predict
2021-09-25 09:09:15,479 __main__     INFO     Predict
2021-09-25 09:09:15,568 __main__     INFO     Predict
2021-09-25 09:09:15,660 __main__     INFO     Predict
2021-09-25 09:09:15,752 __main__     INFO     Predict
2021-09-25 09:09:15,841 __main__     INFO     Predict
2021-09-25 09:09:15,929 __main__     INFO     Predict
2021-09-25 09:09:16,019 __main__     INFO     Predict
2021-09-25 09:09:16,118 __main__     INFO     Predict
2021-09-25 09:09:16,205 __main__     INFO     Predict
2021-09-25 09:09:16,296 __main__     INFO     Predict
2021-09-25 09:09:16,383 __main__     INFO     Predict
2021-09-25 09:09:16,473 __main__     INFO     Predict
2021-09-25 09:09:16,562 __main__     INFO     Predict
2021-09-25 09:09:16,651 __main__     INFO     Predict
2021-09-25 09:09:16,740 __main__     INFO     Predict
2021-09-25 09:09:16,829 __main__     INFO     Predict
2021-09-25 09:09:16,917 __main__     INFO     Predict
2021-09-25 09:09:17,004 __main__     INFO     Predict
2021-09-25 09:09:17,099 __main__     INFO     Predict
2021-09-25 09:09:17,219 __main__     INFO     Predict
2021-09-25 09:09:17,311 __main__     INFO     Predict
2021-09-25 09:09:17,401 __main__     INFO     Predict
2021-09-25 09:09:17,493 __main__     INFO     Predict
2021-09-25 09:09:17,585 __main__     INFO     Predict
2021-09-25 09:09:17,674 __main__     INFO     Predict
2021-09-25 09:09:17,763 __main__     INFO     Predict
2021-09-25 09:09:17,853 __main__     INFO     Predict
2021-09-25 09:09:17,942 __main__     INFO     Predict
2021-09-25 09:09:18,032 __main__     INFO     Predict
2021-09-25 09:09:18,129 __main__     INFO     Predict
2021-09-25 09:09:18,223 __main__     INFO     Predict
2021-09-25 09:09:18,325 __main__     INFO     Predict
2021-09-25 09:09:18,437 __main__     INFO     Predict
2021-09-25 09:09:18,528 __main__     INFO     Predict
2021-09-25 09:09:18,616 __main__     INFO     Predict
2021-09-25 09:09:18,707 __main__     INFO     Predict
2021-09-25 09:09:18,798 __main__     INFO     Predict
2021-09-25 09:09:18,886 __main__     INFO     Predict
2021-09-25 09:09:18,977 __main__     INFO     Predict
2021-09-25 09:09:19,066 __main__     INFO     Predict
2021-09-25 09:09:19,162 __main__     INFO     Predict
2021-09-25 09:09:19,253 __main__     INFO     Predict
2021-09-25 09:09:19,364 __main__     INFO     Predict
2021-09-25 09:09:19,480 __main__     INFO     Predict
2021-09-25 09:09:19,569 __main__     INFO     Predict
2021-09-25 09:09:19,660 __main__     INFO     Predict
2021-09-25 09:09:19,749 __main__     INFO     Predict
2021-09-25 09:09:19,840 __main__     INFO     Predict
2021-09-25 09:09:19,930 __main__     INFO     Predict
2021-09-25 09:09:20,020 __main__     INFO     Predict
2021-09-25 09:09:20,073 __main__     INFO     Save results
2021-09-25 09:09:20,084 __main__     INFO     END predict.py
2021-09-25 09:10:46,265 __main__     INFO     START predict.py
2021-09-25 09:10:46,265 __main__     INFO     Load test df
2021-09-25 09:10:46,295 __main__     INFO     Input shape: (2974, 76)
2021-09-25 09:10:46,299 __main__     INFO     Load model
2021-09-25 09:10:46,342 __main__     INFO     Predict
2021-09-25 09:10:46,452 __main__     INFO     Predict
2021-09-25 09:10:46,553 __main__     INFO     Predict
2021-09-25 09:10:46,648 __main__     INFO     Predict
2021-09-25 09:10:46,743 __main__     INFO     Predict
2021-09-25 09:10:46,837 __main__     INFO     Predict
2021-09-25 09:10:46,938 __main__     INFO     Predict
2021-09-25 09:10:47,037 __main__     INFO     Predict
2021-09-25 09:10:47,139 __main__     INFO     Predict
2021-09-25 09:10:47,239 __main__     INFO     Predict
2021-09-25 09:10:47,295 __main__     INFO     Save results
2021-09-25 09:10:47,305 __main__     INFO     END predict.py
2021-09-25 09:22:11,876 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:22:14,315 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 53, in <module>
    corr = train_p.corr()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 9374, in corr
    correl = libalgos.nancorr(mat, minp=min_periods)
  File "pandas\_libs\algos.pyx", line 341, in pandas._libs.algos.nancorr
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 583. GiB for an array with shape (279792, 279792) and data type float64

2021-09-25 09:23:43,183 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:23:43,316 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 49, in <module>
    train_df.astype('float32')
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5806, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 414, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 327, in apply
    applied = getattr(b, f)(**kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\blocks.py", line 592, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1309, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1257, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1095, in astype_nansafe
    result = astype_nansafe(flat, dtype, copy=copy, skipna=skipna)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1201, in astype_nansafe
    return arr.astype(dtype, copy=True)
ValueError: could not convert string to float: ''

2021-09-25 09:29:14,016 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:29:14,122 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 52, in <module>
    transformed = encoder.transform(train_df[CATEGORICAL_OHE_FEATURES].to_numpy().reshape(-1, 1))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_encoders.py", line 469, in transform
    check_is_fitted(self)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 1098, in check_is_fitted
    raise NotFittedError(msg % {'name': type(estimator).__name__})
sklearn.exceptions.NotFittedError: This OneHotEncoder instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.

2021-09-25 09:29:59,502 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:29:59,612 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 52, in <module>
    encoder.fit(train_df[CATEGORICAL_OHE_FEATURES].unique().reshape(1, -1))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5478, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'unique'

2021-09-25 09:30:38,350 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:30:38,482 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 53, in <module>
    transformed = encoder.transform(train_df['region'].to_numpy().reshape(-1, 1))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_encoders.py", line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_encoders.py", line 120, in _transform
    raise ValueError(
ValueError: The number of features in X is different to the number of features of the fitted data. The fitted data had 49 features and the X has 1 features.

2021-09-25 09:32:45,803 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:32:45,942 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 49, in <module>
    train_df.astype('float32')
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5806, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 414, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 327, in apply
    applied = getattr(b, f)(**kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\blocks.py", line 592, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1309, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1257, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1095, in astype_nansafe
    result = astype_nansafe(flat, dtype, copy=copy, skipna=skipna)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1201, in astype_nansafe
    return arr.astype(dtype, copy=True)
ValueError: could not convert string to float: ''

2021-09-25 09:34:20,406 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:34:22,849 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 53, in <module>
    corr = train_p.corr()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 9374, in corr
    correl = libalgos.nancorr(mat, minp=min_periods)
  File "pandas\_libs\algos.pyx", line 341, in pandas._libs.algos.nancorr
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 583. GiB for an array with shape (279792, 279792) and data type float64

2021-09-25 09:36:51,123 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:36:51,271 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 49, in <module>
    train_df.loc[CATEGORICAL_OHE_FEATURES].astype('float32')
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 931, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1153, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1093, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1374, in _validate_read_indexer
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['region', 'city', 'realty_type'], dtype='object')] are in the [index]"

2021-09-25 09:37:32,772 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:37:32,884 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 49, in <module>
    train_df[CATEGORICAL_OHE_FEATURES].astype('float32')
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5806, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 414, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\managers.py", line 327, in apply
    applied = getattr(b, f)(**kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\internals\blocks.py", line 592, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1309, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1257, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1095, in astype_nansafe
    result = astype_nansafe(flat, dtype, copy=copy, skipna=skipna)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\dtypes\cast.py", line 1201, in astype_nansafe
    return arr.astype(dtype, copy=True)
ValueError: could not convert string to float: ' '

2021-09-25 09:39:26,995 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:39:29,471 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 53, in <module>
    train_p[NUM_FEATURES].astype('float32')
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3461, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1374, in _validate_read_indexer
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['lat', 'lng', 'osm_amenity_points_in_0.001',\n       'osm_amenity_points_in_0.005', 'osm_amenity_points_in_0.0075',\n       'osm_amenity_points_in_0.01', 'osm_building_points_in_0.001',\n       'osm_building_points_in_0.005', 'osm_building_points_in_0.0075',\n       'osm_building_points_in_0.01', 'osm_catering_points_in_0.001',\n       'osm_catering_points_in_0.005', 'osm_catering_points_in_0.0075',\n       'osm_catering_points_in_0.01', 'osm_city_closest_dist',\n       'osm_city_nearest_population', 'osm_crossing_closest_dist',\n       'osm_crossing_points_in_0.001', 'osm_crossing_points_in_0.005',\n       'osm_crossing_points_in_0.0075', 'osm_crossing_points_in_0.01',\n       'osm_culture_points_in_0.001', 'osm_culture_points_in_0.005',\n       'osm_culture_points_in_0.0075', 'osm_culture_points_in_0.01',\n       'osm_finance_points_in_0.001', 'osm_finance_points_in_0.005',\n       'osm_finance_points_in_0.0075', 'osm_finance_points_in_0.01',\n       'osm_healthcare_points_in_0.005', 'osm_healthcare_points_in_0.0075',\n       'osm_healthcare_points_in_0.01', 'osm_historic_points_in_0.005',\n       'osm_historic_points_in_0.0075', 'osm_historic_points_in_0.01',\n       'osm_hotels_points_in_0.005', 'osm_hotels_points_in_0.0075',\n       'osm_hotels_points_in_0.01', 'osm_leisure_points_in_0.005',\n       'osm_leisure_points_in_0.0075', 'osm_leisure_points_in_0.01',\n       'osm_offices_points_in_0.001', 'osm_offices_points_in_0.005',\n       'osm_offices_points_in_0.0075', 'osm_offices_points_in_0.01',\n       'osm_shops_points_in_0.001', 'osm_shops_points_in_0.005',\n       'osm_shops_points_in_0.0075', 'osm_shops_points_in_0.01',\n       'osm_subway_closest_dist', 'osm_train_stop_closest_dist',\n       'osm_train_stop_points_in_0.005', 'osm_train_stop_points_in_0.0075',\n       'osm_train_stop_points_in_0.01', 'osm_transport_stop_closest_dist',\n       'osm_transport_stop_points_in_0.005',\n       'osm_transport_stop_points_in_0.0075',\n       'osm_transport_stop_points_in_0.01', 'reform_count_of_houses_1000',\n       'reform_count_of_houses_500', 'reform_house_population_1000',\n       'reform_house_population_500', 'reform_mean_floor_count_1000',\n       'reform_mean_floor_count_500', 'reform_mean_year_building_1000',\n       'reform_mean_year_building_500', 'total_square'],\n      dtype='object', name='id')] are in the [columns]"

2021-09-25 09:40:04,751 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:40:07,339 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 55, in <module>
    corr = train_p.corr()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 9374, in corr
    correl = libalgos.nancorr(mat, minp=min_periods)
  File "pandas\_libs\algos.pyx", line 341, in pandas._libs.algos.nancorr
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 583. GiB for an array with shape (279792, 279792) and data type float64

2021-09-25 09:41:01,543 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:41:05,855 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 55, in <module>
    corr = train_p.corr()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 9374, in corr
    correl = libalgos.nancorr(mat, minp=min_periods)
  File "pandas\_libs\algos.pyx", line 341, in pandas._libs.algos.nancorr
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 583. GiB for an array with shape (279792, 279792) and data type float64

2021-09-25 09:43:23,987 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:43:28,859 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 59, in <module>
    kmeans = KMeans(n_clusters=7, random_state=0).fit(corr.values)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\cluster\_kmeans.py", line 979, in fit
    X = self._validate_data(X, accept_sparse='csr',
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 720, in check_array
    _assert_all_finite(array,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 103, in _assert_all_finite
    raise ValueError(
ValueError: Input contains NaN, infinity or a value too large for dtype('float64').

2021-09-25 09:47:42,481 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:47:47,087 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 61, in <module>
    kmeans = KMeans(n_clusters=7, random_state=0).fit(corr.values)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\cluster\_kmeans.py", line 979, in fit
    X = self._validate_data(X, accept_sparse='csr',
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 720, in check_array
    _assert_all_finite(array,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 103, in _assert_all_finite
    raise ValueError(
ValueError: Input contains NaN, infinity or a value too large for dtype('float64').

2021-09-25 09:48:14,503 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:48:19,357 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    kmeans = KMeans(n_clusters=7, random_state=0).fit(corr.values)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\cluster\_kmeans.py", line 979, in fit
    X = self._validate_data(X, accept_sparse='csr',
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 726, in check_array
    raise ValueError("Found array with %d sample(s) (shape=%s) while a"
ValueError: Found array with 0 sample(s) (shape=(0, 49)) while a minimum of 1 is required.

2021-09-25 09:48:42,469 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:48:47,450 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 63, in <module>
    kmeans = KMeans(n_clusters=7, random_state=0).fit(corr.values)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\cluster\_kmeans.py", line 979, in fit
    X = self._validate_data(X, accept_sparse='csr',
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 726, in check_array
    raise ValueError("Found array with %d sample(s) (shape=%s) while a"
ValueError: Found array with 0 sample(s) (shape=(0, 49)) while a minimum of 1 is required.

2021-09-25 09:49:50,346 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:49:55,250 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 63, in <module>
    kmeans = KMeans(n_clusters=7, random_state=0).fit(corr.values)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\cluster\_kmeans.py", line 979, in fit
    X = self._validate_data(X, accept_sparse='csr',
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 720, in check_array
    _assert_all_finite(array,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 103, in _assert_all_finite
    raise ValueError(
ValueError: Input contains NaN, infinity or a value too large for dtype('float64').

2021-09-25 09:51:02,590 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:51:03,059 __main__     INFO     X_offer (220271, 73)  y_offer (220271,)	X_manual (931, 73) y_manual (931,)
2021-09-25 09:51:03,059 __main__     INFO     Fit model
2021-09-25 09:51:03,059 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:51:03,066 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 113, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 81, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(70)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 341, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 398, in _get_column_indices
    raise ValueError(f"Selected columns, {columns}, are not "
ValueError: Selected columns, ['region', 'city', 'realty_type'], are not unique in dataframe

2021-09-25 09:52:41,672 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:52:42,139 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 09:52:42,140 __main__     INFO     Fit model
2021-09-25 09:52:42,140 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:52:45,693 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 113, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 81, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(70)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 818, in fit
    super().fit(X, y, sample_weight=sample_weight, init_score=init_score,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 683, in fit
    self._Booster = train(params, train_set,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\engine.py", line 228, in train
    booster = Booster(params=params, train_set=train_set)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 2229, in __init__
    train_set.construct()
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1468, in construct
    self._lazy_init(self.data, label=self.label,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1298, in _lazy_init
    return self.set_feature_name(feature_name)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1777, in set_feature_name
    raise ValueError("Length of feature_name({}) and num_feature({}) don't match"
ValueError: Length of feature_name(70) and num_feature(4648) don't match

2021-09-25 09:55:16,406 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:55:16,837 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 09:55:16,837 __main__     INFO     Fit model
2021-09-25 09:55:16,837 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:55:35,609 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:55:36,026 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 09:55:36,026 __main__     INFO     Fit model
2021-09-25 09:55:36,026 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:56:53,558 raif_hack.model INFO     Find corr coefficient
2021-09-25 09:56:53,724 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 09:56:53,724 __main__     INFO     Save model
2021-09-25 09:57:31,250 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5533609932133416, 'mdape': 0.31943960010767253, 'rmse': 74102.32471000034, 'r2': 0.8146019613719574, 'raif_metric': 3.558030590544264}
2021-09-25 09:57:31,420 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3089318532546806, 'mdape': 0.25075574351802277, 'rmse': 41801.3558560811, 'r2': 0.5821126986765743, 'raif_metric': 2.0766374569468824}
2021-09-25 09:57:31,760 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-25 09:57:31,764 __main__     INFO     Fit model
2021-09-25 09:57:31,764 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:57:35,251 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 113, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 81, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(4648)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 818, in fit
    super().fit(X, y, sample_weight=sample_weight, init_score=init_score,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 683, in fit
    self._Booster = train(params, train_set,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\engine.py", line 228, in train
    booster = Booster(params=params, train_set=train_set)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 2229, in __init__
    train_set.construct()
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1468, in construct
    self._lazy_init(self.data, label=self.label,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1298, in _lazy_init
    return self.set_feature_name(feature_name)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1777, in set_feature_name
    raise ValueError("Length of feature_name({}) and num_feature({}) don't match"
ValueError: Length of feature_name(4648) and num_feature(4657) don't match

2021-09-25 09:59:21,621 __main__     INFO     Input shape: (279792, 77)
2021-09-25 09:59:22,041 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 09:59:22,042 __main__     INFO     Fit model
2021-09-25 09:59:22,042 raif_hack.model INFO     Fit lightgbm
2021-09-25 09:59:25,515 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 115, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual, num_f)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 81, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(num_f)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 818, in fit
    super().fit(X, y, sample_weight=sample_weight, init_score=init_score,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\sklearn.py", line 683, in fit
    self._Booster = train(params, train_set,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\engine.py", line 228, in train
    booster = Booster(params=params, train_set=train_set)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 2229, in __init__
    train_set.construct()
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1468, in construct
    self._lazy_init(self.data, label=self.label,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1298, in _lazy_init
    return self.set_feature_name(feature_name)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightgbm\basic.py", line 1777, in set_feature_name
    raise ValueError("Length of feature_name({}) and num_feature({}) don't match"
ValueError: Length of feature_name(70) and num_feature(4648) don't match

2021-09-25 10:01:48,168 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:01:48,608 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:01:48,609 __main__     INFO     Fit model
2021-09-25 10:01:48,609 raif_hack.model INFO     Fit lightgbm
2021-09-25 10:03:05,257 raif_hack.model INFO     Find corr coefficient
2021-09-25 10:03:05,425 raif_hack.model INFO     Corr coef: -0.13
2021-09-25 10:03:05,425 __main__     INFO     Save model
2021-09-25 10:03:42,972 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5533609932133416, 'mdape': 0.31943960010767253, 'rmse': 74102.32471000034, 'r2': 0.8146019613719574, 'raif_metric': 3.558030590544264}
2021-09-25 10:03:43,145 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3089318532546806, 'mdape': 0.25075574351802277, 'rmse': 41801.3558560811, 'r2': 0.5821126986765743, 'raif_metric': 2.0766374569468824}
2021-09-25 10:03:43,473 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-25 10:03:43,477 __main__     INFO     Fit model
2021-09-25 10:03:43,477 raif_hack.model INFO     Fit lightgbm
2021-09-25 10:04:59,849 raif_hack.model INFO     Find corr coefficient
2021-09-25 10:04:59,862 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 114, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual, num_f[-1])
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    self._find_corr_coefficient(X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 65, in _find_corr_coefficient
    predictions = self.pipeline.predict(X_manual)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 418, in predict
    Xt = transform.transform(Xt)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 1044, in __call__
    while self.dispatch_one_batch(iterator):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\fixes.py", line 222, in __call__
    return self.function(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 733, in _transform_one
    res = transformer.transform(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_encoders.py", line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\preprocessing\_encoders.py", line 136, in _transform
    raise ValueError(msg)
ValueError: Found unknown categories [' , . '] in column 1 during transform

2021-09-25 10:20:30,164 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:20:43,758 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 115, in <module>
    X = tr[FECOLS + MEDCOLS].values
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3461, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1377, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['per_square_meter_price_19', 'per_square_meter_price_18', 'per_square_meter_price_17', 'per_square_meter_price_16', 'per_square_meter_price_15', 'per_square_meter_price_14', 'per_square_meter_price_13', 'per_square_meter_price_12', 'per_square_meter_price_11', 'per_square_meter_price_10', 'per_square_meter_price_9', 'per_square_meter_price_8', 'per_square_meter_price_7', 'per_square_meter_price_6', 'per_square_meter_price_5', 'per_square_meter_price_4', 'per_square_meter_price_3', 'per_square_meter_price_2', 'per_square_meter_price_1'] not in index"

2021-09-25 10:23:08,197 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:23:23,210 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 115, in <module>
    X = tr[FECOLS + MEDCOLS].values
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3461, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1377, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['per_square_meter_price_19', 'per_square_meter_price_18', 'per_square_meter_price_17', 'per_square_meter_price_16', 'per_square_meter_price_15', 'per_square_meter_price_14', 'per_square_meter_price_13', 'per_square_meter_price_12', 'per_square_meter_price_11', 'per_square_meter_price_10', 'per_square_meter_price_9', 'per_square_meter_price_8', 'per_square_meter_price_7', 'per_square_meter_price_6', 'per_square_meter_price_5', 'per_square_meter_price_4', 'per_square_meter_price_3', 'per_square_meter_price_2', 'per_square_meter_price_1'] not in index"

2021-09-25 10:38:54,423 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:38:54,954 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:38:54,983 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 116, in <module>
    model = base_model()
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in base_model
    stock_embedded = keras.layers.Embedding(max(cat_data) + 1, stock_embedding_size,
TypeError: can only concatenate str (not "int") to str

2021-09-25 10:40:00,049 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:40:00,579 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:40:00,583 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 116, in <module>
    model = base_model()
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in base_model
    stock_embedded = keras.layers.Embedding(max(cat_data) + 1, stock_embedding_size,
TypeError: can only concatenate str (not "int") to str

2021-09-25 10:40:24,482 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:40:24,999 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:40:26,444 __main__     INFO     Fit model
2021-09-25 10:40:27,114 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 106, in normalize_element
    spec = type_spec_from_value(t, use_fallback=False)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 486, in type_spec_from_value
    raise TypeError("Could not build a TypeSpec for %r with type %s" %
TypeError: Could not build a TypeSpec for               lat        lng  ...          city  realty_type
0       57.998207  56.292797  ...                    10
1       55.574284  39.543835  ...                   10
2       57.619140  39.850525  ...               110
3       53.897083  87.108604  ...             110
4       55.802590  37.487110  ...                   10
...           ...        ...  ...           ...          ...
275294  55.118484  61.434086  ...               110
275295  56.819410  60.623913  ...            110
275296  57.640812  39.877770  ...                10
275297  56.792490  60.609450  ...            110
275298  56.810510  60.514793  ...            110

[220271 rows x 70 columns] with type DataFrame

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 125, in <module>
    model.fit(X_offer,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 322, in __init__
    dataset = self.slice_inputs(indices_dataset, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 348, in slice_inputs
    tf.data.Dataset.from_tensors(inputs).repeat()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 606, in from_tensors
    return TensorDataset(tensors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 3825, in __init__
    element = structure.normalize_element(element)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 111, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 346, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:40:55,070 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:40:55,544 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:40:56,280 __main__     INFO     Fit model
2021-09-25 10:40:56,908 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 106, in normalize_element
    spec = type_spec_from_value(t, use_fallback=False)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 486, in type_spec_from_value
    raise TypeError("Could not build a TypeSpec for %r with type %s" %
TypeError: Could not build a TypeSpec for               lat        lng  ...          city  realty_type
0       57.998207  56.292797  ...                    10
1       55.574284  39.543835  ...                   10
2       57.619140  39.850525  ...               110
3       53.897083  87.108604  ...             110
4       55.802590  37.487110  ...                   10
...           ...        ...  ...           ...          ...
275294  55.118484  61.434086  ...               110
275295  56.819410  60.623913  ...            110
275296  57.640812  39.877770  ...                10
275297  56.792490  60.609450  ...            110
275298  56.810510  60.514793  ...            110

[220271 rows x 70 columns] with type DataFrame

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 125, in <module>
    model.fit(X_offer,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 322, in __init__
    dataset = self.slice_inputs(indices_dataset, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 348, in slice_inputs
    tf.data.Dataset.from_tensors(inputs).repeat()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 606, in from_tensors
    return TensorDataset(tensors)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 3825, in __init__
    element = structure.normalize_element(element)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\data\util\structure.py", line 111, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 346, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:41:50,646 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:41:51,126 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:41:51,863 __main__     INFO     Fit model
2021-09-25 10:41:51,866 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 124, in <module>
    print(X_offer.dtype())
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5478, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'

2021-09-25 10:42:56,731 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:42:57,203 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:42:57,946 __main__     INFO     Fit model
2021-09-25 10:42:57,949 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 124, in <module>
    model.fit(X_offer.numpy(),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\generic.py", line 5478, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'numpy'

2021-09-25 10:43:52,755 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:43:53,227 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:43:53,963 __main__     INFO     Fit model
2021-09-25 10:43:54,482 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 124, in <module>
    model.fit(X_offer.to_numpy(),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 230, in __init__
    x, y, sample_weights = _process_tensorlike((x, y, sample_weights))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1031, in _process_tensorlike
    inputs = tf.nest.map_structure(_convert_numpy_and_scipy, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in map_structure
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1026, in _convert_numpy_and_scipy
    return tf.convert_to_tensor(x, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1430, in convert_to_tensor_v2_with_dispatch
    return convert_to_tensor_v2(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1436, in convert_to_tensor_v2
    return convert_to_tensor(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\tensor_conversion_registry.py", line 52, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:44:42,474 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:44:42,947 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:44:43,673 __main__     INFO     Fit model
2021-09-25 10:44:44,675 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 126, in <module>
    model.fit(X_offer.to_numpy(),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 230, in __init__
    x, y, sample_weights = _process_tensorlike((x, y, sample_weights))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1031, in _process_tensorlike
    inputs = tf.nest.map_structure(_convert_numpy_and_scipy, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in map_structure
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1026, in _convert_numpy_and_scipy
    return tf.convert_to_tensor(x, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1430, in convert_to_tensor_v2_with_dispatch
    return convert_to_tensor_v2(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1436, in convert_to_tensor_v2
    return convert_to_tensor(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\tensor_conversion_registry.py", line 52, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:50:09,327 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:50:09,798 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:50:10,454 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 116, in <module>
    model = base_model()
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 78, in base_model
    out = keras.layers.Concatenate()([stock_flattened, input])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\base_layer.py", line 976, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\base_layer.py", line 1114, in _functional_construction_call
    outputs = self._keras_tensor_symbolic_call(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\base_layer.py", line 848, in _keras_tensor_symbolic_call
    return self._infer_output_signature(inputs, args, kwargs, input_masks)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\base_layer.py", line 886, in _infer_output_signature
    self._maybe_build(inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\base_layer.py", line 2659, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\utils\tf_utils.py", line 259, in wrapper
    output_shape = fn(instance, input_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\layers\merge.py", line 506, in build
    raise ValueError(err_msg)
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 517055616), (None, 279792, 77)]

2021-09-25 10:50:41,722 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:50:42,193 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:50:42,926 __main__     INFO     Fit model
2021-09-25 10:50:43,909 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 126, in <module>
    model.fit(X_offer.to_numpy(),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 230, in __init__
    x, y, sample_weights = _process_tensorlike((x, y, sample_weights))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1031, in _process_tensorlike
    inputs = tf.nest.map_structure(_convert_numpy_and_scipy, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in map_structure
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1026, in _convert_numpy_and_scipy
    return tf.convert_to_tensor(x, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1430, in convert_to_tensor_v2_with_dispatch
    return convert_to_tensor_v2(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1436, in convert_to_tensor_v2
    return convert_to_tensor(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\tensor_conversion_registry.py", line 52, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:52:25,393 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:52:25,865 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:52:26,602 __main__     INFO     Fit model
2021-09-25 10:52:27,588 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 126, in <module>
    model.fit(np.expand_dims(X_offer.to_numpy(), -1),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 230, in __init__
    x, y, sample_weights = _process_tensorlike((x, y, sample_weights))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1031, in _process_tensorlike
    inputs = tf.nest.map_structure(_convert_numpy_and_scipy, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in map_structure
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1026, in _convert_numpy_and_scipy
    return tf.convert_to_tensor(x, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1430, in convert_to_tensor_v2_with_dispatch
    return convert_to_tensor_v2(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1436, in convert_to_tensor_v2
    return convert_to_tensor(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\tensor_conversion_registry.py", line 52, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 10:53:13,227 __main__     INFO     Input shape: (279792, 77)
2021-09-25 10:53:13,706 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 10:53:14,389 __main__     INFO     Fit model
2021-09-25 10:53:15,424 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 122, in <module>
    model.fit(X_offer.to_numpy(),
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\training.py", line 1134, in fit
    data_handler = data_adapter.get_data_handler(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1383, in get_data_handler
    return DataHandler(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1138, in __init__
    self._adapter = adapter_cls(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 230, in __init__
    x, y, sample_weights = _process_tensorlike((x, y, sample_weights))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1031, in _process_tensorlike
    inputs = tf.nest.map_structure(_convert_numpy_and_scipy, inputs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in map_structure
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\nest.py", line 869, in <listcomp>
    structure[0], [func(*x) for x in entries],
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\keras\engine\data_adapter.py", line 1026, in _convert_numpy_and_scipy
    return tf.convert_to_tensor(x, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\util\dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1430, in convert_to_tensor_v2_with_dispatch
    return convert_to_tensor_v2(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1436, in convert_to_tensor_v2
    return convert_to_tensor(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\profiler\trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\ops.py", line 1566, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\tensor_conversion_registry.py", line 52, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 271, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 283, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 308, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\tensorflow\python\framework\constant_op.py", line 106, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2021-09-25 11:04:17,458 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:04:17,844 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:04:17,844 __main__     INFO     Fit model
2021-09-25 11:04:17,844 raif_hack.model INFO     Fit
2021-09-25 11:04:17,846 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    dtrain = xgb.DMatrix(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 436, in inner_f
    return f(**kwargs)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 541, in __init__
    handle, feature_names, feature_types = dispatch_data_backend(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 573, in dispatch_data_backend
    return _from_pandas_df(data, enable_categorical, missing, threads,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 258, in _from_pandas_df
    data, feature_names, feature_types = _transform_pandas_df(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 223, in _transform_pandas_df
    raise ValueError(msg + ', '.join(bad_fields))
ValueError: DataFrame.dtypes for data must be int, float, bool or categorical.  When
                categorical type is supplied, DMatrix parameter
                `enable_categorical` must be set to `True`.region, city

2021-09-25 11:04:58,462 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:04:58,850 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:04:58,850 __main__     INFO     Fit model
2021-09-25 11:04:58,850 raif_hack.model INFO     Fit
2021-09-25 11:04:58,852 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    dtrain = xgb.DMatrix(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 436, in inner_f
    return f(**kwargs)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 541, in __init__
    handle, feature_names, feature_types = dispatch_data_backend(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 573, in dispatch_data_backend
    return _from_pandas_df(data, enable_categorical, missing, threads,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 258, in _from_pandas_df
    data, feature_names, feature_types = _transform_pandas_df(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 223, in _transform_pandas_df
    raise ValueError(msg + ', '.join(bad_fields))
ValueError: DataFrame.dtypes for data must be int, float, bool or categorical.  When
                categorical type is supplied, DMatrix parameter
                `enable_categorical` must be set to `True`.region, city

2021-09-25 11:05:20,543 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:05:20,932 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:05:20,933 __main__     INFO     Fit model
2021-09-25 11:05:20,933 raif_hack.model INFO     Fit
2021-09-25 11:05:20,935 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    dtrain = xgb.DMatrix(X_offer, y_offer, enable_categorical=True)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 436, in inner_f
    return f(**kwargs)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 541, in __init__
    handle, feature_names, feature_types = dispatch_data_backend(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 573, in dispatch_data_backend
    return _from_pandas_df(data, enable_categorical, missing, threads,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 258, in _from_pandas_df
    data, feature_names, feature_types = _transform_pandas_df(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 223, in _transform_pandas_df
    raise ValueError(msg + ', '.join(bad_fields))
ValueError: DataFrame.dtypes for data must be int, float, bool or categorical.  When
                categorical type is supplied, DMatrix parameter
                `enable_categorical` must be set to `True`.region, city

2021-09-25 11:06:27,147 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:06:27,539 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:06:27,540 __main__     INFO     Fit model
2021-09-25 11:06:27,540 raif_hack.model INFO     Fit
2021-09-25 11:06:27,542 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    dtrain = xgb.DMatrix(X_offer, y_offer, enable_categorical=True)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 436, in inner_f
    return f(**kwargs)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 541, in __init__
    handle, feature_names, feature_types = dispatch_data_backend(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 573, in dispatch_data_backend
    return _from_pandas_df(data, enable_categorical, missing, threads,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 258, in _from_pandas_df
    data, feature_names, feature_types = _transform_pandas_df(
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\data.py", line 223, in _transform_pandas_df
    raise ValueError(msg + ', '.join(bad_fields))
ValueError: DataFrame.dtypes for data must be int, float, bool or categorical.  When
                categorical type is supplied, DMatrix parameter
                `enable_categorical` must be set to `True`.region, city

2021-09-25 11:07:40,041 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:07:40,432 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:07:40,432 __main__     INFO     Fit model
2021-09-25 11:07:40,432 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:07:40,976 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 83, in fit
    self.pipeline.fit(X_offer, y_offer, model__feature_name=[f'{i}' for i in range(70)],model__categorical_feature=['67','68','69'])
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\xgboost\core.py", line 436, in inner_f
    return f(**kwargs)
TypeError: fit() got an unexpected keyword argument 'feature_name'

2021-09-25 11:08:01,889 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:08:02,278 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:08:02,278 __main__     INFO     Fit model
2021-09-25 11:08:02,278 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:08:21,440 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:08:21,835 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:08:21,836 __main__     INFO     Fit model
2021-09-25 11:08:21,836 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:08:32,669 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:08:32,683 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 11:08:32,683 __main__     INFO     Save model
2021-09-25 11:08:34,718 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7855425142584038, 'mdape': 0.3618244100182704, 'rmse': 96344.7665717525, 'r2': 0.6866009125368691, 'raif_metric': 3.9455264714267835}
2021-09-25 11:08:34,737 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3123396193256443, 'mdape': 0.2573132226980997, 'rmse': 46839.75276299655, 'r2': 0.4753041552481576, 'raif_metric': 2.120557775986077}
2021-09-25 11:08:35,040 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-25 11:08:35,041 __main__     INFO     Fit model
2021-09-25 11:08:35,041 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:08:44,912 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:08:44,925 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:08:44,925 __main__     INFO     Save model
2021-09-25 11:08:46,954 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7900981681805221, 'mdape': 0.36114196746434846, 'rmse': 96886.63860322467, 'r2': 0.6878485187656693, 'raif_metric': 3.9434003393351635}
2021-09-25 11:08:46,974 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28304119786432425, 'mdape': 0.2330815323905747, 'rmse': 39955.39876757549, 'r2': 0.5293090504172326, 'raif_metric': 1.9826458106987526}
2021-09-25 11:08:47,277 __main__     INFO     X_offer (220238, 70)  y_offer (220238,)	X_manual (897, 70) y_manual (897,)
2021-09-25 11:08:47,278 __main__     INFO     Fit model
2021-09-25 11:08:47,278 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:08:57,613 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:08:57,626 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:08:57,626 __main__     INFO     Save model
2021-09-25 11:08:59,668 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7626495381870955, 'mdape': 0.361604926172826, 'rmse': 95931.20579285773, 'r2': 0.6935691172642408, 'raif_metric': 3.936636158968855}
2021-09-25 11:08:59,688 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3155025585210288, 'mdape': 0.24698428764492372, 'rmse': 69542.74071172392, 'r2': 0.347813502717475, 'raif_metric': 2.2567616180589707}
2021-09-25 11:08:59,996 __main__     INFO     X_offer (220246, 70)  y_offer (220246,)	X_manual (905, 70) y_manual (905,)
2021-09-25 11:08:59,996 __main__     INFO     Fit model
2021-09-25 11:08:59,996 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:09:09,950 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:09:09,964 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:09:09,964 __main__     INFO     Save model
2021-09-25 11:09:11,970 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7761163129127426, 'mdape': 0.3620034612955727, 'rmse': 96250.93833364687, 'r2': 0.6901583638108177, 'raif_metric': 3.9493257679018026}
2021-09-25 11:09:11,990 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.34626518495711395, 'mdape': 0.23812029999839812, 'rmse': 104705.78205753698, 'r2': 0.23085272024817383, 'raif_metric': 2.1961645443336284}
2021-09-25 11:09:12,298 __main__     INFO     X_offer (220241, 70)  y_offer (220241,)	X_manual (900, 70) y_manual (900,)
2021-09-25 11:09:12,299 __main__     INFO     Fit model
2021-09-25 11:09:12,299 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:09:23,143 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:09:23,157 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 11:09:23,157 __main__     INFO     Save model
2021-09-25 11:09:25,197 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7853972776449087, 'mdape': 0.362560858982412, 'rmse': 96033.70048187963, 'r2': 0.6926623194316729, 'raif_metric': 3.9518045634103074}
2021-09-25 11:09:25,216 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.31176356116887416, 'mdape': 0.24301480629311187, 'rmse': 92001.44864395019, 'r2': 0.1972701192620503, 'raif_metric': 2.2222231065535096}
2021-09-25 11:09:25,217 __main__     INFO     END train.py
2021-09-25 11:11:25,297 __main__     INFO     START predict.py
2021-09-25 11:11:25,297 __main__     INFO     Load test df
2021-09-25 11:11:25,326 __main__     INFO     Input shape: (2974, 76)
2021-09-25 11:11:25,330 __main__     INFO     Load model
2021-09-25 11:11:25,379 __main__     INFO     Predict
2021-09-25 11:11:25,415 __main__     INFO     Predict
2021-09-25 11:11:25,453 __main__     INFO     Predict
2021-09-25 11:11:25,487 __main__     INFO     Predict
2021-09-25 11:11:25,521 __main__     INFO     Predict
2021-09-25 11:11:25,538 __main__     INFO     Save results
2021-09-25 11:11:25,548 __main__     INFO     END predict.py
2021-09-25 11:14:06,055 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:14:06,480 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:14:06,481 __main__     INFO     Fit model
2021-09-25 11:14:06,481 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:14:16,658 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:14:16,673 raif_hack.model INFO     Corr coef: -0.17
2021-09-25 11:14:16,673 __main__     INFO     Save model
2021-09-25 11:14:18,714 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7855425142584038, 'mdape': 0.3618244100182704, 'rmse': 96344.7665717525, 'r2': 0.6866009125368691, 'raif_metric': 3.9455264714267835}
2021-09-25 11:14:18,734 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3123396193256443, 'mdape': 0.2573132226980997, 'rmse': 46839.75276299655, 'r2': 0.4753041552481576, 'raif_metric': 2.120557775986077}
2021-09-25 11:14:19,055 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-25 11:14:19,055 __main__     INFO     Fit model
2021-09-25 11:14:19,056 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:14:29,137 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:14:29,151 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:14:29,151 __main__     INFO     Save model
2021-09-25 11:14:31,173 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7900981681805221, 'mdape': 0.36114196746434846, 'rmse': 96886.63860322467, 'r2': 0.6878485187656693, 'raif_metric': 3.9434003393351635}
2021-09-25 11:14:31,192 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.28304119786432425, 'mdape': 0.2330815323905747, 'rmse': 39955.39876757549, 'r2': 0.5293090504172326, 'raif_metric': 1.9826458106987526}
2021-09-25 11:14:31,549 __main__     INFO     X_offer (220238, 70)  y_offer (220238,)	X_manual (897, 70) y_manual (897,)
2021-09-25 11:14:31,550 __main__     INFO     Fit model
2021-09-25 11:14:31,550 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:14:41,720 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:14:41,733 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:14:41,733 __main__     INFO     Save model
2021-09-25 11:14:43,787 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7626495381870955, 'mdape': 0.361604926172826, 'rmse': 95931.20579285773, 'r2': 0.6935691172642408, 'raif_metric': 3.936636158968855}
2021-09-25 11:14:43,807 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3155025585210288, 'mdape': 0.24698428764492372, 'rmse': 69542.74071172392, 'r2': 0.347813502717475, 'raif_metric': 2.2567616180589707}
2021-09-25 11:14:44,127 __main__     INFO     X_offer (220246, 70)  y_offer (220246,)	X_manual (905, 70) y_manual (905,)
2021-09-25 11:14:44,127 __main__     INFO     Fit model
2021-09-25 11:14:44,128 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:14:54,359 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:14:54,373 raif_hack.model INFO     Corr coef: -0.18
2021-09-25 11:14:54,373 __main__     INFO     Save model
2021-09-25 11:14:56,412 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7761163129127426, 'mdape': 0.3620034612955727, 'rmse': 96250.93833364687, 'r2': 0.6901583638108177, 'raif_metric': 3.9493257679018026}
2021-09-25 11:14:56,432 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.34626518495711395, 'mdape': 0.23812029999839812, 'rmse': 104705.78205753698, 'r2': 0.23085272024817383, 'raif_metric': 2.1961645443336284}
2021-09-25 11:14:56,750 __main__     INFO     X_offer (220241, 70)  y_offer (220241,)	X_manual (900, 70) y_manual (900,)
2021-09-25 11:14:56,750 __main__     INFO     Fit model
2021-09-25 11:14:56,750 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:15:06,553 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:15:06,566 raif_hack.model INFO     Corr coef: -0.15
2021-09-25 11:15:06,566 __main__     INFO     Save model
2021-09-25 11:15:08,599 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.7853972776449087, 'mdape': 0.362560858982412, 'rmse': 96033.70048187963, 'r2': 0.6926623194316729, 'raif_metric': 3.9518045634103074}
2021-09-25 11:15:08,619 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.31176356116887416, 'mdape': 0.24301480629311187, 'rmse': 92001.44864395019, 'r2': 0.1972701192620503, 'raif_metric': 2.2222231065535096}
2021-09-25 11:15:08,619 __main__     INFO     END train.py
2021-09-25 11:15:25,387 __main__     INFO     START predict.py
2021-09-25 11:15:25,387 __main__     INFO     Load test df
2021-09-25 11:15:25,418 __main__     INFO     Input shape: (2974, 76)
2021-09-25 11:15:25,421 __main__     INFO     Load model
2021-09-25 11:15:25,472 __main__     INFO     Predict
2021-09-25 11:15:25,510 __main__     INFO     Predict
2021-09-25 11:15:25,547 __main__     INFO     Predict
2021-09-25 11:15:25,583 __main__     INFO     Predict
2021-09-25 11:15:25,619 __main__     INFO     Predict
2021-09-25 11:15:25,637 __main__     INFO     Save results
2021-09-25 11:15:25,647 __main__     INFO     END predict.py
2021-09-25 11:15:59,705 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:16:00,130 __main__     INFO     X_offer (220271, 70)  y_offer (220271,)	X_manual (931, 70) y_manual (931,)
2021-09-25 11:16:00,132 __main__     INFO     Fit model
2021-09-25 11:16:00,133 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:16:21,310 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:16:21,346 raif_hack.model INFO     Corr coef: -0.12
2021-09-25 11:16:21,346 __main__     INFO     Save model
2021-09-25 11:16:27,668 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.532571603106643, 'mdape': 0.31944303384285216, 'rmse': 76028.09123752959, 'r2': 0.8048405235664557, 'raif_metric': 3.561362945997381}
2021-09-25 11:16:27,708 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3303853970868075, 'mdape': 0.2606205186634398, 'rmse': 43095.66146602145, 'r2': 0.5558337671777933, 'raif_metric': 2.2491688849714024}
2021-09-25 11:16:28,028 __main__     INFO     X_offer (220200, 70)  y_offer (220200,)	X_manual (860, 70) y_manual (860,)
2021-09-25 11:16:28,032 __main__     INFO     Fit model
2021-09-25 11:16:28,032 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:16:48,078 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:16:48,111 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 11:16:48,111 __main__     INFO     Save model
2021-09-25 11:16:54,383 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5334932365152678, 'mdape': 0.3188834615784686, 'rmse': 75901.90331432503, 'r2': 0.8084231820339279, 'raif_metric': 3.5634575036732454}
2021-09-25 11:16:54,420 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2963387209271207, 'mdape': 0.23084956790300906, 'rmse': 40810.987657331025, 'r2': 0.5089348441846322, 'raif_metric': 2.1073461097234256}
2021-09-25 11:16:54,740 __main__     INFO     X_offer (220238, 70)  y_offer (220238,)	X_manual (897, 70) y_manual (897,)
2021-09-25 11:16:54,744 __main__     INFO     Fit model
2021-09-25 11:16:54,744 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:17:15,107 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:17:15,143 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 11:17:15,143 __main__     INFO     Save model
2021-09-25 11:17:21,676 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5234604310674933, 'mdape': 0.31906776769809525, 'rmse': 75578.58147405073, 'r2': 0.8098001375533197, 'raif_metric': 3.5641385544887467}
2021-09-25 11:17:21,714 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3239718225004612, 'mdape': 0.265949112995422, 'rmse': 66763.14340053112, 'r2': 0.39890688876897584, 'raif_metric': 2.3398780367451266}
2021-09-25 11:17:22,037 __main__     INFO     X_offer (220246, 70)  y_offer (220246,)	X_manual (905, 70) y_manual (905,)
2021-09-25 11:17:22,041 __main__     INFO     Fit model
2021-09-25 11:17:22,041 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:17:42,130 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:17:42,166 raif_hack.model INFO     Corr coef: -0.14
2021-09-25 11:17:42,166 __main__     INFO     Save model
2021-09-25 11:17:48,469 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.52444150668815, 'mdape': 0.319372646228731, 'rmse': 75850.4307437626, 'r2': 0.8075818937368445, 'raif_metric': 3.5653589208831318}
2021-09-25 11:17:48,508 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.3568235426405867, 'mdape': 0.26379755657240483, 'rmse': 105360.55386016848, 'r2': 0.22120300256997882, 'raif_metric': 2.4684601301057283}
2021-09-25 11:17:48,828 __main__     INFO     X_offer (220241, 70)  y_offer (220241,)	X_manual (900, 70) y_manual (900,)
2021-09-25 11:17:48,832 __main__     INFO     Fit model
2021-09-25 11:17:48,833 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:18:09,160 raif_hack.model INFO     Find corr coefficient
2021-09-25 11:18:09,196 raif_hack.model INFO     Corr coef: -0.10
2021-09-25 11:18:09,196 __main__     INFO     Save model
2021-09-25 11:18:15,483 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5298567525038487, 'mdape': 0.31951279298813795, 'rmse': 75665.45463870386, 'r2': 0.8092064128565473, 'raif_metric': 3.5718767987290523}
2021-09-25 11:18:15,522 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.33197061335502265, 'mdape': 0.25977185820578474, 'rmse': 94516.99793142434, 'r2': 0.15277271077042975, 'raif_metric': 2.4116724307472093}
2021-09-25 11:18:15,522 __main__     INFO     END train.py
2021-09-25 11:19:00,088 __main__     INFO     START predict.py
2021-09-25 11:19:00,088 __main__     INFO     Load test df
2021-09-25 11:19:00,118 __main__     INFO     Input shape: (2974, 76)
2021-09-25 11:19:00,121 __main__     INFO     Load model
2021-09-25 11:19:00,124 __main__     INFO     Predict
2021-09-25 11:19:00,212 __main__     INFO     Predict
2021-09-25 11:19:00,296 __main__     INFO     Predict
2021-09-25 11:19:00,382 __main__     INFO     Predict
2021-09-25 11:19:00,467 __main__     INFO     Predict
2021-09-25 11:19:00,550 __main__     INFO     Save results
2021-09-25 11:19:00,560 __main__     INFO     END predict.py
2021-09-25 11:24:29,714 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:24:29,826 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    for fold, (trn_ind, val_ind) in enumerate(kfold.split(train_df)):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 332, in split
    for train, test in super().split(X, y, groups):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 80, in split
    for test_index in self._iter_test_masks(X, y, groups):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 92, in _iter_test_masks
    for test_index in self._iter_test_indices(X, y, groups):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 503, in _iter_test_indices
    raise ValueError("The 'groups' parameter should not be None.")
ValueError: The 'groups' parameter should not be None.

2021-09-25 11:25:54,165 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:25:54,260 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    for fold, (trn_ind, val_ind) in enumerate(kfold.split(train_df)):
TypeError: split() missing 1 required positional argument: 'y'

2021-09-25 11:27:25,055 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:27:25,185 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 62, in <module>
    for fold, (trn_ind, val_ind) in enumerate(kfold.split(train_df[CATEGORICAL_STE_FEATURES + NUM_FEATURES], train_df[TARGET])):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 332, in split
    for train, test in super().split(X, y, groups):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 80, in split
    for test_index in self._iter_test_masks(X, y, groups):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 693, in _iter_test_masks
    test_folds = self._make_test_folds(X, y)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\model_selection\_split.py", line 645, in _make_test_folds
    raise ValueError(
ValueError: Supported target types are: ('binary', 'multiclass'). Got 'continuous' instead.

2021-09-25 11:29:05,793 __main__     INFO     Input shape: (279792, 77)
2021-09-25 11:29:06,050 __main__     INFO     X_offer (275299, 67)  y_offer (275299,)	X_manual (4493, 67) y_manual (4493,)
2021-09-25 11:29:06,051 __main__     INFO     Fit model
2021-09-25 11:29:06,051 raif_hack.model INFO     Fit lightgbm
2021-09-25 11:29:06,056 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'region'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 396, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'region'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 84, in fit
    self.pipeline.fit(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 341, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 403, in _get_column_indices
    raise ValueError(
ValueError: A given column is not a column of the dataframe

2021-09-25 13:29:06,232 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:29:06,371 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:29:06,631 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:29:06,632 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 71, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 60, in __init__
    task = Task('reg', loss='rmse', metric='rmse')
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\tasks\base.py", line 324, in __init__
    assert loss in _valid_str_loss_names[self.name], 'Invalid loss name: {} for task {}.'.format(loss, self.name)
AssertionError: Invalid loss name: rmse for task reg.

2021-09-25 13:31:45,213 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:31:45,355 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:31:45,626 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:31:45,644 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 71, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 70, in __init__
    self.pipeline = Pipeline(steps=[
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 118, in __init__
    self._validate_steps()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 176, in _validate_steps
    raise TypeError(
TypeError: Last step of Pipeline should implement fit or be the string 'passthrough'. '<lightautoml.automl.presets.tabular_presets.TabularAutoML object at 0x00000226BEAA4760>' (type <class 'lightautoml.automl.presets.tabular_presets.TabularAutoML'>) doesn't

2021-09-25 13:32:57,452 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:32:57,590 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:32:57,874 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:32:57,889 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 71, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 70, in __init__
    self.pipeline = Pipeline(steps=[
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 118, in __init__
    self._validate_steps()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 176, in _validate_steps
    raise TypeError(
TypeError: Last step of Pipeline should implement fit or be the string 'passthrough'. '<lightautoml.automl.presets.tabular_presets.TabularAutoML object at 0x0000012AC0068760>' (type <class 'lightautoml.automl.presets.tabular_presets.TabularAutoML'>) doesn't

2021-09-25 13:34:22,194 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:34:22,340 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:34:22,610 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:34:22,625 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 71, in <module>
    model = BenchmarkModel(numerical_features=NUM_FEATURES, ohe_categorical_features=CATEGORICAL_OHE_FEATURES,
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 70, in __init__
    self.pipeline = Pipeline(steps=[
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 118, in __init__
    self._validate_steps()
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 176, in _validate_steps
    raise TypeError(
TypeError: Last step of Pipeline should implement fit or be the string 'passthrough'. '<lightautoml.automl.presets.tabular_presets.TabularAutoML object at 0x000002033F5D2760>' (type <class 'lightautoml.automl.presets.tabular_presets.TabularAutoML'>) doesn't

2021-09-25 13:36:08,059 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:36:08,188 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:36:08,455 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:36:08,469 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit(X_offer, y_offer, roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 340, in fit
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 254, in _check_fit_params
    raise ValueError(
ValueError: Pipeline.fit does not accept the roles parameter. You can pass parameters to specific steps of your pipeline using the stepname__parameter format, e.g. `Pipeline.fit(X, y, logisticregression__sample_weight=sample_weight)`.

2021-09-25 13:36:45,866 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:36:45,998 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:36:46,267 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:36:46,282 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 254, in _check_fit_params
    raise ValueError(
ValueError: Pipeline.fit does not accept the roles parameter. You can pass parameters to specific steps of your pipeline using the stepname__parameter format, e.g. `Pipeline.fit(X, y, logisticregression__sample_weight=sample_weight)`.

2021-09-25 13:37:46,649 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:37:46,782 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:37:47,047 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:37:47,061 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), lightautoml__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: 'lightautoml'

2021-09-25 13:38:38,882 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:38:39,018 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:38:39,287 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:38:39,301 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), tabularautoml__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: 'tabularautoml'

2021-09-25 13:39:17,731 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:39:17,861 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:39:18,129 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:39:18,143 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), __roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: ''

2021-09-25 13:39:44,274 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:39:44,403 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:39:44,670 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:39:44,684 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), TabularAutoML__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: 'TabularAutoML'

2021-09-25 13:42:06,996 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:42:07,131 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:42:07,398 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:42:07,412 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), tabularautoml__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 448, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: 'tabularautoml'

2021-09-25 13:43:14,719 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:43:14,855 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:43:15,135 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:43:15,150 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), tabularautoml__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 451, in fit_predict
    fit_params_steps = self._check_fit_params(**fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 261, in _check_fit_params
    fit_params_steps[step][param] = pval
KeyError: 'tabularautoml'

2021-09-25 13:44:36,509 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:44:36,646 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:44:36,915 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:44:36,929 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), tabularautoml__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 452, in fit_predict
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 310, in _fit
    **fit_params_steps[name])
KeyError: 'preprocessor'

2021-09-25 13:46:23,166 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:46:23,302 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:46:23,571 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:46:24,234 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict((X_offer, y_offer), model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 449, in fit_predict
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 500, in fit_transform
    X = _check_X(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 628, in _check_X
    return check_array(X, force_all_finite='allow-nan', dtype=object)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\validation.py", line 673, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\numpy\core\_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
ValueError: could not broadcast input array from shape (275299,70) into shape (275299)

2021-09-25 13:47:05,005 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:47:05,119 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:47:05,375 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:47:06,089 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict(X_offer, y_offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt, y,
TypeError: fit_predict() got multiple values for argument 'roles'

2021-09-25 13:48:04,935 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:48:05,050 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:48:05,306 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:48:06,063 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict(X_offer, y_offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt, y,
TypeError: fit_predict() got multiple values for argument 'roles'

2021-09-25 13:48:47,431 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:48:47,548 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:48:47,803 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:48:48,553 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict(X_offer, y_offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict((Xt, y,)
TypeError: unsupported operand type(s) for ** or pow(): 'tuple' and 'dict'

2021-09-25 13:51:15,568 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:51:15,685 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:51:15,942 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-25 13:51:16,673 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 103, in fit
    self.pipeline.fit_predict(X_offer, y_offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict((Xt, y),
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 407, in fit_predict
    train, upd_roles = read_data(train_data, train_features, self.cpu_limit, read_csv_params)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\tabular_batch_generator.py", line 422, in read_data
    raise ValueError('Input data format is not supported')
ValueError: Input data format is not supported

2021-09-25 13:56:55,551 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:56:55,686 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:56:55,859 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 64, in <module>
    NUM_FEATURES + CATEGORICAL_STE_FEATURES + TARGET]
TypeError: can only concatenate list (not "str") to list

2021-09-25 13:57:41,233 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 13:57:41,354 __main__     INFO     Input shape: (279792, 77)
2021-09-25 13:57:42,325 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt, y,
TypeError: fit_predict() got multiple values for argument 'roles'

2021-09-25 14:01:36,126 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:01:36,239 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:01:37,247 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 157, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 254, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:02:21,389 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:02:21,501 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:02:21,762 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:02:22,509 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 74, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 157, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 254, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:06:37,226 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:06:37,339 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:06:37,638 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:06:38,365 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 157, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 254, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:09:31,540 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:09:31,654 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:09:31,954 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:09:32,732 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 157, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:11:34,496 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:11:34,611 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:11:34,910 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:11:35,687 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 157, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:12:39,524 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:12:39,639 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:12:39,941 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:12:40,773 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 158, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:14:45,538 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:14:45,652 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:14:45,999 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:14:46,832 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 76, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 158, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:18:38,685 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:18:38,800 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:18:38,951 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 63, in <module>
    offer = train_df[train_df.price_type == PriceTypeEnum.OFFER_PRICE][
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3461, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexing.py", line 1377, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "[''] not in index"

2021-09-25 14:19:30,397 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:19:30,512 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:19:30,763 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:19:31,595 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 158, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:21:15,918 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:21:16,031 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:21:16,282 __main__     INFO     X_offer (275299, 71)  y_offer (275299,)	X_manual (4493, 71) y_manual (4493,)
2021-09-25 14:21:17,117 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 454, in fit_predict
    y_pred = self.steps[-1][-1].fit_predict(Xt,
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\tabular_presets.py", line 413, in fit_predict
    oof_pred = super().fit_predict(train, roles=roles, cv_iter=cv_iter, valid_data=valid_data)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\presets\base.py", line 173, in fit_predict
    result = super().fit_predict(train_data, roles, train_features, cv_iter, valid_data, valid_features)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\automl\base.py", line 158, in fit_predict
    train_dataset = self.reader.fit_read(train_data, train_features, roles)
  File "C:\Users\Radmir\AppData\Roaming\Python\Python38\site-packages\lightautoml\reader\base.py", line 255, in fit_read
    kwargs[attrs_dict[r.name]] = train_data[feat]
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\range.py", line 388, in get_loc
    raise KeyError(key)
KeyError: 'per_square_meter_price'

2021-09-25 14:23:00,183 py.warnings  WARNING  sys:1: DtypeWarning: Columns (1) have mixed types.Specify dtype option on import or set low_memory=False.

2021-09-25 14:23:00,297 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:23:00,549 __main__     INFO     X_offer (275299, 72)  y_offer (275299,)	X_manual (4493, 72) y_manual (4493,)
2021-09-25 14:23:00,565 __main__     ERROR    Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 75, in <module>
    model.fit(offer, manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 102, in fit
    self.pipeline.fit_predict(offer, model__roles=roles)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 449, in fit_predict
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 398, in _get_column_indices
    raise ValueError(f"Selected columns, {columns}, are not "
ValueError: Selected columns, ['lat', 'lng', 'osm_amenity_points_in_0.001', 'osm_amenity_points_in_0.005', 'osm_amenity_points_in_0.0075', 'osm_amenity_points_in_0.01', 'osm_building_points_in_0.001', 'osm_building_points_in_0.005', 'osm_building_points_in_0.0075', 'osm_building_points_in_0.01', 'osm_catering_points_in_0.001', 'osm_catering_points_in_0.005', 'osm_catering_points_in_0.0075', 'osm_catering_points_in_0.01', 'osm_city_closest_dist', 'osm_city_nearest_population', 'osm_crossing_closest_dist', 'osm_crossing_points_in_0.001', 'osm_crossing_points_in_0.005', 'osm_crossing_points_in_0.0075', 'osm_crossing_points_in_0.01', 'osm_culture_points_in_0.001', 'osm_culture_points_in_0.005', 'osm_culture_points_in_0.0075', 'osm_culture_points_in_0.01', 'osm_finance_points_in_0.001', 'osm_finance_points_in_0.005', 'osm_finance_points_in_0.0075', 'osm_finance_points_in_0.01', 'osm_healthcare_points_in_0.005', 'osm_healthcare_points_in_0.0075', 'osm_healthcare_points_in_0.01', 'osm_historic_points_in_0.005', 'osm_historic_points_in_0.0075', 'osm_historic_points_in_0.01', 'osm_hotels_points_in_0.005', 'osm_hotels_points_in_0.0075', 'osm_hotels_points_in_0.01', 'osm_leisure_points_in_0.005', 'osm_leisure_points_in_0.0075', 'osm_leisure_points_in_0.01', 'osm_offices_points_in_0.001', 'osm_offices_points_in_0.005', 'osm_offices_points_in_0.0075', 'osm_offices_points_in_0.01', 'osm_shops_points_in_0.001', 'osm_shops_points_in_0.005', 'osm_shops_points_in_0.0075', 'osm_shops_points_in_0.01', 'osm_subway_closest_dist', 'osm_train_stop_closest_dist', 'osm_train_stop_points_in_0.005', 'osm_train_stop_points_in_0.0075', 'osm_train_stop_points_in_0.01', 'osm_transport_stop_closest_dist', 'osm_transport_stop_points_in_0.005', 'osm_transport_stop_points_in_0.0075', 'osm_transport_stop_points_in_0.01', 'reform_count_of_houses_1000', 'reform_count_of_houses_500', 'reform_house_population_1000', 'reform_house_population_500', 'reform_mean_floor_count_1000', 'reform_mean_floor_count_500', 'reform_mean_year_building_1000', 'reform_mean_year_building_500', 'total_square', 'per_square_meter_price'], are not unique in dataframe

2021-09-25 14:58:35,414 __main__     INFO     Input shape: (279792, 77)
2021-09-25 14:58:35,704 __main__     INFO     X_offer (275299, 67)  y_offer (275299,)	X_manual (4493, 67) y_manual (4493,)
2021-09-25 14:58:35,704 __main__     INFO     Fit model
2021-09-25 14:58:35,709 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 396, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 76, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 82, in fit
    self.pipeline.fit(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 341, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 403, in _get_column_indices
    raise ValueError(
ValueError: A given column is not a column of the dataframe

2021-09-25 15:00:29,781 __main__     INFO     Input shape: (279792, 77)
2021-09-25 15:00:30,137 __main__     INFO     X_offer (219340, 67)  y_offer (219340,)	X_manual (0, 67) y_manual (0,)
2021-09-25 15:00:30,137 __main__     INFO     Fit model
2021-09-25 15:00:30,141 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 396, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 76, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 82, in fit
    self.pipeline.fit(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 341, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 403, in _get_column_indices
    raise ValueError(
ValueError: A given column is not a column of the dataframe

2021-09-25 15:51:45,521 __main__     INFO     Input shape: (279792, 77)
2021-09-25 15:51:45,905 __main__     INFO     X_offer (220271, 67)  y_offer (220271,)	X_manual (931, 67) y_manual (931,)
2021-09-25 15:51:45,905 __main__     INFO     Fit model
2021-09-25 15:51:45,909 __main__     ERROR    Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 396, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'realty_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:/Users/Radmir/Desktop/raifhack/train.py", line 76, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "C:\Users\Radmir\Desktop\raifhack\raif_hack\model.py", line 82, in fit
    self.pipeline.fit(X_offer, y_offer)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 341, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 303, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\joblib\memory.py", line 352, in __call__
    return self.func(*args, **kwargs)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\pipeline.py", line 754, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 505, in fit_transform
    self._validate_remainder(X)
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\compose\_column_transformer.py", line 332, in _validate_remainder
    cols.extend(_get_column_indices(X, columns))
  File "C:\Users\Radmir\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\utils\__init__.py", line 403, in _get_column_indices
    raise ValueError(
ValueError: A given column is not a column of the dataframe

2021-09-25 15:52:41,205 __main__     INFO     Input shape: (279792, 77)
